(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8d289ce"],{"0e63":function(t,n,e){},"231e":function(t,n,e){"use strict";e.d(n,"a",(function(){return p})),e.d(n,"b",(function(){return m})),e.d(n,"e",(function(){return f})),e.d(n,"d",(function(){return h})),e.d(n,"f",(function(){return v})),e.d(n,"c",(function(){return C})),e.d(n,"g",(function(){return b}));var a,i,s,o,c,d,r,l=e("8785"),u=e("5184"),p=Object(u["a"])(a||(a=Object(l["a"])(["\n  mutation createCompany($input: companyCreateInput!) {\n    createCompany(companyInput: $input) {\n      id\n      name\n      address\n      website\n      phones\n      socialMedias\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      contacts {\n        id\n        name\n      }\n    }\n  }\n"]))),m=Object(u["a"])(i||(i=Object(l["a"])(["\n  mutation deletedCompanies($input: [DeleteCompanyInput!]!) {\n    deletedCompanies(companies: $input) {\n      id\n      name\n    }\n  }\n"]))),f=Object(u["a"])(s||(s=Object(l["a"])(["\n  mutation trashCompanies($input: [DeleteCompanyInput!]!) {\n    trashCompanies(companies: $input) {\n      id\n    }\n  }\n"]))),h=Object(u["a"])(o||(o=Object(l["a"])(["\n  mutation restoreCompanies($input: [DeleteCompanyInput!]!) {\n    restoreCompanies(companies: $input) {\n      id\n    }\n  }\n"]))),v=Object(u["a"])(c||(c=Object(l["a"])(["\n  mutation updateCompany($companyInput: companyUpdateInput!) {\n    updateCompany(companyInput: $companyInput) {\n      id\n      name\n      address\n      website\n      phones\n      customForms\n      socialMedias\n      tags {\n        id\n        name\n        color\n        order\n      }\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      contacts {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      deals {\n        id\n        title\n        value\n        status\n        contact {\n          id\n          name\n        }\n        company {\n          id\n          name\n        }\n        stage {\n          id\n        }\n        pipeline {\n          id\n          stages {\n            id\n          }\n        }\n        owner {\n          id\n        }\n      }\n    }\n  }\n"]))),C=Object(u["a"])(d||(d=Object(l["a"])(["\n  mutation FuseCompanies($input: CompaniesToFuse!) {\n    fuseCompanies(fuse: $input) {\n      id\n      name\n    }\n  }\n"]))),b=Object(u["a"])(r||(r=Object(l["a"])(["\n  mutation assignCompanies($companyListAssign: CompanyListAssign!) {\n    assignCompanies(companyListAssign: $companyListAssign)\n  }\n"])))},2532:function(t,n,e){"use strict";var a=e("23e7"),i=e("5a34"),s=e("1d80"),o=e("ab13");a({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(s(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"2cff":function(t,n,e){"use strict";e.d(n,"a",(function(){return p})),e.d(n,"f",(function(){return m})),e.d(n,"b",(function(){return f})),e.d(n,"e",(function(){return h})),e.d(n,"d",(function(){return v})),e.d(n,"c",(function(){return C})),e.d(n,"g",(function(){return b}));var a,i,s,o,c,d,r,l=e("8785"),u=e("5184"),p=Object(u["a"])(a||(a=Object(l["a"])(["\n  mutation CreateContact($input: contactCreateInput!) {\n    createContact(contactInput: $input) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n      }\n      isClient\n    }\n  }\n"]))),m=Object(u["a"])(i||(i=Object(l["a"])(["\n  mutation updateContact($contactInput: contactUpdateInput) {\n    updateContact(contactInput: $contactInput) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      customForms\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      enterprise {\n        id\n        name\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      deals {\n        id\n        title\n        value\n        status\n        contact {\n          id\n          name\n        }\n        company {\n          id\n          name\n        }\n        stage {\n          id\n        }\n        pipeline {\n          id\n          stages {\n            id\n          }\n        }\n        owner {\n          id\n        }\n      }\n      createdAt\n    }\n  }\n"]))),f=Object(u["a"])(s||(s=Object(l["a"])(["\n  mutation deletedContacts($input: [DeleteContactInput!]!) {\n    deletedContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),h=Object(u["a"])(o||(o=Object(l["a"])(["\n  mutation trashContacts($input: [DeleteContactInput!]!) {\n    trashContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),v=Object(u["a"])(c||(c=Object(l["a"])(["\n  mutation restoreContacts($input: [DeleteContactInput!]!) {\n    restoreContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),C=Object(u["a"])(d||(d=Object(l["a"])(["\n  mutation FuseContacts($input: ContactsToFuse!) {\n    fuseContacts(fuse: $input) {\n      id\n      name\n    }\n  }\n"]))),b=Object(u["a"])(r||(r=Object(l["a"])(["\n  mutation assignContacts($contactListAssign: ContactListAssign!) {\n    assignContacts(contactListAssign: $contactListAssign)\n  }\n"])))},"2faa":function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));e("b0c0");var a=e("2cff"),i={data:function(){return{isLoadingUpdateContact:!1}},methods:{updateContact:function(t){var n=this,e=t.id,i=t.name,s=t.email,o=t.birthday,c=t.phones,d=t.isClient,r=t.socialMedias,l=t.customForm,u=t.company,p=t.owner,m=t.tags,f=t.deal;this.isLoadingUpdateContact=!0;var h={};h.id=e,i&&(h.name=i),s&&(h.email=s),o&&(h.birthday=o),c&&(h.phones=c),!0!==d&&!1!==d||(h.isClient=d),r&&(h.socialMedias=r),l&&(h.customForm=l),u&&(h.company=u),p&&(h.owner=p),m&&(h.tags=m),f&&(h.deal=f),this.$apollo.mutate({mutation:a["f"],variables:{contactInput:h}}).then((function(t){var e=t.data.updateContact;n.$emit("updateItem",e),n.$emit("updateHistory"),n.isLoadingUpdateContact=!1})).catch((function(){n.isLoadingUpdateContact=!1;var t="No se pudo actualizar el contacto, intente de nuevo o contacte a soporte";n.modalHandlerError({isOpen:!0,error:t})}))}}}},"54e3":function(t,n,e){"use strict";e("0e63")},"5a34":function(t,n,e){var a=e("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},"6bfe":function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));e("caad"),e("2532");var a=e("4b58"),i=e("9685"),s=e("891c"),o=e("e815"),c={data:function(){return{membersGroup:[]}},methods:{canGroup:function(t,n,e,o){var c=o.authorId;return!!c&&(i["a"].can(t,Object(a["b"])(n,{authorId:c}))||i["a"].can(s["b"],e)&&i["a"].can(t,n)||i["a"].can(s["m"],e)&&this.membersGroup.includes(c)&&i["a"].can(t,n))}},apollo:{membersGroup:{query:o["k"],update:function(t){var n=t.userCurrent;return n.membersGroup}}}}},"78f1":function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));e("b0c0");var a=e("231e"),i={data:function(){return{isLoadingUpdateCompany:!1}},methods:{updateCompany:function(t){var n=this,e=t.id,i=t.name,s=t.address,o=t.website,c=t.socialMedias,d=t.phones,r=t.customForm,l=t.contact,u=t.tags,p=t.owner,m=t.deal;this.isLoadingUpdateCompany=!0;var f={};f.id=e,i&&(f.name=i),s&&(f.address=s),o&&(f.website=o),c&&(f.socialMedias=c),d&&(f.phones=d),r&&(f.customForm=r),l&&(f.contact=l),u&&(f.tags=u),p&&(f.owner=p),m&&(f.deal=m),this.$apollo.mutate({mutation:a["f"],variables:{companyInput:f}}).then((function(t){var e=t.data.updateCompany;n.$emit("updateItem",e),n.$emit("updateHistory"),n.isLoadingUpdateCompany=!1})).catch((function(){n.isLoadingUpdateCompany=!1;var t="No se pudo actualizar la empresa, intente de nuevo o contacte a soporte";n.modalHandlerError({isOpen:!0,error:t})}))}}}},"998b":function(t,n,e){"use strict";e.r(n);var a=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-card",{attrs:{tile:"",flat:""}},[e("v-divider"),e("v-card-title",{staticClass:"deals-title py-1"},[e("v-icon",{staticClass:"mr-4"},[t._v("mdi-handshake")]),t._v(" Tratos "),e("v-spacer"),e("v-menu",{attrs:{left:"",bottom:"","offset-y":"","close-on-content-click":!1,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(n){var a=n.on;return[e("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:(t.canEdit||t.canEditOthers)&&!t.item.isDelete,expression:"(canEdit || canEditOthers) && !item.isDelete"}],attrs:{icon:""}},a),[e("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.isOpenMenuAddDeal,callback:function(n){t.isOpenMenuAddDeal=n},expression:"isOpenMenuAddDeal"}},[!t.canEdit&&!t.canEditOthers||t.item.isDelete?t._e():e("v-list",{attrs:{dense:""}},[e("v-list-item",{on:{click:function(n){return t.$emit("openModalDeal")}}},[e("v-list-item-title",[t._v(" Nuevo ")])],1),e("v-menu",{attrs:{"close-on-content-click":!1,"close-on-click":!0},scopedSlots:t._u([{key:"activator",fn:function(n){var a=n.on;return[e("v-list-item",t._g({},a),[e("v-list-item-title",[t._v(" Existente ")])],1)]}}],null,!1,4142919280),model:{value:t.isShowAddDeal,callback:function(n){t.isShowAddDeal=n},expression:"isShowAddDeal"}},[e("v-card",{staticClass:"pa-4",attrs:{width:"18em"}},[t.warningDealExistInfo.show?e("v-alert",{attrs:{dense:"",border:"left",type:"warning"}},[e("p",{staticClass:"mb-0",staticStyle:{"font-size":".75em"}},[t._v(" "+t._s(t.warningDealExistInfo.text)+" ")])]):t._e(),e("v-form",{ref:"formDeal"},[e("FieldSelectDealSimple",{attrs:{inputProps:{class:"no-icon",isDense:!0},resetHandler:t.isShowAddDeal},on:{outData:t.verificationDeal,deleteDeal:t.deleteDealSelected}})],1),e("div",{staticClass:"d-flex justify-center pt-2 ml-2"},[e("v-btn",{staticClass:"mr-2",staticStyle:{width:"45%"},attrs:{outlined:"",color:"primary",small:""},on:{click:function(n){t.isShowAddDeal=!1}}},[t._v(" Cancelar ")]),e("v-btn",{staticStyle:{width:"45%"},attrs:{disabled:t.disabledAddButton,loading:t.isLoadingAddDeal,color:"secondary",small:""},on:{click:t.addExistingDeal}},[t._v(" Guardar ")])],1)],1)],1)],1)],1)],1),e("v-divider"),e("v-card-text",{staticClass:"pa-0"},[e("v-card",{staticClass:"deals-container",attrs:{flat:"","max-height":"20em"}},[null!==t.deals&&t.deals.length?t.listDealsOpen.length&&!t.isLoading?[e("v-subheader",[t._v("Abiertos")]),t._l(t.listDealsOpen,(function(n,a){return e("v-card",{key:a+"-"+n.id,staticClass:"ma-4 deal__card",on:{click:function(e){return t.goDeal(n.id)}}},[e("v-card-title",{staticClass:"d-flex justify-space-between deals-title pt-1 pb-0"},[e("div",{staticClass:"text-truncate",staticStyle:{width:"85%"}},[t._v(" "+t._s(n.title)+" ")]),!t.canEdit&&!t.canEditOthers||t.item.isDelete?t._e():e("div",{staticStyle:{width:"15%"}},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on,s=a.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-2",attrs:{"x-small":"",loading:t.isLoadingRemove,color:"grey",outlined:""},on:{click:function(e){return e.stopPropagation(),t.disconnectDeal(n.id)}}},"v-btn",s,!1),i),[e("v-icon",{attrs:{small:""}},[t._v("mdi-connection")])],1)]}}],null,!0)},[e("span",[t._v("Desvincular")])])],1)]),e("v-card-text",{staticClass:"d-flex justify-space-between"},[e("div",{staticClass:"text-truncate",staticStyle:{width:"70%"}},[e("v-icon",[t._v(" "+t._s("CONTACT"===t.typeItem?"mdi-office-building":"mdi-account")+" ")]),"COMPANY"===t.typeItem?e("span",{staticClass:"black--text"},[t._v(" "+t._s(n.contact?n.contact.name:"Sin contacto")+" ")]):e("span",{staticClass:"black--text "},[t._v(" "+t._s(n.company?n.company.name:"Sin empresa")+" ")])],1),e("div",{staticClass:"text-truncate",staticStyle:{width:"30%"}},[e("span",{staticClass:"black--text  d-block"},[t._v(" "+t._s(t._f("formatPrice")(n.value))+" ")])])]),e("v-progress-linear",{attrs:{"background-color":"secondary",color:"success",value:t.getPercentage(n.stage.id,n.pipeline.stages),height:"5"}})],1)}))]:t._e():e("div",{staticClass:"d-flex align-center justify-center",staticStyle:{height:"100%"}},[e("span",{staticClass:"d-block text-center pa-10"},[t._v("No hay tratos")])]),t.listDealsClosed.length&&!t.isLoading?[e("v-subheader",[t._v("Cerrados")]),t._l(t.listDealsClosed,(function(n,a){return e("v-card",{key:a+"-"+n.id+"-closed",staticClass:"ma-4 deal__card",on:{click:function(e){return t.goDeal(n.id)}}},[e("v-card-title",{staticClass:"d-flex justify-space-between deals-title pt-1 pb-0"},[e("div",{staticClass:"text-truncate",staticStyle:{width:"85%"}},[t._v(" "+t._s(n.title)+" ")]),!t.canEdit&&!t.canEditOthers||t.item.isDelete?t._e():e("div",{staticStyle:{width:"15%"}},[e("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on,s=a.attrs;return[e("v-btn",t._g(t._b({staticClass:"mr-2",attrs:{"x-small":"",loading:t.isLoadingRemove,color:"grey",outlined:""},on:{click:function(e){return e.stopPropagation(),t.disconnectDeal(n.id)}}},"v-btn",s,!1),i),[e("v-icon",{attrs:{small:""}},[t._v("mdi-connection")])],1)]}}],null,!0)},[e("span",[t._v("Desvincular")])])],1)]),e("v-card-text",{staticClass:"d-flex justify-space-between"},[e("div",{staticClass:"text-truncate",staticStyle:{width:"70%"}},[e("v-icon",[t._v(" "+t._s("CONTACT"===t.typeItem?"mdi-office-building":"mdi-account")+" ")]),"COMPANY"===t.typeItem?e("span",{staticClass:"black--text"},[t._v(" "+t._s(n.contact?n.contact.name:"Sin contacto")+" ")]):e("span",{staticClass:"black--text "},[t._v(" "+t._s(n.company?n.company.name:"Sin empresa")+" ")])],1),e("div",{staticClass:"text-truncate",staticStyle:{width:"30%"}},[e("span",{staticClass:"black--text  d-block"},[t._v(" "+t._s(t._f("formatPrice")(n.value))+" ")])])]),e("v-progress-linear",{attrs:{"background-color":"secondary",color:"WON"===n.status?"success":"error",value:"100",height:"5"}})],1)}))]:t._e()],2)],1)],1)},i=[],s=(e("d3b7"),e("3ca3"),e("ddb0"),e("4de4"),e("c740"),e("4b58")),o=e("9685"),c=e("6bfe"),d=e("2faa"),r=e("78f1"),l=e("891c"),u=e("ee2e"),p={name:"ListDeals",components:{FieldSelectDealSimple:function(){return e.e("chunk-d41f2aa8").then(e.bind(null,"bbe2"))}},mixins:[c["a"],d["a"],r["a"]],props:{item:{type:Object,required:!0},itemId:{type:String,default:"",required:!0},typeItem:{type:String,required:!0,default:void 0},ownerId:{type:String,default:""},deals:{type:Array,default:function(){return[]}},isLoading:{type:Boolean}},data:function(){return{UPDATE:l["r"],PERMISSIONS_CONTACTS:u["e"],PERMISSIONS_COMPANIES:u["d"],isShowAddDeal:!1,isOpenMenuAddDeal:!1,isLoadingAddDeal:!1,isLoadingRemove:!1,existingDealSelected:{},warningDealExistInfo:{show:!1,text:""}}},watch:{isShowAddDeal:function(){this.warningDealExistInfo={show:!1,text:""}},isLoadingAddDeal:function(t){t||(this.isShowAddDeal=!1,this.isOpenMenuAddDeal=!1)},isLoadingUpdateContact:function(t){t||(this.isLoadingAddDeal=!1,this.isLoadingRemove=!1)},isLoadingUpdateCompany:function(t){t||(this.isLoadingAddDeal=!1,this.isLoadingRemove=!1)}},computed:{canEdit:function(){return"CONTACT"===this.typeItem?o["a"].can(l["r"],Object(s["b"])(u["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem&&o["a"].can(l["r"],Object(s["b"])(u["d"],{authorId:this.ownerId||""}))},canEditOthers:function(){return"CONTACT"===this.typeItem?this.canEdit?o["a"].can(l["s"],Object(s["b"])(u["e"],{authorId:this.ownerId||""})):o["a"].can(l["s"],u["e"])&&!o["a"].can(l["s"],Object(s["b"])(u["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem&&(this.canEdit?o["a"].can(l["s"],Object(s["b"])(u["d"],{authorId:this.ownerId||""})):o["a"].can(l["s"],u["d"])&&!o["a"].can(l["s"],Object(s["b"])(u["d"],{authorId:this.ownerId||""})))},listDealsOpen:function(){return this.deals.filter((function(t){return"OPEN"===t.status}))},listDealsClosed:function(){return this.deals.filter((function(t){return"OPEN"!==t.status}))},disabledAddButton:function(){return!this.existingDealSelected.id}},methods:{deleteDealSelected:function(){this.existingDealSelected={},this.warningDealExistInfo={show:!1,text:""}},disconnectDeal:function(t){this.isLoadingRemove=!0,"CONTACT"===this.typeItem&&this.updateContact({id:this.itemId,deal:{id:t,disconnect:!0}}),"COMPANY"===this.typeItem&&this.updateCompany({id:this.itemId,deal:{id:t,disconnect:!0}})},addExistingDeal:function(){this.isLoadingAddDeal=!0,"CONTACT"===this.typeItem&&this.updateContact({id:this.itemId,deal:{id:this.existingDealSelected.id,disconnect:!1}}),"COMPANY"===this.typeItem&&this.updateCompany({id:this.itemId,deal:{id:this.existingDealSelected.id,disconnect:!1}})},verificationDeal:function(t){var n,e,a,i;(null!==(n=t.contact)&&void 0!==n&&n.id||null!==(e=t.company)&&void 0!==e&&e.id)&&("CONTACT"===this.typeItem&&null!==(a=t.contact)&&void 0!==a&&a.id&&(this.warningDealExistInfo={show:!0,text:"El trato seleccionado ya cuenta con un contacto asignado, si continua el contacto será reemplazado"}),"COMPANY"===this.typeItem&&null!==(i=t.company)&&void 0!==i&&i.id&&(this.warningDealExistInfo={show:!0,text:"El trato seleccionado ya cuenta con una empresa asignada, si continua la empresa será reemplazada"}));this.existingDealSelected=t},goDeal:function(t){this.$router.push({name:"deal",params:{id:t}},(function(){}))},goContact:function(t){this.$router.push({name:"contact",params:{id:t}},(function(){}))},getPercentage:function(t,n){var e=this.getIndexStage(t,n)+1,a=this.getCountStage(n);return 100*e/a},getIndexStage:function(t,n){return n.findIndex((function(n){return n.id===t}))},getCountStage:function(t){return t.length}}},m=p,f=(e("54e3"),e("0c7c")),h=e("6544"),v=e.n(h),C=e("0798"),b=e("8336"),g=e("b0af"),y=e("99d9"),I=e("ce7e"),O=e("4bd4"),D=e("132d"),w=e("8860"),_=e("da13"),x=e("5d23"),S=e("e449"),A=e("8e36"),j=e("2fa4"),L=e("e0c7"),$=e("3a2f"),k=Object(f["a"])(m,a,i,!1,null,"0972615b",null);n["default"]=k.exports;v()(k,{VAlert:C["a"],VBtn:b["a"],VCard:g["a"],VCardText:y["c"],VCardTitle:y["d"],VDivider:I["a"],VForm:O["a"],VIcon:D["a"],VList:w["a"],VListItem:_["a"],VListItemTitle:x["c"],VMenu:S["a"],VProgressLinear:A["a"],VSpacer:j["a"],VSubheader:L["a"],VTooltip:$["a"]})},ab13:function(t,n,e){var a=e("b622"),i=a("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[i]=!1,"/./"[t](n)}catch(a){}}return!1}},caad:function(t,n,e){"use strict";var a=e("23e7"),i=e("4d64").includes,s=e("44d2");a({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),s("includes")}}]);
//# sourceMappingURL=chunk-b8d289ce.9e036fc6.js.map