{"version":3,"sources":["webpack:///./src/views/Confirm.vue?16c8","webpack:///src/views/Confirm.vue","webpack:///./src/views/Confirm.vue?b28b","webpack:///./src/views/Confirm.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","dynamicComponent","tag","attrs","error","isUpdateData","userEnterprise","on","updateUser","staticRenderFns","name","components","CompleteSignUpForm","WelcomeEnterprise","BaseError","BaseLoading","data","icon","tittle","message","type","computed","beforeMount","$apollo","methods","userEnterpriseId","id","password","lastName","phones","length","number","input","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAGJ,EAAIM,iBAAiB,CAACC,IAAI,YAAYC,MAAM,CAAC,KAAOR,EAAIS,MAAM,SAAWT,EAAIU,aAAa,eAAiBV,EAAIW,gBAAgBC,GAAG,CAAC,QAAUZ,EAAIa,eAChPC,EAAkB,G,sDCetB,GACEC,KAAM,UAENC,WAAY,CACVC,mBAAoB,WAAxB,OACA,iDACIC,kBAAmB,WAAvB,OACA,iDACIC,UAAW,WAAf,yDACIC,YAAa,WAAjB,yDAEEC,KAXF,WAYI,MAAO,CACLX,cAAc,EAEdD,MAAO,CACLa,KAAM,GACNC,OAAQ,GACRC,QAAS,IAGXC,KAAM,GAENd,eAAgB,KAGpBe,SAAU,CAERpB,iBAFJ,WAGM,OAAQL,KAAKwB,MAEX,IAAK,YACH,MAAO,qBAET,IAAK,YACH,MAAO,oBAET,IAAK,UACH,MAAO,YAET,QACE,MAAO,iBAIfE,YA7CF,WA6CA,WAEI1B,KAAK2B,QACT,QACM,SAAN,OACM,UAAN,CACQ,MAAR,CACU,MAAV,uBAGM,OAAN,cAAQ,IAAR,qBAEQ,EAAR,yCACQ,QAAR,YACQ,EAAR,oBAGA,mBAAM,IAAN,oBACA,0DACM,EAAN,eACM,EAAN,OACQ,KAAR,2BACQ,OAAR,EACA,qCACA,kDACQ,QAAR,EACA,8EACA,4BAIEC,QAAS,CAEPhB,WAFJ,YAEA,yDACA,GACQiB,iBAAkB7B,KAAKU,eAAeoB,GACtCC,SAAR,EACQjB,KAAR,EACQkB,SAAR,GAEUC,EAAOC,OAAS,GAAiC,KAA5BD,EAAO,GAAGE,OAAOD,SACxCE,EAAMH,OAASA,GAGjBjC,KAAK2B,QACX,QACQ,SAAR,OACQ,UAAR,CACU,MAAV,GAEQ,OAAR,WAEU,EAAV,iBACU,EAAV,mBAGA,kBACQ,EAAR,OACU,KAAV,2BACU,OAAV,qDACU,QAAV,wBAGQ,EAAR,qBC5Hsf,I,YCOlfU,EAAY,eACd,EACAvC,EACAe,GACA,EACA,KACA,KACA,MAIa,aAAAwB,E","file":"js/chunk-2d224887.fa4aa6b3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(_vm.dynamicComponent,{tag:\"component\",attrs:{\"info\":_vm.error,\"isUpdate\":_vm.isUpdateData,\"userEnterprise\":_vm.userEnterprise},on:{\"outData\":_vm.updateUser}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <component\n    @outData=\"updateUser\"\n    :info=\"error\"\n    :isUpdate=\"isUpdateData\"\n    :userEnterprise=\"userEnterprise\"\n    :is=\"dynamicComponent\"\n  ></component>\n</template>\n\n<script>\nimport {\n  CONFIRM_USER,\n  UPDATE_NEW_USER,\n} from '@/graphql/mutations/authMutations';\n\nexport default {\n  name: 'confirm',\n  // componenetes que se switchearan en la vista\n  components: {\n    CompleteSignUpForm: () =>\n      import('@/components/confirmUser/CompleteSignUpForm.vue'),\n    WelcomeEnterprise: () =>\n      import('@/components/confirmUser/WelcomeEnterprise.vue'),\n    BaseError: () => import('@/components/ui/BaseError.vue'),\n    BaseLoading: () => import('@/components/ui/BaseLoading.vue'),\n  },\n  data() {\n    return {\n      isUpdateData: false,\n      // informacion del error que se mostrara\n      error: {\n        icon: '',\n        tittle: '',\n        message: '',\n      },\n      // guarda el comonenete que se mostrara\n      type: '',\n      // guarda el objeto que responde el servidor\n      userEnterprise: {},\n    };\n  },\n  computed: {\n    // determina el componenete que se mostrara\n    dynamicComponent() {\n      switch (this.type) {\n        // vista nuevo usuario\n        case 'isNewUser':\n          return 'CompleteSignUpForm';\n        // vista usuario ya registrado\n        case 'isOldUser':\n          return 'WelcomeEnterprise';\n        // vista otro error\n        case 'isError':\n          return 'BaseError';\n        // vista de cargando\n        default:\n          return 'BaseLoading';\n      }\n    },\n  },\n  beforeMount() {\n    // mutacion que se envia al server al entrar a link de invitacion\n    this.$apollo\n      .mutate({\n        mutation: CONFIRM_USER,\n        variables: {\n          input: {\n            token: this.$route.query.id,\n          },\n        },\n        update: (store, { data: { confirmUser } }) => {\n          // valida si el usuario es nuevo o ya esta registrado\n          this.type = confirmUser.user.name ? 'isOldUser' : 'isNewUser';\n          console.log(this.type);\n          this.userEnterprise = confirmUser;\n        },\n      })\n      .catch(({ graphQLErrors }) => {\n        const isComming = graphQLErrors[0]?.statusCode === 401;\n        this.type = 'isError';\n        this.error = {\n          icon: 'mdi-shield-alert-outline',\n          tittle: isComming\n            ? '¡Lo sentimos, el link ha expirado!'\n            : '¡Lo sentimos, ha ocurrido un error de servidor!',\n          message: isComming\n            ? 'Pídele al administrador de la empresa que reenvíe la invitación a tu correo'\n            : 'Contacte con soporte',\n        };\n      });\n  },\n  methods: {\n    // actualiza el usuario nuevo\n    updateUser({ password, name, lastName, phones }) {\n      const input = {\n        userEnterpriseId: this.userEnterprise.id,\n        password,\n        name,\n        lastName,\n      };\n      if (phones.length > 0 && phones[0].number.length === 10) {\n        input.phones = phones;\n      }\n\n      this.$apollo\n        .mutate({\n          mutation: UPDATE_NEW_USER,\n          variables: {\n            input,\n          },\n          update: () => {\n            // monta mensaje de bienvenida\n            this.type = 'isOldUser';\n            this.isUpdateData = true;\n          },\n        })\n        .catch(() => {\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: '¡Lo sentimos, ha ocurrido un error en el registro!',\n            message: 'Contacte con soporte',\n          };\n          // monta vista de error\n          this.type = 'isError';\n        });\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Confirm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Confirm.vue?vue&type=template&id=13225e70&\"\nimport script from \"./Confirm.vue?vue&type=script&lang=js&\"\nexport * from \"./Confirm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}