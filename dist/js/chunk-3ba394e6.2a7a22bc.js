(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ba394e6"],{6999:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-center"},[i("v-card",{attrs:{tile:"",flat:"",width:"36rem",height:"30em"}},[i("div",{staticClass:"d-flex justify-space-between pa-4 primary"},[i("span",{staticClass:"title-activities-types mt-2 white--text"},[t._v(" Tipos de actividades ")]),i("v-btn",{attrs:{fab:"",small:"",color:"secondary"},on:{click:t.openModalActivityType}},[i("v-icon",[t._v("mdi-plus")])],1)],1),t.activityTypes&&t.activityTypes.length>0?i("div",{staticStyle:{"max-height":"85%","overflow-y":"auto"}},[i("v-list",{attrs:{dense:""}},[i("draggable",{attrs:{list:t.listActivityTypes,handle:".handle"},on:{change:t.changeOrder}},[i("transition-group",[t._l(t.listActivityTypes,(function(e){return[i("v-list-item",{key:e.id,staticClass:"item-type-activity",attrs:{dense:""}},[i("v-list-item-action",[i("v-btn",{staticClass:"handle",attrs:{small:"",icon:""}},[i("v-icon",[t._v("mdi-menu")])],1)],1),i("v-list-item-content",[i("v-list-item-title",[i("v-chip",{attrs:{color:e.color,"text-color":t.getBestColor(e.color)}},[t._v(" "+t._s(e.name)+" ")])],1)],1),i("v-list-item-action",[i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[i("div",t._g({},o),[i("v-btn",t._b({attrs:{color:"primary","x-small":"",outlined:"",disabled:e.activitiesCount>0},on:{click:function(i){return t.openModalRemoveTypeActivity(e)}}},"v-btn",n,!1),[i("v-icon",{attrs:{small:"",color:"primary"}},[t._v(" mdi-delete ")])],1)],1)]}}],null,!0)},[i("span",[e.activitiesCount>0?[t._v(" No se puede eliminar, tienes "+t._s(e.activitiesCount)+" "+t._s(1===e.activitiesCount?"actividad":"actividades")+" ")]:[t._v(" Eliminar ")]],2)])],1),i("v-list-item-action",[i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(a){var o=a.on,n=a.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"secondary","x-small":""},on:{click:function(i){return t.editTypeActivity(e)}}},"v-btn",n,!1),o),[i("v-icon",{attrs:{small:"",color:"white"}},[t._v("mdi-pencil")])],1)]}}],null,!0)},[i("span",[t._v(" Editar ")])])],1)],1)]}))],2)],1)],1)],1):i("div",{staticClass:"d-flex flex-column align-center justify-center full-heigth"},[i("v-icon",{attrs:{large:""}},[t._v("mdi-calendar-remove")]),i("p",{staticClass:"text-center pb-12"},[t._v(" No tienes tipos de actividades ")])],1)]),i("BaseModalDeleteItem",{attrs:{dialog:t.isOpenDelete,config:t.configModalDelete,isLoading:t.isLoadingDelete,item:t.itemSelected},on:{"update:dialog":function(e){t.isOpenDelete=e},remove:t.removeTokenCalendar}}),i("ModalActivityType",{attrs:{activityTypes:t.listActivityTypes},on:{refetch:t.updateTypeActivities}}),i("BaseModalDelete",{attrs:{modalHandler:t.modalDelete},on:{cancel:t.modalHandlerDelete,confirm:t.removeTypeActivity}}),i("BaseModalError",{attrs:{modalHandler:t.modalError},on:{close:t.modalHandlerError}})],1)},o=[],n=i("5530"),r=i("2909"),s=(i("b0c0"),i("7db0"),i("4e827"),i("c740"),i("fb6a"),i("d3b7"),i("25f0"),i("4de4"),i("b76a")),l=i.n(s),c=i("c0ca"),d=i("3398"),u=i("1891"),v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-row",[i("v-dialog",{attrs:{scrollable:"","max-width":"430px",persistent:""},model:{value:t.modal.status,callback:function(e){t.$set(t.modal,"status",e)},expression:"modal.status"}},[i("v-card",[i("v-card-title",{staticClass:"primary white--text"},[t._v(" "+t._s(t.formatTitle)+" "),i("v-spacer"),i("v-btn",{attrs:{icon:"",color:"white"},on:{click:t.close}},[i("v-icon",[t._v("mdi-close")])],1)],1),i("v-divider"),i("v-card-text",{staticClass:"py-3"},[i("v-form",{ref:"formActivityType",model:{value:t.isValidFormActivityType,callback:function(e){t.isValidFormActivityType=e},expression:"isValidFormActivityType"}},[i("v-text-field",{attrs:{outlined:"",dense:"",rules:t.rules.general,"hide-details":"auto",label:"Nombre de tipo de actividad",required:"",maxlength:"30",counter:""},model:{value:t.typeActivity.name,callback:function(e){t.$set(t.typeActivity,"name",e)},expression:"typeActivity.name"}})],1),i("v-tabs",{attrs:{grow:""},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[i("v-tab",{attrs:{href:"#choose"}},[t._v("Elige un color")]),i("v-tab",{attrs:{href:"#custom"}},[t._v("Personalizar color")]),i("v-tab-item",{attrs:{value:"choose"}},[i("div",{staticClass:"mt-3 d-flex justify-center"},[i("v-chip-group",{attrs:{column:""},model:{value:t.typeActivity.color,callback:function(e){t.$set(t.typeActivity,"color",e)},expression:"typeActivity.color"}},t._l(t.colors,(function(e,a){return i("v-chip",{key:a,attrs:{color:e.hex,value:e.hex,dark:""}},[i("v-icon",{attrs:{color:"white"}},[t._v(" "+t._s(e.hex===t.typeActivity.color?"mdi-check-bold":"mdi-invert-colors")+" ")])],1)})),1)],1),t.isValidColorChoose?t._e():i("div",{staticClass:"d-flex justify-center mt-2"},[i("span",{staticClass:"error--text"},[t._v("Debes seleccionar un color")])])]),i("v-tab-item",{attrs:{value:"custom"}},[i("div",{staticClass:"mt-3 d-flex justify-center"},[i("v-color-picker",{attrs:{flat:"","dot-size":"30","hide-mode-switch":"",mode:"hexa"},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1),t.isValidColorCustom?t._e():i("div",{staticClass:"d-flex justify-center mt-2"},[i("span",{staticClass:"error--text"},[t._v("Debes seleccionar un color")])])])],1)],1),i("v-divider"),i("v-card-actions",[i("v-btn",{attrs:{color:"secondary",outlined:""},on:{click:t.close}},[t._v(" Cancelar ")]),i("v-spacer"),i("v-btn",{attrs:{color:"secondary",loading:t.isLoadingActivityType},on:{click:function(e){t.modal.isEdit?t.updateTypeActivity():t.saveActivityType()}}},[t._v(" "+t._s(t.titleActionButton)+" ")])],1)],1)],1),i("BaseModalError",{attrs:{modalHandler:t.modalError},on:{close:t.modalHandlerError}})],1)},m=[],h=i("f82a"),y=i("1e6d"),p=i("949a"),f={name:"ModalActivityType",mixins:[u["b"],u["a"],h["a"],c["a"],y["a"]],props:{activityTypes:{type:Array,default:function(){return[]}}},data:function(){return{isLoadingActivityType:!1,tabs:"",modalId:"createActivityType",modal:{},typeActivity:{name:"",color:""},isValidColorChoose:!0,isValidColorCustom:!0,isValidFormActivityType:!0,hex:"#FFFFFF",colors:[{name:"Verde",hex:"#08a742"},{name:"Rojo",hex:"#f94839"},{name:"Azul",hex:"#317ae2"},{name:"Amarillo",hex:"#fccf00"},{name:"Morado",hex:"#721ea9"},{name:"Gris",hex:"#dcdddd"}]}},watch:{"typeActivity.color":{handler:function(){this.isValidColorChoose=!0}},"modal.isEdit":{handler:function(t){if(t){var e=this.modal.item,i=e.name,a=e.color,o=e.order;this.typeActivity={name:i,color:a,order:o},this.isColorDefault(a)?this.tabs="choose":(this.tabs="custom",this.hex=a)}else this.reset()}}},computed:{color:{get:function(){return this.hex},set:function(t){this.hex=t}},formatTitle:function(){return this.modal.isEdit?"Editar tipo de actividad":"Crear tipo de actividad"},titleActionButton:function(){return this.modal.isEdit?"Actualizar":"Crear"}},methods:{isColorDefault:function(t){return this.colors.some((function(e){return e.hex===t}))},close:function(){this.changeModal({id:this.modalId,status:!1,isEdit:!1,item:null})},checkValidColor:function(){"choose"===this.tabs?(this.isValidColorChoose=void 0!==this.typeActivity.color&&""!==this.typeActivity.color,this.isValidColorCustom=!0):(this.isValidColorChoose=!0,this.isValidColorCustom=void 0!==this.color&&""!==this.color)},saveActivityType:function(){this.$refs.formActivityType.validate(),this.checkValidColor(),this.isValidFormActivityType&&this.isValidColorChoose&&this.isValidColorCustom&&this.createActivityType({name:this.typeActivity.name,color:this.getColor()})},getColor:function(){if("choose"===this.tabs){if(this.isValidFormActivityType&&this.isValidColorChoose&&this.isValidColorCustom)return this.typeActivity.color}else if(this.isValidFormActivityType&&this.isValidColorCustom)return this.hex;return""},createActivityType:function(t){var e=this,i=t.name,a=t.color;this.isLoadingActivityType=!0;var o=this.createNewOrder(this.activityTypes);this.$apollo.mutate({mutation:p["b"],variables:{activityTypeInput:{name:i,color:a,order:o}}}).then((function(){e.$emit("refetch"),e.close(),e.reset(),e.isLoadingActivityType=!1})).catch((function(){var t="No se pudo crear el tipo de actividad, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t}),e.isLoadingActivityType=!1}))},updateTypeActivity:function(){var t=this;this.isLoadingActivityType=!0;var e=this.modal.item.id,i=this.typeActivity.name,a=this.getColor();this.$apollo.mutate({mutation:p["i"],variables:{activityTypeInput:{id:e,name:i,color:a}}}).then((function(){t.$emit("refetch"),t.isLoadingActivityType=!1,t.close()})).catch((function(){t.isLoadingActivityType=!1;var e="No se pudo actualizar el tipo de actividad, intente de nuevo o contacte a soporte";t.modalHandlerError({isOpen:!0,error:e})}))},reset:function(){this.typeActivity={name:"",color:""},this.isValidColorChoose=!0,this.isValidColorCustom=!0,this.tabs="choose",this.$refs.formActivityType&&this.$refs.formActivityType.resetValidation()}}},C=f,g=i("0c7c"),T=i("6544"),A=i.n(T),b=i("8336"),x=i("b0af"),V=i("99d9"),k=i("cc20"),_=i("ef9a"),L=i("03a42"),I=i("169a"),D=i("ce7e"),w=i("4bd4"),E=i("132d"),M=i("0fd9"),O=i("2fa4"),$=i("71a3"),q=i("c671"),F=i("fe57"),S=i("8654"),j=Object(g["a"])(C,v,m,!1,null,"e49620cc",null),H=j.exports;A()(j,{VBtn:b["a"],VCard:x["a"],VCardActions:V["a"],VCardText:V["c"],VCardTitle:V["d"],VChip:k["a"],VChipGroup:_["a"],VColorPicker:L["a"],VDialog:I["a"],VDivider:D["a"],VForm:w["a"],VIcon:E["a"],VRow:M["a"],VSpacer:O["a"],VTab:$["a"],VTabItem:q["a"],VTabs:F["a"],VTextField:S["a"]});var B=i("ffd2"),R=i("e815"),z=i("0908"),N={name:"TypeActivities",mixins:[u["b"],u["a"],d["a"],c["a"],y["a"]],components:{ModalActivityType:H,draggable:l.a,BaseModalDeleteItem:z["a"]},data:function(){return{isOpenModalSelectCalendar:!1,isLoadingAddCalendar:!1,isLoadingRemoveCalendar:!1,isLoadingDelete:!1,configModalDelete:{title:"Desvincular calendario",subtitle:"Estas por quitar tu calendario",description:"Se perderán tus datos de actividades, ¿estás seguro?"},itemSelected:{},itemTypeActivitySelected:{},isOpenDelete:!1,changeCalendar:!1,activityTypes:[],selectedCalendar:"",getGmailUri:"",listCalendar:[],userCurrent:{},isLoading:!1,isLoadingRemove:!1}},watch:{"$route.query.code":{handler:function(t){t&&this.sendTokenCalendar()},immediate:!0},"userCurrent.integrations":{handler:function(t){if((null===t||void 0===t?void 0:t.length)>0){var e=t.some((function(t){return"googleCalendar"===t.name}));e&&(this.selectedCalendar=t.find((function(t){return"googleCalendar"===t.name})).keyItem,""===this.selectedCalendar&&(this.isOpenModalSelectCalendar=!0))}}}},computed:{listActivityTypes:function(){if(this.activityTypes){var t=Object(r["a"])(this.activityTypes);return this.sortList(t)}return[]},hasCalendarIntegration:function(){return!this.userCurrent.integrations||this.userCurrent.integrations.some((function(t){return"googleCalendar"===t.name}))},hasCalendarComplete:function(){if(this.userCurrent.integrations){var t=this.userCurrent.integrations.find((function(t){return"googleCalendar"===t.name}));return!!(t&&t.id&&t.keyItem)}return!1},hasSelectCalendar:function(){return!!this.userCurrent.integrations&&this.userCurrent.integrations.find((function(t){return"googleCalendar"===t.name})).keyItem},getCalendarIntegracionId:function(){if(this.hasCalendarIntegration){var t=this.userCurrent.integrations.find((function(t){return"googleCalendar"===t.name})).keyItem;if(t){var e=this.listCalendar.find((function(e){return e.id===t}));return(null===e||void 0===e?void 0:e.summary)||""}}return""}},methods:{saveCalendar:function(t){this.selectedCalendar=t,this.setCalendar()},sortList:function(t){return t.sort((function(t,e){return t.order>e.order?1:-1}))},changeOrder:function(t){var e=t.moved,i=Object(r["a"])(this.listActivityTypes),a=this.updateOrder(e.newIndex,e.oldIndex,this.sortList(i)),o=this.listActivityTypes[e.newIndex].id,s=this.activityTypes.findIndex((function(t){return t.id===o}));this.activityTypes[s].order=a,this.updateTypeActivity(Object(n["a"])(Object(n["a"])({},e.element),{},{order:a}))},openModalActivityType:function(){this.changeModal({id:"createActivityType",status:!0})},addCalendar:function(){var t=this.getCalendarUri;window.location.href=t},sendTokenCalendar:function(){var t=this,e=this.$route.query.code;this.$apollo.mutate({mutation:p["g"],variables:{codeToken:e},update:function(t,e){var i=e.data.syncronizeGoogleCalendar;if(i.success){var a=t.readQuery({query:R["k"]});a.userCurrent.integrations.push({__typename:"Integration",id:Math.random().toString(36).slice(2),name:"googleCalendar",email:i.email,keyItem:""}),t.writeQuery({query:R["k"],data:a})}}}).then((function(e){var i=e.data.syncronizeGoogleCalendar;t.isLoadingAddEmail=!1,i.success||t.$router.push({name:"settings-calendar"})})).catch((function(){}))},remove:function(){this.itemSelected={name:this.getCalendarIntegracionId},this.changeModal({id:"deleteTemplateEmail",status:!0})},removeTokenCalendar:function(){var t=this;this.isLoadingDelete=!0,this.isLoadingRemoveCalendar=!0,this.$apollo.mutate({mutation:p["e"],update:function(e,i){var a=i.data.desynchronizeGoogleCalendar;if(a){var o=e.readQuery({query:R["k"]});o.userCurrent.integrations=t.userCurrent.integrations.filter((function(t){return"googleCalendar"!==t.name})),e.writeQuery({query:R["k"],data:o})}}}).then((function(){t.isLoadingRemoveCalendar=!1,t.isLoadingDelete=!1,t.changeModal({id:"deleteTemplateEmail",status:!1})})).catch((function(){t.isLoadingRemoveCalendar=!1,t.isLoadingDelete=!1}))},setCalendar:function(){var t=this;this.isLoadingAddCalendar=!0;var e=this.selectedCalendar;this.$apollo.mutate({mutation:p["f"],variables:{calendarId:e},update:function(e,i){var a=i.data.setPrimaryCalendar;if(a.success){var o=e.readQuery({query:R["k"]}),n=o.userCurrent.integrations.findIndex((function(t){return"googleCalendar"===t.name}));o.userCurrent.integrations[n].keyItem=t.selectedCalendar,e.writeQuery({query:R["k"],data:o})}}}).then((function(){t.isLoadingAddCalendar=!1,t.changeCalendar=!1,t.isOpenModalSelectCalendar=!1})).catch((function(){t.isLoadingAddCalendar=!1,t.changeCalendar=!1,t.isOpenModalSelectCalendar=!1}))},updateTypeActivities:function(){this.$apollo.queries.activityTypes.refetch()},updateTypeActivity:function(t){var e=this,i=t.id,a=t.order;this.$apollo.mutate({mutation:p["i"],variables:{activityTypeInput:{id:i,order:a}}}).then((function(){e.updateTypeActivities()})).catch((function(){}))},openModalRemoveTypeActivity:function(t){this.modalHandlerDelete({isOpen:!0,isLoading:!1,message:{nameItem:"El tipo de actividad ".concat(t.name),text:"será eliminado"},infoDelete:{data:t}})},removeTypeActivity:function(t){var e=this,i=t.isOpen,a=t.isLoading,o=t.message,n=t.infoDelete;this.modalHandlerDelete({isOpen:i,isLoading:a,message:o,infoDelete:n});var r=n.data.id;this.$apollo.mutate({mutation:p["d"],variables:{activityTypeId:r}}).then((function(){e.modalHandlerDelete({isOpen:!1,isLoading:a,message:o,infoDelete:n}),e.updateTypeActivities()})).catch((function(){e.modalHandlerDelete({isOpen:!1,isLoading:a,message:o,infoDelete:n});var t="No se pudo eliminar el tipo de actividad, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}))},editTypeActivity:function(t){this.changeModal({id:"createActivityType",status:!0,item:t,isEdit:!0})}},apollo:{getCalendarUri:{query:B["e"]},listCalendar:{query:B["f"],skip:function(){return!this.hasCalendarIntegration}},userCurrent:{query:R["k"]},activityTypes:{fetchPolicy:"no-cache",query:B["c"]}}},G=N,Q=(i("e5d7"),i("8860")),P=i("da13"),U=i("1800"),J=i("5d23"),K=i("3a2f"),W=Object(g["a"])(G,a,o,!1,null,"3d1481e2",null);e["default"]=W.exports;A()(W,{VBtn:b["a"],VCard:x["a"],VChip:k["a"],VIcon:E["a"],VList:Q["a"],VListItem:P["a"],VListItemAction:U["a"],VListItemContent:J["a"],VListItemTitle:J["c"],VTooltip:K["a"]})},e5d7:function(t,e,i){"use strict";i("f5c0")},f5c0:function(t,e,i){}}]);
//# sourceMappingURL=chunk-3ba394e6.2a7a22bc.js.map