(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b3926e8","chunk-7859f8ee","chunk-7859f8ee"],{"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"4ee1":function(t,e,a){"use strict";a("8599")},"841c":function(t,e,a){"use strict";var i=a("d784"),n=a("825a"),s=a("1d80"),r=a("129f"),o=a("14c3");i("search",(function(t,e,a){return[function(e){var a=s(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a):new RegExp(e)[t](String(a))},function(t){var i=a(e,this,t);if(i.done)return i.value;var s=n(this),l=String(t),c=s.lastIndex;r(c,0)||(s.lastIndex=0);var u=o(s,l);return r(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},8599:function(t,e,a){},b2a1:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-row",[a("v-col",{staticClass:"primary d-flex pl-12",attrs:{cols:"6"}},[a("v-simple-checkbox",{staticClass:"shrink mr-4",attrs:{color:"white",dense:"","hide-details":"auto",dark:""},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}}),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{color:"white",icon:""},on:{click:t.updateListEmails}},"v-btn",n,!1),i),[a("v-icon",[t._v(" mdi-refresh ")])],1)]}}])},[a("span",[t._v("Actualizar")])]),t.selected.length?[t.isTrash?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{icon:"",color:"secondary"},on:{click:t.deleteEmails}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-delete")])],1)]}}],null,!1,1684322152)},[a("span",[t._v("Eliminar")])]):a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{color:"secondary",icon:""},on:{click:function(e){return t.sendToTrashEmail(!0)}}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-delete")])],1)]}}],null,!1,2413082121)},[a("span",[t._v("Enviar a la papelera")])]),t.isTrash?a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{color:"white",icon:""},on:{click:function(e){return t.sendToTrashEmail(!1)}}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-folder-move")])],1)]}}],null,!1,353514764)},[a("span",[t._v("Restaurar")])]):t._e()]:t._e(),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[t.selected.length&&t.hasRead?a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{color:"white",icon:""},on:{click:function(e){return t.markReadEmail(!0)}}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-email-open")])],1):t._e()]}}])},[a("span",[t._v("Marcar como leído")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,n=e.attrs;return[t.selected.length&&t.hasUnRead?a("v-btn",t._g(t._b({staticClass:"mr-4",attrs:{color:"white",icon:""},on:{click:function(e){return t.markReadEmail(!1)}}},"v-btn",n,!1),i),[a("v-icon",[t._v("mdi-email")])],1):t._e()]}}])},[a("span",[t._v("Marcar como no leído")])])],2),a("v-col",{staticClass:"primary",attrs:{cols:"6"}},[a("v-text-field",{attrs:{placeholder:"Buscar...","hide-details":"auto",outlined:"",dense:"",dark:"","append-icon":"mdi-magnify"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),t.error?a("v-col",{attrs:{cols:"12"}},[a("v-alert",{attrs:{outlined:"",type:"error"}},[a("v-row",{attrs:{align:"center"}},[a("v-col",{staticClass:"grow"},[t._v(" Ocurrio un error inesperado ")]),a("v-col",{staticClass:"shrink"},[a("v-btn",[t._v("Volver a intentar")])],1)],1)],1)],1):a("v-col",{staticClass:"pt-0 pl-8",attrs:{cols:"12"}},[a("v-divider"),a("v-data-table",{staticClass:"mt-5",attrs:{headers:t.headers,items:t.listByPage,"item-key":"id","show-select":"","hide-default-header":"",outlined:"",loading:t.$apollo.queries.inboxListGmail.loading,"server-items-length":t.messagesTotal,page:t.page,"footer-props":t.footerProps,"hide-default-footer":""},on:{"click:row":t.openEmail,"update:items-per-page":t.updateItemsPerPage,"update:page":t.updatePage},scopedSlots:t._u([{key:"header.data-table-select",fn:function(e){var i=e.on,n=e.props;return[a("v-simple-checkbox",t._g(t._b({attrs:{color:"secondary"}},"v-simple-checkbox",n,!1),i))]}},{key:"item.data-table-select",fn:function(t){var e=t.isSelected,i=t.select;return[a("v-simple-checkbox",{attrs:{color:"secondary",value:e},on:{input:function(t){return i(t)}}})]}},{key:"item.trackId",fn:function(e){var i=e.item;return[i.trackId?a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":200,"offset-x":"","max-width":220},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,s=e.attrs;return[a("v-btn",t._g(t._b({attrs:{small:"",icon:""},on:{click:function(e){return e.stopPropagation(),t.showHistoryTracking(i.trackId)}}},"v-btn",s,!1),n),[a("v-icon",{attrs:{small:""}},[t._v(" mdi-eye ")])],1)]}}],null,!0)},[a("v-card",[t.isLoadingTracking?a("v-card-text",{staticClass:"text-center"},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):a("div",[a("v-list",{attrs:{dense:""}},[a("v-list-item",[a("v-list-item-content",[a("v-list-item-title",[t._v(" Historial de seguimiento ")]),a("v-list-item-subtitle",[t._v(" "+t._s(t.getTextSeen(t.trackingHistory.count))+" ")])],1)],1)],1),a("v-divider"),t.trackingHistory.count>0?a("v-list",{attrs:{dense:""}},[a("v-list-item",[a("v-list-item-content",t._l(t.trackingHistory.views,(function(e,i){return a("span",{key:i},[t._v(" "+t._s(t._f("timeZoneFromNow")(e.viewedAt))+" ")])})),0)],1)],1):t._e()],1)],1)],1):t._e()]}},{key:"item.name",fn:function(e){var i=e.item,n=i.name,s=i.isRead;return[a("span",{staticClass:"d-inline-block text-truncate",class:{"font-weight-bold":s},staticStyle:{"max-width":"150px"}},[t.isTrash?a("v-icon",[t._v("mdi-delete")]):t._e(),t._v(" "+t._s(n)+" ")],1)]}},{key:"item.subject",fn:function(e){var i=e.item,n=i.subject,s=i.isRead;return[a("span",{staticClass:"d-inline-block text-truncate",class:{"font-weight-bold":s},staticStyle:{"max-width":"500px"}},[t._v(" "+t._s(n)+" ")])]}},{key:"item.icon",fn:function(e){var i=e.item.icon;return[a("v-icon",[t._v(" "+t._s(i)+" ")])]}},{key:"item.date",fn:function(e){var a=e.item.date;return[t._v(" "+t._s(t._f("formatDate")(a))+" ")]}},{key:"footer",fn:function(e){var i=e.props;return[a("v-divider"),t.$apollo.queries.inboxListGmail.loading?t._e():a("div",{staticClass:"d-flex justify-center mt-4 pb-6"},[a("v-btn",{staticClass:"mr-6",attrs:{outlined:""},on:{click:function(e){return t.backPage()}}},[a("v-icon",{attrs:{large:""}},[t._v("mdi-chevron-left")])],1),a("v-btn",{attrs:{outlined:""}},[t._v(" "+t._s(i.pagination.page)+" De "+t._s(i.pagination.pageCount)+" ")]),a("v-btn",{staticClass:"ml-6",attrs:{outlined:""},on:{click:function(e){return t.nextPage(i.pagination.pageCount)}}},[a("v-icon",{attrs:{large:""}},[t._v("mdi-chevron-right")])],1)],1)]}}],null,!0),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),a("BaseModalError",{attrs:{modalHandler:t.modalError},on:{close:t.modalHandlerError}})],1)},n=[],s=a("2909"),r=a("1da1"),o=(a("96cf"),a("ac1f"),a("841c"),a("d81d"),a("b0c0"),a("fb6a"),a("99af"),a("159b"),a("7db0"),a("4de4"),a("c740"),a("a434"),a("1891")),l=a("395a"),c=a("bbc9"),u=a("1e6d"),d={name:"EmailList",mixins:[o["b"],o["a"],u["a"]],props:{labelId:{type:String,default:"INBOX"},query:{type:String,default:""}},data:function(){return{isLoadingTracking:!1,trackingHistory:{},search:"",error:!1,pagination:[],page:1,pageToken:"",itemsPerPage:15,inboxListGmail:[],checkAll:!1,selected:[],headers:[{text:"",value:"trackId",align:"start",sortable:!1},{text:"Enviado por",value:"name",align:"start",sortable:!1},{text:"Asunto",value:"subject",align:"start",sortable:!1},{text:"Icono",value:"icon",align:"end",sortable:!1},{text:"Fecha",value:"date",align:"end"}],footerProps:{"items-per-page-options":[15,30,50,100]}}},created:function(){this.updateListEmails()},watch:{checkAll:function(t){t?this.selectAll():this.selected=[]}},computed:{hasRead:function(){return this.selected.some((function(t){return t.isRead}))},hasUnRead:function(){return this.selected.some((function(t){return!t.isRead}))},messagesTotal:function(){return this.inboxListGmail.messages?this.search.length>0?this.inboxListGmail.resultSizeEstimate:this.inboxListGmail.messagesTotal:0},listEmails:function(){return this.inboxListGmail.messages?this.inboxListGmail.messages.map((function(t){var e=t.labelIds.some((function(t){return"UNREAD"===t}));return{id:t.id,name:t.from.value[0].name||t.from.value[0].address,subject:t.subject,icon:t.attachments.length>0?"mdi-attachment":"",date:t.date,isRead:e,trackId:t.trackId}})):[]},listByPage:function(){return this.itemsPerPage>0?this.listEmails.slice((this.page-1)*this.itemsPerPage,this.page*this.itemsPerPage):[]},isTrash:function(){return"TRASH"===this.labelId},queryMaster:function(){return this.search.length>0?(this.resetData(),"".concat(this.query," ").concat(this.search)):this.query}},methods:{nextPage:function(t){if(t!==this.page){var e=this.page+1;this.updatePage(e)}},backPage:function(){1!==this.page&&(this.page-=1)},getTextSeen:function(t){return 1===t?"Visto 1 vez":"Visto ".concat(t," veces")},showHistoryTracking:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isLoadingTracking=!0,a.next=3,e.$apollo.query({query:l["f"],client:"email",fetchPolicy:"no-cache",variables:{id:t}});case 3:i=a.sent,n=i.data.getTrakingList,e.$nextTick((function(){e.trackingHistory=n,e.isLoadingTracking=!1}));case 6:case"end":return a.stop()}}),a)})))()},openEmail:function(t){var e=this.labelId.toLowerCase();this.$router.push("".concat(e,"/").concat(t.id),(function(){}))},openModal:function(){this.changeModal({id:"sendEmail",status:!0})},selectAll:function(){var t=this;this.listByPage.forEach((function(e){t.selected.push(e)}))},updateListEmails:function(){this.resetData(),this.$apollo.queries.inboxListGmail.refetch()},resetData:function(){this.pagination=[],this.page=1,this.pageToken="",this.itemsPerPage=15},updateItemsPerPage:function(t){this.resetData(),this.itemsPerPage=t,this.getEmails()},updatePage:function(t){var e=this.page;1===e&&(this.existPagination(e)||this.pagination.push({page:e})),1!==t&&(this.existPagination(t)?this.pageToken=this.pagination.find((function(e){return e.page===t})).pageToken:(t>e&&(this.pageToken=this.inboxListGmail.nextPageToken,this.getMoreEmails()),this.pagination.push({page:t,pageToken:this.inboxListGmail.nextPageToken}))),this.page=t},existPagination:function(t){return this.pagination.some((function(e){return e.page===t}))},getEmails:function(){this.$apollo.queries.inboxListGmail.refetch({filter:{labelId:this.labelId,maxResults:this.itemsPerPage,q:this.query,pageToken:this.pageToken}})},getMoreEmails:function(){this.$apollo.queries.inboxListGmail.fetchMore({variables:{filter:{labelId:this.labelId,maxResults:this.itemsPerPage,q:this.query,pageToken:this.pageToken}},updateQuery:function(t,e){var a=e.fetchMoreResult,i=a.inboxListGmail,n=i.messages,r=i.nextPageToken,o=i.messagesTotal,l=i.resultSizeEstimate;return{inboxListGmail:{__typename:t.inboxListGmail.__typename,messages:[].concat(Object(s["a"])(t.inboxListGmail.messages),Object(s["a"])(n)),nextPageToken:r,messagesTotal:o,resultSizeEstimate:l}}}})},markReadEmail:function(t){var e=this;this.selected.filter((function(e){return e.isRead===t})).forEach((function(a){e.mutationMarkReadEmail({id:a.id,isRead:t})})),this.selected=[],this.checkAll=!1},mutationMarkReadEmail:function(t){var e=this,a=t.id,i=t.isRead;this.$apollo.mutate({mutation:c["e"],variables:{id:a,isRead:i},update:function(t){var n=t.readQuery({query:l["c"],variables:{filter:{labelId:e.labelId,maxResults:15,q:e.query}}}),s=n.inboxListGmail.messages.findIndex((function(t){return t.id===a}));if(i){var r=n.inboxListGmail.messages[s].labelIds.findIndex((function(t){return"UNREAD"===t}));n.inboxListGmail.messages[s].labelIds.splice(r,1)}else n.inboxListGmail.messages[s].labelIds.push("UNREAD");t.writeQuery({query:l["c"],data:n})},optimisticResponse:{__typename:"Mutation",markEmailGoogleGmail:!0}}).then((function(){})).catch((function(){var t="No se pudo marcar el correo como leído ,intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}))},sendToTrashEmail:function(t){var e=this;this.selected.forEach((function(a){e.mutationSendToTrash({id:a.id,isTrash:t})})),this.selected=[],this.checkAll=!1},mutationSendToTrash:function(t){var e=this,a=t.id,i=t.isTrash;this.$apollo.mutate({mutation:c["g"],variables:{id:a,isTrash:i},update:function(t){var i=t.readQuery({query:l["c"],variables:{filter:{labelId:e.labelId,maxResults:15,q:e.query}}}),n=i.inboxListGmail.messages.findIndex((function(t){return t.id===a}));i.inboxListGmail.messages.splice(n,1),i.inboxListGmail.messagesTotal=e.messagesTotal-1,t.writeQuery({query:l["c"],variables:{filter:{labelId:e.labelId,maxResults:15,q:e.query}},data:i})},optimisticResponse:{__typename:"Mutation",trashEmailGoogleGmail:!0}}).then((function(){})).catch((function(){var t="No se pudo eliminar el correo, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}))},deleteEmails:function(){var t=this;this.selected.forEach((function(e){t.mutationDeleteEmail(e.id)})),this.selected=[],this.checkAll=!1},mutationDeleteEmail:function(t){var e=this;this.$apollo.mutate({mutation:c["b"],variables:{id:t},update:function(a,i){i.data.deleteEmailGoogleGmail;var n=a.readQuery({query:l["c"],variables:{filter:{labelId:e.labelId,maxResults:15,q:e.query}}}),s=n.inboxListGmail.messages.findIndex((function(e){return e.id===t}));n.inboxListGmail.messages.splice(s,1),n.inboxListGmail.messagesTotal=e.messagesTotal-1,a.writeQuery({query:l["c"],variables:{filter:{labelId:e.labelId,maxResults:15,q:e.query}},data:n})},optimisticResponse:{__typename:"Mutation",deleteEmailGoogleGmail:!0}}).then((function(){})).catch((function(){var t="No se pudo eliminar el correo, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}))}},apollo:{inboxListGmail:{query:l["c"],client:"email",variables:function(){return{filter:{labelId:this.labelId,maxResults:15,q:this.queryMaster}}},error:function(){this.error=!0}}}},m=d,h=(a("4ee1"),a("0c7c")),p=a("6544"),v=a.n(p),f=a("0798"),g=a("8336"),b=a("b0af"),k=a("99d9"),x=a("62ad"),_=a("8fea"),y=a("ce7e"),T=a("132d"),E=a("8860"),I=a("da13"),G=a("5d23"),L=a("e449"),R=a("490a"),P=a("0fd9"),w=a("9e88"),q=a("8654"),S=a("3a2f"),C=Object(h["a"])(m,i,n,!1,null,"2910dc54",null);e["a"]=C.exports;v()(C,{VAlert:f["a"],VBtn:g["a"],VCard:b["a"],VCardText:k["c"],VCol:x["a"],VDataTable:_["a"],VDivider:y["a"],VIcon:T["a"],VList:E["a"],VListItem:I["a"],VListItemContent:G["a"],VListItemSubtitle:G["b"],VListItemTitle:G["c"],VMenu:L["a"],VProgressCircular:R["a"],VRow:P["a"],VSimpleCheckbox:w["a"],VTextField:q["a"],VTooltip:S["a"]})},bbc9:function(t,e,a){"use strict";a.d(e,"d",(function(){return m})),a.d(e,"g",(function(){return h})),a.d(e,"e",(function(){return p})),a.d(e,"b",(function(){return v})),a.d(e,"f",(function(){return f})),a.d(e,"a",(function(){return g})),a.d(e,"c",(function(){return b}));var i,n,s,r,o,l,c,u=a("8785"),d=a("5184"),m=Object(d["a"])(i||(i=Object(u["a"])(["\n  mutation getTokensG($codeToken: String!) {\n    syncronizeGoogleGmail(codeToken: $codeToken) {\n      success\n      email\n    }\n  }\n"]))),h=Object(d["a"])(n||(n=Object(u["a"])(["\n  mutation sentToTrash($id: String!, $isTrash: Boolean!) {\n    trashEmailGoogleGmail(id: $id, isTrash: $isTrash)\n  }\n"]))),p=Object(d["a"])(s||(s=Object(u["a"])(["\n  mutation markReadEmail($id: String!, $isRead: Boolean!) {\n    markEmailGoogleGmail(id: $id, isRead: $isRead)\n  }\n"]))),v=Object(d["a"])(r||(r=Object(u["a"])(["\n  mutation deleteEmail($id: String!) {\n    deleteEmailGoogleGmail(id: $id)\n  }\n"]))),f=Object(d["a"])(o||(o=Object(u["a"])(["\n  mutation sendEmail($gmailInput: GmailEmailInput!) {\n    sendMailGoogleMail(gmailInput: $gmailInput)\n  }\n"]))),g=Object(d["a"])(l||(l=Object(u["a"])(["\n  mutation createSignature(\n    $userEnterpriseInput: UserEnterpriseCreateSignatureInput!\n  ) {\n    createOrUpdateSignature(userEnterpriseInput: $userEnterpriseInput) {\n      id\n      signature\n    }\n  }\n"]))),b=Object(d["a"])(c||(c=Object(u["a"])(["\n  mutation desynchronizeGoogleGmail {\n    desynchronizeGoogleGmail\n  }\n"])))}}]);
//# sourceMappingURL=chunk-3b3926e8.9b258a01.js.map