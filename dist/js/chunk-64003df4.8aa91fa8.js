(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64003df4"],{1495:function(e,a,n){"use strict";n("c757")},4420:function(e,a,n){"use strict";n.d(a,"a",(function(){return t}));var t={data:function(){return{snackbar:{isOpen:!1,color:"",text:""}}},methods:{snackbarHandler:function(e){var a=e.isOpen,n=e.color,t=e.text;this.snackbar={isOpen:a,color:n,text:t}}}}},bdc8:function(e,a,n){"use strict";n.r(a);var t=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"d-flex justify-center"},[n("v-card",{staticClass:"settings-calendar-box",attrs:{tile:"",flat:"",width:"35em",height:"35em"}},[e.hasCalendarIntegration?[e.hasCalendarIntegration?n("div",{staticClass:"d-flex align-center full-heigth"},[n("div",{staticClass:"d-flex flex-column mx-12",staticStyle:{width:"100%"}},[n("span",{staticClass:"mb-6 title-activities-types"},[e._v(" Sincronización de calendario ")]),e.isOpenModalSelectCalendar?n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):e._e(),n("v-text-field",{attrs:{readonly:"",outlined:"",dense:"",value:e.selectedCalendarEmail,label:"Correo"},scopedSlots:e._u([{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"success"}},[e._v("mdi-check-circle")])]},proxy:!0}],null,!1,1576228658)}),!e.changeCalendar&&e.hasCalendarComplete?n("v-text-field",{attrs:{label:"Calendario",readonly:"",outlined:"",dense:"",value:e.getCalendarIntegracionId},scopedSlots:e._u([{key:"append",fn:function(){return[n("v-icon",{attrs:{color:"success"}},[e._v("mdi-check-circle")])]},proxy:!0}],null,!1,1576228658)}):e._e(),e.changeCalendar||!e.hasCalendarComplete?n("v-select",{attrs:{dense:"",items:e.listCalendar,"item-text":"summary","item-value":"id",label:"Selecciona un calendario",outlined:""},model:{value:e.selectedCalendar,callback:function(a){e.selectedCalendar=a},expression:"selectedCalendar"}}):e._e(),!e.changeCalendar&&e.hasCalendarComplete?n("div",{staticClass:"d-flex justify-end"},[n("v-btn",{staticClass:"ml-3",attrs:{outlined:"",small:""},on:{click:e.remove}},[e._v(" Quitar ")]),n("v-btn",{staticClass:"mx-3",attrs:{small:"",color:"primary"},on:{click:function(a){e.changeCalendar=!0}}},[e._v(" Editar ")]),n("v-btn",{attrs:{small:"",color:"secondary"},on:{click:e.addCalendar}},[e._v(" Cambiar ")])],1):n("div",{staticClass:"d-flex justify-end"},[e.hasSelectCalendar?n("v-btn",{staticClass:"mt-2 mr-3",attrs:{small:"",outlined:"",color:"primary"},on:{click:function(a){e.changeCalendar=!1}}},[e._v(" Cancelar ")]):e._e(),n("v-btn",{staticClass:"mt-2",attrs:{small:"",color:"secondary",loading:e.isLoadingAddCalendar,disabled:e.hasSelectCalendar===e.selectedCalendar},on:{click:e.setCalendar}},[e._v(" Guardar ")])],1)],1)]):e._e()]:n("div",{staticClass:"d-flex align-content-center justify-center flex-wrap full-heigth"},[n("p",{staticClass:"text-center mx-4"},[e._v(" Sincroniza tu calendario principal con tu cuenta para crear actividades. ")]),n("v-btn",{attrs:{color:"success"},on:{click:e.addCalendar}},[e._v(" Añadir calendario ")])],1)],2),n("BaseModalDeleteItem",{attrs:{dialog:e.isOpenDelete,config:e.configModalDelete,isLoading:e.isLoadingDelete,item:e.itemSelected},on:{"update:dialog":function(a){e.isOpenDelete=a},remove:e.removeTokenCalendar}}),n("ModalSelectCalendar",{attrs:{dialog:e.isOpenModalSelectCalendar,loading:e.isLoadingAddCalendar,listCalendar:e.listCalendar},on:{"update:dialog":function(a){e.isOpenModalSelectCalendar=a},saveCalendar:e.saveCalendar}}),n("BaseModalError",{attrs:{modalHandler:e.modalError},on:{close:e.modalHandlerError}}),n("v-snackbar",{attrs:{color:e.snackbar.color,timeout:5e3},scopedSlots:e._u([{key:"action",fn:function(){return[n("v-btn",{attrs:{text:""},on:{click:function(a){return e.snackbarHandler({isOpen:!1,color:"",text:""})}}},[e._v(" Cerrar ")])]},proxy:!0}]),model:{value:e.snackbar.isOpen,callback:function(a){e.$set(e.snackbar,"isOpen",a)},expression:"snackbar.isOpen"}},[e._v(" "+e._s(e.snackbar.text)+" ")])],1)},r=[],i=(n("b0c0"),n("7db0"),n("4e827"),n("c740"),n("fb6a"),n("d3b7"),n("25f0"),n("4de4"),n("c0ca")),l=n("3398"),o=n("1891"),s=n("949a"),d=n("ffd2"),c=n("e815"),u=n("0908"),C=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("v-dialog",{attrs:{scrollable:"","max-width":"430px",persistent:""},model:{value:e.dialog,callback:function(a){e.dialog=a},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"primary white--text"},[e._v(" Sincronización de calendario "),n("v-spacer"),n("v-btn",{staticClass:"mr-1",attrs:{icon:"",color:"white"},on:{click:e.close}},[n("v-icon",[e._v("mdi-close")])],1)],1),n("v-divider"),n("v-card-text",{staticClass:"py-5"},[n("span",{staticClass:"font-weight-bold pb-2"},[e._v(" Para finalizar elije un calendario: ")]),n("v-select",{attrs:{dense:"",items:e.listCalendar,"item-text":"summary","item-value":"id",label:"Selecciona un calendario",outlined:"","hide-details":"auto"},model:{value:e.selectedCalendar,callback:function(a){e.selectedCalendar=a},expression:"selectedCalendar"}})],1),n("v-divider"),n("v-card-actions",[n("v-btn",{attrs:{color:"primary",outlined:""},on:{click:e.close}},[e._v(" Cancelar ")]),n("v-spacer"),n("v-btn",{attrs:{color:"secondary",loading:e.loading,disabled:""===e.selectedCalendar},on:{click:e.save}},[e._v(" Guardar ")])],1)],1)],1)},m=[],f={name:"ModalSelectCalendar",props:{dialog:{type:Boolean,default:!1},listCalendar:{type:Array,default:function(){return[]}},loading:{type:Boolean,default:!1}},data:function(){return{selectedCalendar:""}},methods:{close:function(){this.$emit("update:dialog",!1)},save:function(){this.$emit("saveCalendar",this.selectedCalendar)}}},g=f,v=n("0c7c"),p=n("6544"),h=n.n(p),y=n("8336"),b=n("b0af"),k=n("99d9"),x=n("169a"),S=n("ce7e"),_=n("132d"),O=n("b974"),I=n("2fa4"),L=Object(v["a"])(g,C,m,!1,null,"49ff677c",null),w=L.exports;h()(L,{VBtn:y["a"],VCard:b["a"],VCardActions:k["a"],VCardText:k["c"],VCardTitle:k["d"],VDialog:x["a"],VDivider:S["a"],VIcon:_["a"],VSelect:O["a"],VSpacer:I["a"]});var M=n("1e6d"),E=n("4420"),V={name:"SettingsCalendar",mixins:[o["b"],o["a"],l["a"],i["a"],M["a"],E["a"]],components:{BaseModalDeleteItem:u["a"],ModalSelectCalendar:w},data:function(){return{isOpenModalSelectCalendar:!1,isLoadingAddCalendar:!1,isLoadingRemoveCalendar:!1,isLoadingDelete:!1,configModalDelete:{title:"Desvincular calendario",subtitle:"Estas por quitar tu calendario",description:"Se perderán tus datos de actividades, ¿estás seguro?"},itemSelected:{},isOpenDelete:!1,changeCalendar:!1,selectedCalendar:"",selectedCalendarEmail:"",getGmailUri:"",listCalendar:[],userCurrent:{},isLoading:!1,isLoadingRemove:!1}},watch:{"$route.query.code":{handler:function(e){e&&this.sendTokenCalendar()},immediate:!0},"userCurrent.integrations":{handler:function(e){if((null===e||void 0===e?void 0:e.length)>0){var a=e.some((function(e){return"googleCalendar"===e.name}));a&&(this.selectedCalendar=e.find((function(e){return"googleCalendar"===e.name})).keyItem,this.selectedCalendarEmail=e.find((function(e){return"googleCalendar"===e.name})).email,""===this.selectedCalendar&&(this.isOpenModalSelectCalendar=!0))}}}},computed:{hasCalendarIntegration:function(){return!this.userCurrent.integrations||this.userCurrent.integrations.some((function(e){return"googleCalendar"===e.name}))},hasCalendarComplete:function(){if(this.userCurrent.integrations){var e=this.userCurrent.integrations.find((function(e){return"googleCalendar"===e.name}));return!!(e&&e.id&&e.keyItem)}return!1},hasSelectCalendar:function(){return!!this.userCurrent.integrations&&this.userCurrent.integrations.find((function(e){return"googleCalendar"===e.name})).keyItem},getCalendarIntegracionId:function(){if(this.hasCalendarIntegration){var e=this.userCurrent.integrations.find((function(e){return"googleCalendar"===e.name})).keyItem;if(e){var a=this.listCalendar.find((function(a){return a.id===e}));return(null===a||void 0===a?void 0:a.summary)||""}}return""}},methods:{saveCalendar:function(e){this.selectedCalendar=e,this.setCalendar()},sortList:function(e){return e.sort((function(e,a){return e.order>a.order?1:-1}))},addCalendar:function(){var e=this.getCalendarUri;window.location.href=e},sendTokenCalendar:function(){var e=this,a=this.$route.query.code;this.$apollo.mutate({mutation:s["g"],variables:{codeToken:a},update:function(e,a){var n=a.data.syncronizeGoogleCalendar;if(n.success){var t=e.readQuery({query:c["k"]}),r=t.userCurrent.integrations.findIndex((function(e){return"googleCalendar"===e.name}));r?t.userCurrent.integrations[r]={__typename:"Integration",id:Math.random().toString(36).slice(2),name:"googleCalendar",email:n.email,keyItem:""}:t.userCurrent.integrations.push({__typename:"Integration",id:Math.random().toString(36).slice(2),name:"googleCalendar",email:n.email,keyItem:""}),e.writeQuery({query:c["k"],data:t})}}}).then((function(a){var n=a.data.syncronizeGoogleCalendar;if(n.success)e.isLoadingAddEmail=!1,e.$apollo.queries.listCalendar.refresh(),e.$router.push({name:"settings-calendar"}),e.snackbarHandler({isOpen:!0,color:"success",text:"Se vinculo el calendario correctamente."});else{var t="El token no es válido, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}})).catch((function(){var a="Ocurrió un error, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:a})}))},remove:function(){this.itemSelected={name:this.getCalendarIntegracionId},this.changeModal({id:"deleteTemplateEmail",status:!0})},removeTokenCalendar:function(){var e=this;this.isLoadingDelete=!0,this.isLoadingRemoveCalendar=!0,this.$apollo.mutate({mutation:s["e"],update:function(a,n){var t=n.data.desynchronizeGoogleCalendar;if(t){var r=a.readQuery({query:c["k"]});r.userCurrent.integrations=e.userCurrent.integrations.filter((function(e){return"googleCalendar"!==e.name})),a.writeQuery({query:c["k"],data:r})}}}).then((function(){e.isLoadingRemoveCalendar=!1,e.isLoadingDelete=!1,e.changeModal({id:"deleteTemplateEmail",status:!1}),e.snackbarHandler({isOpen:!0,color:"success",text:"Se desvinculo el calendario correctamente."})})).catch((function(){e.isLoadingRemoveCalendar=!1,e.isLoadingDelete=!1;var a="Ocurrió un error, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:a})}))},setCalendar:function(){var e=this;this.isLoadingAddCalendar=!0;var a=this.selectedCalendar;this.$apollo.mutate({mutation:s["f"],variables:{calendarId:a},update:function(a,n){var t=n.data.setPrimaryCalendar;if(t.success){var r=a.readQuery({query:c["k"]}),i=r.userCurrent.integrations.findIndex((function(e){return"googleCalendar"===e.name}));r.userCurrent.integrations[i].keyItem=e.selectedCalendar,a.writeQuery({query:c["k"],data:r})}}}).then((function(){e.isLoadingAddCalendar=!1,e.changeCalendar=!1,e.isOpenModalSelectCalendar=!1,e.snackbarHandler({isOpen:!0,color:"success",text:"Se conecto el calendario correctamente."})})).catch((function(){e.isLoadingAddCalendar=!1,e.changeCalendar=!1,e.isOpenModalSelectCalendar=!1;var a="Ocurrió un error, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:a})}))}},apollo:{getCalendarUri:{query:d["e"],fetchPolicy:"no-cache"},listCalendar:{query:d["f"],fetchPolicy:"no-cache",skip:function(){return!this.hasCalendarIntegration}},userCurrent:{query:c["k"]}}},D=V,q=(n("1495"),n("490a")),$=n("2db4"),H=n("8654"),A=Object(v["a"])(D,t,r,!1,null,"89e71bc2",null);a["default"]=A.exports;h()(A,{VBtn:y["a"],VCard:b["a"],VIcon:_["a"],VProgressCircular:q["a"],VSelect:O["a"],VSnackbar:$["a"],VTextField:H["a"]})},c757:function(e,a,n){}}]);
//# sourceMappingURL=chunk-64003df4.8aa91fa8.js.map