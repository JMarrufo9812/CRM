{"version":3,"sources":["webpack:///./src/mixins/dealsMixin.js","webpack:///./node_modules/core-js/internals/same-value.js","webpack:///./src/graphql/mutations/contactsMutations.js","webpack:///./src/components/profile/DealContact.vue?2d26","webpack:///./src/mixins/contactsMixin.js","webpack:///./src/components/profile/DealContact.vue?5124","webpack:///src/components/profile/DealContact.vue","webpack:///./src/components/profile/DealContact.vue?ec58","webpack:///./src/components/profile/DealContact.vue?b5ee","webpack:///./src/graphql/mutations/dealsMutations.js","webpack:///./node_modules/core-js/modules/es.string.search.js"],"names":["dealsMixin","data","PERMISSIONS_DEALS","inputsForm","isLoadingDeals","loadingSearch","isLoadingUpdateDeal","modalDeal","isOpen","isLoading","infoError","icon","title","message","filters","search","orderBy","skip","take","sortBy","sortDesc","isDelete","listDeals","informationBarDeals","resultSearchDeals","totalDeals","searchDeal","searchFilters","dealsSelected","watch","value","Object","keys","length","this","getSearchDeals","$emit","computed","menuProps","methods","modalHandlerDeal","createDeal","contact","company","tags","customForms","expectedCloseDate","pipeline","pipelineId","stageId","owner","$apollo","mutate","mutation","CREATE_DEAL","variables","input","id","ownerId","then","updateData","$route","name","updateViewPipeline","params","setTimeout","typeItem","updateHistory","addDeal","catch","error","modalHandlerError","updateDeal","status","comments","lostReason","customForm","undefined","UPDATE_DEAL","modalHandlerLostDeal","query","GET_SEARCH_DEALS","fetchPolicy","deals","list","getDeals","GET_DEALS","importId","filterId","informationBar","map","deal","forEach","count","isErrorDeals","restoreDealsConfirmation","modalHandlerRestore","nameItem","text","infoRestore","restoreDeals","RESTORE_DEALS","update","snackbarHandler","color","finally","deleteDealConfirmation","type","modalHandlerDelete","infoDelete","deleteDeal","DELETE_DEAL","trashDealsConfirmation","trashDeals","TRASH_DEALS","goToProfile","$router","push","module","exports","is","x","y","CREATE_CONTACT","gql","UPDATE_CONTACT","DELETE_CONTACTS","TRASH_CONTACTS","RESTORE_CONTACTS","FUSE_CONTACTS","UPDATE_OWNER_CONTACTS","contactsMixin","isLoadingUpdateContact","updateContact","email","birthday","phones","isClient","socialMedias","contactInput","render","_vm","_h","$createElement","_c","_self","attrs","staticClass","_v","canEditDeal","canEditDealOthers","item","_e","scopedSlots","_u","key","fn","ref","onMenu","on","directives","rawName","expression","onTooltip","_g","$event","isShowAddContact","assign","_s","contactSelected","model","callback","$$v","class","isDense","deleteContact","staticStyle","cancel","disabledAddButton","addContact","goContact","isLoadingRemove","_b","stopPropagation","disconnectContact","canEditContact","canEditContactOthers","isEdit","isValidateFormName","rules","general","contactName","isLoadingChangeName","cancelEdit","updateName","modalError","staticRenderFns","components","FieldSelectContactSimple","mixins","rulesMixin","props","required","itemId","String","default","UPDATE","UPDATE_OTHERS","PERMISSIONS_CONTACTS","PERMISSIONS_GROUP_DEAL","PERMISSIONS_GROUP_CONTACT","searchContacts","isNewContact","contactNew","contactRules","isValidate","userCurrent","created","$refs","formContact","reset","ability","hasSearch","readOnly","validate","apollo","component","VBtn","VCard","VCardText","VCardTitle","VDivider","VForm","VIcon","VListItem","VListItemAction","VListItemContent","VList","VListItemTitle","VMenu","VProgressCircular","VSpacer","VTextField","VTooltip","CHANGE_DEAL_STAGE","CHANGE_DEAL_PIPELINE","CREATE_LOST_REASON","DELETE_LOST_REASON","UPDATE_LOST_REASON","UPDATE_OWNER_DEALS","fixRegExpWellKnownSymbolLogic","anObject","requireObjectCoercible","sameValue","regExpExec","SEARCH","nativeSearch","maybeCallNative","regexp","O","searcher","call","RegExp","string","res","done","rx","S","previousLastIndex","lastIndex","result","index"],"mappings":"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","file":"js/chunk-ea606578.32a2a1ca.js","sourcesContent":["import {\n  CREATE_DEAL,\n  DELETE_DEAL,\n  UPDATE_DEAL,\n  TRASH_DEALS,\n  RESTORE_DEALS,\n} from '@/graphql/mutations/dealsMutations';\nimport { GET_DEALS, GET_SEARCH_DEALS } from '@/graphql/querys/dealsQuery';\nimport { PERMISSIONS_DEALS } from '@/constants/permissions';\n\nexport const dealsMixin = {\n  data() {\n    return {\n      PERMISSIONS_DEALS,\n      inputsForm: [],\n      isLoadingDeals: false,\n      loadingSearch: false,\n      isLoadingUpdateDeal: false,\n      modalDeal: {\n        isOpen: false,\n        isLoading: false,\n      },\n      infoError: {\n        icon: 'mdi-account-search-outline',\n        title: '',\n        message: 'No se encontraron tratos',\n      },\n      filters: {\n        search: '',\n        orderBy: 'desc',\n        skip: 0,\n        take: 0,\n        sortBy: [],\n        sortDesc: [],\n        isDelete: false,\n      },\n      listDeals: [],\n      informationBarDeals: {},\n      resultSearchDeals: [],\n      totalDeals: 0,\n      searchDeal: '',\n      searchFilters: {\n        search: '',\n        take: 5,\n      },\n      dealsSelected: [],\n    };\n  },\n  watch: {\n    searchDeal(value) {\n      if (value) {\n        if (Object.keys(value).length >= 2) {\n          this.searchFilters.search = value;\n          this.searchFilters.take = 5;\n          this.getSearchDeals();\n        }\n        if (Object.keys(value).length === 0) {\n          // console.log('longitud de busqueda cero');\n          this.searchFilters.search = '';\n          this.searchFilters.take = 0;\n          this.getSearchDeals();\n        }\n      }\n    },\n    isLoadingDeals(value) {\n      this.$emit('isLoadingDeals', value);\n    },\n  },\n  computed: {\n    menuProps() {\n      return !this.searchDeal ? { value: false } : {};\n    },\n  },\n  methods: {\n    modalHandlerDeal({ isOpen, isLoading }) {\n      this.modalDeal = { isOpen, isLoading };\n    },\n    createDeal({\n      title,\n      contact,\n      company,\n      value,\n      tags,\n      customForms,\n      expectedCloseDate,\n      pipeline: { pipelineId, stageId },\n      owner,\n    }) {\n      this.modalHandlerDeal({\n        isOpen: true,\n        isLoading: true,\n      });\n      this.$apollo\n        .mutate({\n          mutation: CREATE_DEAL,\n          variables: {\n            input: {\n              title,\n              tags,\n              customForms,\n              expectedCloseDate,\n              contact: contact?.id ? { id: contact.id } : contact,\n              company: company?.id ? { id: company.id } : company,\n              value,\n              pipelineId,\n              stageId,\n              ownerId: owner.id,\n            },\n          },\n        })\n        .then(({ data: { createDeal } }) => {\n          this.updateData = true;\n          this.modalHandlerDeal({\n            isOpen: false,\n            isLoading: false,\n          });\n          if (this.$route.name === 'pipeline-id') {\n            this.updateViewPipeline(this.$route.params.id);\n          }\n          this.updateData = true;\n\n          setTimeout(() => {\n            this.updateData = false;\n          }, 10);\n\n          this.$emit('updateHistory');\n\n          if (this.typeItem === 'CONTACT' || this.typeItem === 'COMPANY') {\n            this.updateHistory();\n            this.addDeal(createDeal);\n          }\n        })\n        .catch(() => {\n          const error =\n            'No se pudo crear el trato intente de nuevo o contacte al soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    updateDeal({\n      id,\n      value,\n      expectedCloseDate,\n      company,\n      contact,\n      tags,\n      status,\n      comments,\n      lostReason,\n      owner,\n      title,\n      customForm,\n    }) {\n      this.isLoadingUpdateDeal = true;\n      const input = {};\n      input.id = id;\n      if (value || value === 0) {\n        input.value = value;\n      }\n      if (expectedCloseDate || expectedCloseDate !== undefined) {\n        input.expectedCloseDate = expectedCloseDate;\n      }\n      if (company) {\n        input.company = company;\n      }\n      if (contact) {\n        input.contact = contact;\n      }\n      if (tags) {\n        input.tags = tags;\n      }\n      if (owner) {\n        input.ownerId = owner.id;\n      }\n      if (title) {\n        input.title = title;\n      }\n      if (customForm) {\n        input.customForm = customForm;\n      }\n      if (status) {\n        input.status = status;\n        if (status === 'LOST') {\n          input.comments = comments;\n          input.lostReason = lostReason;\n        }\n      }\n\n      this.$apollo\n        .mutate({\n          // Query\n          mutation: UPDATE_DEAL,\n          // Parameters\n          variables: {\n            input,\n          },\n        })\n        .then(({ data: { updateDeal } }) => {\n          if (input.status === 'LOST') {\n            this.modalHandlerLostDeal({ isOpen: false, isLoading: false });\n          }\n          this.$emit('updateItem', updateDeal);\n          this.$emit('updateHistory');\n          // Close edit field\n          this.isLoadingUpdateDeal = false;\n\n          if (this.typeItem === 'CONTACT' || this.typeItem === 'COMPANY') {\n            this.updateHistory();\n            this.addDeal(updateDeal);\n          }\n        })\n        .catch(() => {\n          this.isLoadingUpdateDeal = false;\n          // Error\n          const error =\n            'No se pudo actualizar el trato, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    getSearchDeals() {\n      this.loadingSearch = true;\n      this.$apollo\n        .query({\n          query: GET_SEARCH_DEALS,\n          fetchPolicy: 'no-cache',\n          variables: {\n            filters: this.searchFilters,\n          },\n        })\n        .then(({ data: { deals } }) => {\n          this.resultSearchDeals = deals.list;\n          this.loadingSearch = false;\n        })\n        .catch(() => {\n          this.loadingSearch = false;\n        });\n    },\n    getDeals() {\n      this.isLoadingDeals = true;\n      this.$apollo\n        .query({\n          query: GET_DEALS,\n          fetchPolicy: 'no-cache',\n          variables: {\n            filters: this.filters,\n            importId: this.$route.query.filterId,\n          },\n        })\n        .then(({ data: { deals } }) => {\n          this.isLoadingDeals = false;\n          this.$emit('deals', deals.list);\n          this.$emit('informationBar', deals.informationBar);\n          this.listDeals = deals.list.map((deal) => {\n            if (deal.customForms) {\n              deal.customForms.forEach(({ id, value }) => {\n                // eslint-disable-next-line\n                deal[id] = value;\n              });\n            }\n            return deal;\n          });\n          this.totalDeals = deals.count;\n\n          this.isErrorDeals = false;\n          this.$emit('endUpdateData');\n        })\n        .catch(() => {\n          this.isErrorDeals = true;\n          this.isLoadingDeals = false;\n          this.listDeals = [];\n          this.totalDeals = 0;\n          this.$emit('endUpdateData');\n          this.infoError = {\n            icon: 'mdi-alert-outline',\n            title: 'Error',\n            message:\n              'No se ha podido cargar ningún trato, intente de nuevo o contacte a soporte',\n          };\n        });\n    },\n    restoreDealsConfirmation() {\n      this.modalHandlerRestore({\n        isOpen: true,\n        isLoading: false,\n        message: {\n          title: '¿Seguro que deseas restaurar?',\n          nameItem: 'Los tratos seleccionados',\n          text: 'serán restaurados',\n        },\n        infoRestore: {},\n      });\n    },\n    restoreDeals({ isOpen, isLoading, message, infoRestore }) {\n      this.modalHandlerRestore({\n        isOpen,\n        isLoading,\n        message,\n        infoRestore,\n      });\n      this.$apollo\n        .mutate({\n          mutation: RESTORE_DEALS,\n          variables: {\n            input: this.dealsSelected,\n          },\n          update: () => {\n            // indicamos que se deve de actualizar la vista de contactos\n            this.updateData = true;\n            this.snackbarHandler({\n              isOpen: true,\n              color: 'success',\n              text: 'Los tratos fueron restaurados correctamente',\n            });\n          },\n        })\n        .finally(() => {\n          this.modalHandlerRestore({\n            isOpen: false,\n            isLoading,\n            message,\n            infoRestore,\n          });\n          this.updateData = false;\n        })\n        .catch(() => {\n          const error =\n            'No se pudo restaurar el trato intente de nuevo o contacte al soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    deleteDealConfirmation(type, deals) {\n      this.modalHandlerDelete({\n        isOpen: true,\n        isLoading: false,\n        message: {\n          title: '¿Seguro que deseas mover a la papelera?',\n          nameItem: 'Los tratos seleccionados',\n          text: 'serán movidos a la papelera',\n        },\n        infoDelete: {\n          type,\n          deals,\n        },\n      });\n    },\n    deleteDeal({ isOpen, isLoading, message, infoDelete }) {\n      this.modalHandlerDelete({ isOpen, isLoading, message, infoDelete });\n      this.$apollo\n        .mutate({\n          mutation: DELETE_DEAL,\n          variables: {\n            input: infoDelete.deals,\n          },\n          update: () => {\n            // indicamos que se deve de actualizar la vista de contactos\n            this.updateData = true;\n            this.snackbarHandler({\n              isOpen: true,\n              color: 'success',\n              text: 'Los tratos fueron eliminados correctamente',\n            });\n          },\n        })\n        .finally(() => {\n          this.updateData = false;\n          this.modalHandlerDelete({\n            isOpen: false,\n            isLoading,\n            message,\n            infoDelete,\n          });\n        })\n        .catch(() => {\n          const error =\n            'No se pudo eliminar el trato intente de nuevo o contacte al soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    trashDealsConfirmation(type, deals) {\n      this.modalHandlerDelete({\n        isOpen: true,\n        isLoading: false,\n        message: {\n          nameItem: 'Los tratos seleccionados',\n          text: 'serán eliminados permanentemente',\n        },\n        infoDelete: {\n          type,\n          deals,\n        },\n      });\n    },\n    trashDeals({ isOpen, isLoading, message, infoDelete }) {\n      this.modalHandlerDelete({ isOpen, isLoading, message, infoDelete });\n      this.$apollo\n        .mutate({\n          mutation: TRASH_DEALS,\n          variables: {\n            input: infoDelete.deals,\n          },\n          update: () => {\n            // indicamos que se deve de actualizar la vista de contactos\n            this.updateData = true;\n            this.snackbarHandler({\n              isOpen: true,\n              color: 'success',\n              text: 'Los tratos fueron eliminados correctamente',\n            });\n          },\n        })\n        .finally(() => {\n          this.updateData = false;\n          this.modalHandlerDelete({\n            isOpen: false,\n            isLoading,\n            message,\n            infoDelete,\n          });\n        })\n        .catch(() => {\n          const error =\n            'No se pudo eliminar el trato intente de nuevo o contacte al soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    goToProfile(id) {\n      this.$router.push(`/deal/${id}`);\n    },\n  },\n};\n","// `SameValue` abstract operation\n// https://tc39.es/ecma262/#sec-samevalue\n// eslint-disable-next-line es/no-object-is -- safe\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","import gql from 'graphql-tag';\n\nexport const CREATE_CONTACT = gql`\n  mutation CreateContact($input: contactCreateInput!) {\n    createContact(contactInput: $input) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n      }\n      isClient\n    }\n  }\n`;\n\nexport const UPDATE_CONTACT = gql`\n  mutation updateContact($contactInput: contactUpdateInput) {\n    updateContact(contactInput: $contactInput) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      customForms\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      enterprise {\n        id\n        name\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      deals {\n        id\n        title\n        value\n        status\n        contact {\n          id\n          name\n        }\n        company {\n          id\n          name\n        }\n        stage {\n          id\n        }\n        pipeline {\n          id\n          stages {\n            id\n          }\n        }\n        owner {\n          id\n        }\n      }\n      createdAt\n    }\n  }\n`;\n\nexport const DELETE_CONTACTS = gql`\n  mutation deletedContacts($input: [DeleteContactInput!]!) {\n    deletedContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n`;\n\nexport const TRASH_CONTACTS = gql`\n  mutation trashContacts($input: [DeleteContactInput!]!) {\n    trashContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n`;\n\nexport const RESTORE_CONTACTS = gql`\n  mutation restoreContacts($input: [DeleteContactInput!]!) {\n    restoreContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n`;\n\nexport const FUSE_CONTACTS = gql`\n  mutation FuseContacts($input: ContactsToFuse!) {\n    fuseContacts(fuse: $input) {\n      id\n      name\n    }\n  }\n`;\n\nexport const UPDATE_OWNER_CONTACTS = gql`\n  mutation assignContacts($contactListAssign: ContactListAssign!) {\n    assignContacts(contactListAssign: $contactListAssign)\n  }\n`;\n","export * from \"-!../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./DealContact.vue?vue&type=style&index=0&id=5fc6e35c&lang=scss&scoped=true&\"","import { UPDATE_CONTACT } from '@/graphql/mutations/contactsMutations';\n// import { GET_CONTACT } from '@/graphql/querys/contactsQuery';\n\nexport const contactsMixin = {\n  data() {\n    return {\n      isLoadingUpdateContact: false,\n    };\n  },\n  methods: {\n    updateContact({\n      id,\n      name,\n      email,\n      birthday,\n      phones,\n      isClient,\n      socialMedias,\n      customForm,\n      company,\n      owner,\n      tags,\n      deal,\n    }) {\n      this.isLoadingUpdateContact = true;\n      const contactInput = {};\n      contactInput.id = id;\n      if (name) {\n        contactInput.name = name;\n      }\n      if (email) {\n        contactInput.email = email;\n      }\n      if (birthday) {\n        contactInput.birthday = birthday;\n      }\n      if (phones) {\n        contactInput.phones = phones;\n      }\n      if (isClient === true || isClient === false) {\n        contactInput.isClient = isClient;\n      }\n      if (socialMedias) {\n        contactInput.socialMedias = socialMedias;\n      }\n      if (customForm) {\n        contactInput.customForm = customForm;\n      }\n      if (company) {\n        contactInput.company = company;\n      }\n      if (owner) {\n        contactInput.owner = owner;\n      }\n      if (tags) {\n        contactInput.tags = tags;\n      }\n      if (deal) {\n        contactInput.deal = deal;\n      }\n      this.$apollo\n        .mutate({\n          // Query\n          mutation: UPDATE_CONTACT,\n          // Parameters\n          variables: {\n            contactInput,\n          },\n        })\n        .then(({ data: { updateContact } }) => {\n          this.$emit('updateItem', updateContact);\n          this.$emit('updateHistory');\n          // Close edit field\n          this.isLoadingUpdateContact = false;\n        })\n        .catch(() => {\n          this.isLoadingUpdateContact = false;\n          // this.isLoading = false;\n          // Error\n          const error =\n            'No se pudo actualizar el contacto, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n  },\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-card',{attrs:{\"flat\":\"\"}},[_c('v-divider'),_c('v-card-title',{staticClass:\"contact-name py-1\"},[_c('v-icon',{staticClass:\"mr-4\",attrs:{\"color\":\"primary\"}},[_vm._v(\"mdi-account\")]),_vm._v(\" Contacto \"),_c('v-spacer'),((_vm.canEditDeal || _vm.canEditDealOthers) && !_vm.item.isDelete)?_c('v-menu',{attrs:{\"close-on-content-click\":false,\"left\":\"\",\"nudge-right\":\"30\",\"nudge-bottom\":\"-20\",\"absolute\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar onMenu = ref.on;\nreturn [_c('v-tooltip',{directives:[{name:\"show\",rawName:\"v-show\",value:((_vm.canEditDeal || _vm.canEditDealOthers) && !_vm.item.isDelete),expression:\"(canEditDeal || canEditDealOthers) && !item.isDelete\"}],attrs:{\"top\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar onTooltip = ref.on;\nreturn [_c('v-btn',_vm._g({attrs:{\"icon\":\"\",\"loading\":_vm.isLoading},on:{\"click\":function($event){_vm.isShowAddContact = !_vm.isShowAddContact}}},Object.assign({}, onMenu, onTooltip)),[_c('v-icon',{attrs:{\"color\":\"secondary\"}},[_vm._v(\" \"+_vm._s(_vm.contactSelected ? 'mdi-compare-horizontal' : 'mdi-plus')+\" \")])],1)]}}],null,true)},[_c('span',[_vm._v(_vm._s(_vm.contactSelected ? 'Reemplazar' : 'Agregar'))])])]}}],null,false,1544964627),model:{value:(_vm.isShowAddContact),callback:function ($$v) {_vm.isShowAddContact=$$v},expression:\"isShowAddContact\"}},[_c('v-card',{staticClass:\"pa-4\",attrs:{\"width\":\"18em\"}},[_c('v-form',{ref:\"formContact\"},[_c('FieldSelectContactSimple',{attrs:{\"inputProps\":{ class: 'no-icon full-width', isDense: true },\"resetHandler\":_vm.isShowAddContact},on:{\"outData\":_vm.updateContact,\"deleteData\":_vm.deleteContact}})],1),_c('div',{staticClass:\"d-flex justify-center pt-2 ml-2\"},[_c('v-btn',{staticClass:\"mr-2\",staticStyle:{\"width\":\"45%\"},attrs:{\"color\":\"primary\",\"outlined\":\"\",\"small\":\"\",\"disabled\":_vm.isLoading},on:{\"click\":_vm.cancel}},[_vm._v(\" Cancelar \")]),((_vm.canEditDeal || _vm.canEditDealOthers) && !_vm.item.isDelete)?_c('v-btn',{staticStyle:{\"width\":\"45%\"},attrs:{\"color\":\"secondary\",\"small\":\"\",\"disabled\":_vm.disabledAddButton,\"loading\":_vm.isLoading},on:{\"click\":_vm.addContact}},[_vm._v(\" Guardar \")]):_vm._e()],1)],1)],1):_vm._e()],1),_c('v-divider'),_c('v-card-text',{staticClass:\"pa-0\"},[(\n          !_vm.contactSelected ||\n            _vm.contactSelected === null ||\n            _vm.contactSelected === undefined\n        )?_c('div',{staticClass:\"pa-2 text-center\"},[_c('span',[_vm._v(\" No tiene contacto \")])]):_c('v-list-item',{staticClass:\"Contact\",attrs:{\"outlined\":\"\"}},[_c('v-list-item-content',[_c('v-list-item-title',{staticClass:\"Contact__title\"},[[_c('div',{staticClass:\"Contact__box\",on:{\"click\":function($event){return _vm.goContact(_vm.contactSelected.id)}}},[_c('v-icon',[_vm._v(\"mdi-account\")]),_c('span',{staticClass:\"Contact__box_name\"},[_vm._v(\" \"+_vm._s(_vm.contactSelected.name)+\" \"),(_vm.contactSelected.isDelete)?_c('b',{staticClass:\"font-weight-bold\",staticStyle:{\"color\":\"red\"}},[_vm._v(\" (Eliminado) \")]):_vm._e()])],1)]],2)],1),(_vm.isLoadingRemove)?_c('v-list-item-action',[_c('v-progress-circular',{attrs:{\"size\":20,\"color\":\"secondary\",\"indeterminate\":\"\"}})],1):_vm._e(),(\n            !_vm.isLoadingRemove &&\n              (_vm.canEditDeal || _vm.canEditDealOthers) &&\n              !_vm.item.isDelete\n          )?_c('v-list-item-action',{staticClass:\"Contact__edit\"},[_c('v-tooltip',{attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n          var on = ref.on;\n          var attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({staticClass:\"mr-1 mt-2\",attrs:{\"x-small\":\"\",\"outlined\":\"\",\"color\":\"grey\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.disconnectContact()}}},'v-btn',attrs,false),on),[_c('v-icon',{attrs:{\"small\":\"\",\"color\":\"grey\"}},[_vm._v(\"mdi-connection\")])],1)]}}],null,false,1818901335)},[_c('span',[_vm._v(\"Desvincular\")])]),((_vm.canEditContact || _vm.canEditContactOthers) && !_vm.item.isDelete)?_c('v-menu',{attrs:{\"close-on-content-click\":false,\"left\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n          var onMenu = ref.on;\nreturn [_c('v-tooltip',{directives:[{name:\"show\",rawName:\"v-show\",value:(\n                  (_vm.canEditContact || _vm.canEditContactOthers) && !_vm.item.isDelete\n                ),expression:\"\\n                  (canEditContact || canEditContactOthers) && !item.isDelete\\n                \"}],attrs:{\"bottom\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\n                var onTooltip = ref.on;\nreturn [_c('v-btn',_vm._g({staticClass:\"mt-2\",attrs:{\"x-small\":\"\",\"color\":\"secondary\"},on:{\"click\":function($event){_vm.isEdit = true}}},Object.assign({}, onMenu, onTooltip)),[_c('v-icon',{attrs:{\"small\":\"\",\"color\":\"white\"}},[_vm._v(\"mdi-pencil\")])],1)]}}],null,true)},[_c('span',[_vm._v(\"Cambiar nombre\")])])]}}],null,false,1065617238),model:{value:(_vm.isEdit),callback:function ($$v) {_vm.isEdit=$$v},expression:\"isEdit\"}},[_c('v-card',{staticClass:\"pa-4\",attrs:{\"width\":\"18em\"}},[_c('v-form',{ref:\"formContact\",attrs:{\"lazy-validation\":\"\"},model:{value:(_vm.isValidateFormName),callback:function ($$v) {_vm.isValidateFormName=$$v},expression:\"isValidateFormName\"}},[_c('v-text-field',{attrs:{\"label\":\"Nombre\",\"dense\":\"\",\"outlined\":\"\",\"hide-details\":\"auto\",\"maxlength\":\"50\",\"rules\":_vm.rules.general},model:{value:(_vm.contactName),callback:function ($$v) {_vm.contactName=$$v},expression:\"contactName\"}}),_c('div',{staticClass:\"d-flex justify-center mt-1\"},[_c('v-btn',{staticClass:\"mr-2\",staticStyle:{\"width\":\"48%\"},attrs:{\"x-small\":\"\",\"color\":\"primary\",\"outlined\":\"\",\"disabled\":_vm.isLoadingChangeName},on:{\"click\":function($event){return _vm.cancelEdit(_vm.contact.id)}}},[_vm._v(\" Cancelar \")]),(\n                      (_vm.canEditDeal || _vm.canEditDealOthers) && !_vm.item.isDelete\n                    )?_c('v-btn',{staticStyle:{\"width\":\"48%\"},attrs:{\"x-small\":\"\",\"color\":\"secondary\",\"loading\":_vm.isLoadingChangeName},on:{\"click\":function($event){return _vm.updateName({\n                        id: _vm.contactSelected.id,\n                        name: _vm.contactName,\n                      })}}},[_vm._v(\" Guardar \")]):_vm._e()],1)],1)],1)],1):_vm._e()],1):_vm._e()],1)],1)],1),_c('BaseModalError',{attrs:{\"modalHandler\":_vm.modalError},on:{\"close\":_vm.modalHandlerError}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <v-card flat>\n      <v-divider />\n      <v-card-title class=\"contact-name py-1\">\n        <v-icon color=\"primary\" class=\"mr-4\">mdi-account</v-icon>\n        Contacto\n        <v-spacer></v-spacer>\n        <v-menu\n          v-model=\"isShowAddContact\"\n          :close-on-content-click=\"false\"\n          left\n          nudge-right=\"30\"\n          nudge-bottom=\"-20\"\n          absolute\n          v-if=\"(canEditDeal || canEditDealOthers) && !item.isDelete\"\n        >\n          <template v-slot:activator=\"{ on: onMenu }\">\n            <v-tooltip\n              top\n              v-show=\"(canEditDeal || canEditDealOthers) && !item.isDelete\"\n            >\n              <template v-slot:activator=\"{ on: onTooltip }\">\n                <v-btn\n                  v-on=\"{ ...onMenu, ...onTooltip }\"\n                  icon\n                  @click=\"isShowAddContact = !isShowAddContact\"\n                  :loading=\"isLoading\"\n                >\n                  <v-icon color=\"secondary\">\n                    {{\n                      contactSelected ? 'mdi-compare-horizontal' : 'mdi-plus'\n                    }}\n                  </v-icon>\n                </v-btn>\n              </template>\n              <span>{{ contactSelected ? 'Reemplazar' : 'Agregar' }}</span>\n            </v-tooltip>\n          </template>\n          <v-card class=\"pa-4\" width=\"18em\">\n            <v-form ref=\"formContact\">\n              <FieldSelectContactSimple\n                :inputProps=\"{ class: 'no-icon full-width', isDense: true }\"\n                :resetHandler=\"isShowAddContact\"\n                @outData=\"updateContact\"\n                @deleteData=\"deleteContact\"\n              />\n            </v-form>\n            <div class=\"d-flex justify-center pt-2 ml-2\">\n              <v-btn\n                style=\"width:45%\"\n                color=\"primary\"\n                outlined\n                small\n                class=\"mr-2\"\n                :disabled=\"isLoading\"\n                @click=\"cancel\"\n              >\n                Cancelar\n              </v-btn>\n              <v-btn\n                v-if=\"(canEditDeal || canEditDealOthers) && !item.isDelete\"\n                color=\"secondary\"\n                style=\"width:45%\"\n                small\n                :disabled=\"disabledAddButton\"\n                @click=\"addContact\"\n                :loading=\"isLoading\"\n              >\n                Guardar\n              </v-btn>\n            </div>\n          </v-card>\n        </v-menu>\n      </v-card-title>\n      <v-divider></v-divider>\n      <v-card-text class=\"pa-0\">\n        <div\n          v-if=\"\n            !contactSelected ||\n              contactSelected === null ||\n              contactSelected === undefined\n          \"\n          class=\"pa-2 text-center\"\n        >\n          <span>\n            No tiene contacto\n          </span>\n        </div>\n        <v-list-item v-else class=\"Contact\" outlined>\n          <v-list-item-content>\n            <v-list-item-title class=\"Contact__title\">\n              <template>\n                <div\n                  class=\"Contact__box\"\n                  @click=\"goContact(contactSelected.id)\"\n                >\n                  <v-icon>mdi-account</v-icon>\n                  <span class=\"Contact__box_name\">\n                    {{ contactSelected.name }}\n                    <b\n                      class=\"font-weight-bold\"\n                      style=\"color: red;\"\n                      v-if=\"contactSelected.isDelete\"\n                    >\n                      (Eliminado)\n                    </b>\n                  </span>\n                </div>\n              </template>\n            </v-list-item-title>\n          </v-list-item-content>\n          <v-list-item-action v-if=\"isLoadingRemove\">\n            <v-progress-circular\n              :size=\"20\"\n              color=\"secondary\"\n              indeterminate\n            ></v-progress-circular>\n          </v-list-item-action>\n          <v-list-item-action\n            v-if=\"\n              !isLoadingRemove &&\n                (canEditDeal || canEditDealOthers) &&\n                !item.isDelete\n            \"\n            class=\"Contact__edit\"\n          >\n            <v-tooltip bottom>\n              <template v-slot:activator=\"{ on, attrs }\">\n                <v-btn\n                  x-small\n                  outlined\n                  @click.stop=\"disconnectContact()\"\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                  class=\"mr-1 mt-2\"\n                  color=\"grey\"\n                >\n                  <v-icon small color=\"grey\">mdi-connection</v-icon>\n                </v-btn>\n              </template>\n              <span>Desvincular</span>\n            </v-tooltip>\n            <v-menu\n              v-model=\"isEdit\"\n              :close-on-content-click=\"false\"\n              left\n              v-if=\"(canEditContact || canEditContactOthers) && !item.isDelete\"\n            >\n              <template v-slot:activator=\"{ on: onMenu }\">\n                <v-tooltip\n                  bottom\n                  v-show=\"\n                    (canEditContact || canEditContactOthers) && !item.isDelete\n                  \"\n                >\n                  <template v-slot:activator=\"{ on: onTooltip }\">\n                    <v-btn\n                      x-small\n                      color=\"secondary\"\n                      @click=\"isEdit = true\"\n                      v-on=\"{ ...onMenu, ...onTooltip }\"\n                      class=\"mt-2\"\n                    >\n                      <v-icon small color=\"white\">mdi-pencil</v-icon>\n                    </v-btn>\n                  </template>\n                  <span>Cambiar nombre</span>\n                </v-tooltip>\n              </template>\n              <v-card class=\"pa-4\" width=\"18em\">\n                <v-form\n                  ref=\"formContact\"\n                  v-model=\"isValidateFormName\"\n                  lazy-validation\n                >\n                  <v-text-field\n                    v-model=\"contactName\"\n                    label=\"Nombre\"\n                    dense\n                    outlined\n                    hide-details=\"auto\"\n                    maxlength=\"50\"\n                    :rules=\"rules.general\"\n                  ></v-text-field>\n\n                  <div class=\"d-flex justify-center mt-1\">\n                    <v-btn\n                      style=\"width:48%\"\n                      x-small\n                      color=\"primary\"\n                      outlined\n                      class=\"mr-2\"\n                      @click=\"cancelEdit(contact.id)\"\n                      :disabled=\"isLoadingChangeName\"\n                    >\n                      Cancelar\n                    </v-btn>\n                    <v-btn\n                      style=\"width:48%\"\n                      v-if=\"\n                        (canEditDeal || canEditDealOthers) && !item.isDelete\n                      \"\n                      x-small\n                      color=\"secondary\"\n                      :loading=\"isLoadingChangeName\"\n                      @click=\"\n                        updateName({\n                          id: contactSelected.id,\n                          name: contactName,\n                        })\n                      \"\n                    >\n                      Guardar\n                    </v-btn>\n                  </div>\n                </v-form>\n              </v-card>\n            </v-menu>\n          </v-list-item-action>\n        </v-list-item>\n      </v-card-text>\n    </v-card>\n    <BaseModalError :modalHandler=\"modalError\" @close=\"modalHandlerError\" />\n  </div>\n</template>\n\n<script>\nimport { subject } from '@casl/ability';\nimport ability from '@/services/ability';\nimport { UPDATE, UPDATE_OTHERS } from '@/constants/methods';\nimport {\n  PERMISSIONS_DEALS,\n  PERMISSIONS_CONTACTS,\n  PERMISSIONS_GROUP_DEAL,\n  PERMISSIONS_GROUP_CONTACT,\n} from '@/constants/permissions';\n// Mutations\nimport { UPDATE_CONTACT } from '@/graphql/mutations/contactsMutations';\n// Mixins\nimport { rulesMixin } from '@/mixins/rulesMixin';\n// Constants\nimport { GET_USER_LOGGED } from '@/graphql/local-state/queries';\nimport { modalsAlertsMixin } from '@/mixins/alerts/modalsAlertsMixin';\nimport { dealsMixin } from '@/mixins/dealsMixin';\nimport { contactsMixin } from '@/mixins/contactsMixin';\n\nexport default {\n  name: 'DealContact',\n  components: {\n    FieldSelectContactSimple: () =>\n      import('@/components/fields/FieldSelectContactSimple.vue'),\n  },\n  mixins: [rulesMixin, modalsAlertsMixin, dealsMixin, contactsMixin],\n  props: {\n    item: {\n      type: Object,\n      required: true,\n    },\n    itemId: {\n      type: String,\n      default: '',\n      required: true,\n    },\n    typeItem: {\n      type: String,\n      required: true,\n      default: 'CONTACT',\n    },\n    ownerId: {\n      type: String,\n      default: '',\n    },\n    contactSelected: {\n      type: Object,\n      default: () => {\n        return {};\n      },\n    },\n  },\n  data() {\n    return {\n      UPDATE,\n      UPDATE_OTHERS,\n      PERMISSIONS_DEALS,\n      PERMISSIONS_CONTACTS,\n      PERMISSIONS_GROUP_DEAL,\n      PERMISSIONS_GROUP_CONTACT,\n      search: '',\n      contact: '',\n      searchContacts: {},\n      isEdit: false,\n      contactName: '',\n      isLoading: false,\n      isNewContact: false,\n      isLoadingRemove: false,\n      isShowAddContact: false,\n      isValidateFormName: true,\n      isLoadingChangeName: false,\n      contactNew: {\n        id: '',\n        name: '',\n      },\n      contactRules: [(v) => !!v || 'Debes seleccionar o crear un contacto'],\n      isValidate: true,\n      userCurrent: {},\n    };\n  },\n  // Reassign contact name to other variable to show\n  created() {\n    this.contactName = this.contactSelected?.name || '';\n  },\n  watch: {\n    // Reassign contact name to other variable to show and update\n    contactSelected() {\n      this.contactName = this.contactSelected?.name || '';\n    },\n    // Control new contact and assign value\n    contact(value) {\n      if (value && value.id) {\n        this.isNewContact = false;\n        this.contactNew = { id: value.id, name: '' };\n      } else if (value) {\n        this.isNewContact = true;\n        this.contactNew = { id: '', name: value };\n      } else {\n        this.contactNew = { id: '', name: '' };\n      }\n    },\n    isLoadingUpdateDeal(value) {\n      if (!value) {\n        this.isLoading = false;\n        // Reset variables\n        this.contact = '';\n        if (this.isShowAddContact) {\n          this.$refs.formContact.reset();\n        }\n        this.isShowAddContact = false;\n        this.isLoadingRemove = false;\n        this.contactNew = {\n          id: '',\n          name: '',\n        };\n      }\n    },\n  },\n  computed: {\n    canEditDeal() {\n      if (this.typeItem === 'DEAL') {\n        return ability.can(\n          UPDATE,\n          subject(PERMISSIONS_DEALS, { authorId: this.ownerId || '' }),\n        );\n      }\n      return false;\n    },\n    canEditDealOthers() {\n      if (!this.canEditDeal) {\n        return (\n          ability.can(UPDATE_OTHERS, PERMISSIONS_DEALS) &&\n          !ability.can(\n            UPDATE_OTHERS,\n            subject(PERMISSIONS_DEALS, {\n              authorId: this.ownerId || '',\n            }),\n          )\n        );\n      }\n      return ability.can(UPDATE_OTHERS, PERMISSIONS_DEALS);\n    },\n    canEditContact() {\n      return ability.can(\n        UPDATE,\n        subject(PERMISSIONS_CONTACTS, {\n          authorId: this.contactSelected?.owner?.id || '',\n        }),\n      );\n    },\n    canEditContactOthers() {\n      if (!this.canEditContact) {\n        return (\n          ability.can(UPDATE_OTHERS, PERMISSIONS_CONTACTS) &&\n          !ability.can(\n            UPDATE_OTHERS,\n            subject(PERMISSIONS_CONTACTS, {\n              authorId: this.contactSelected?.owner?.id || '',\n            }),\n          )\n        );\n      }\n      return ability.can(UPDATE_OTHERS, PERMISSIONS_CONTACTS);\n    },\n    // Hide the submenu when search is empty\n    menuProps() {\n      return !this.search ? { value: false } : {};\n    },\n    hasSearch() {\n      if (\n        this.search !== null &&\n        this.search !== undefined &&\n        this.search !== ''\n      ) {\n        return this.search.length > 2;\n      }\n      return false;\n    },\n    readOnly() {\n      if (\n        this.contact === null ||\n        this.contact === undefined ||\n        this.contact === ''\n      ) {\n        return false;\n      }\n      return true;\n    },\n    disabledAddButton() {\n      if (this.contactNew.id || this.contactNew.name) return false;\n      return true;\n    },\n  },\n  methods: {\n    updateContact(index, value) {\n      this.contactNew = value;\n    },\n    deleteContact() {\n      this.contactNew = {\n        id: '',\n        name: '',\n      };\n    },\n    // Reedirect to contact profile by id\n    goContact(id) {\n      this.$router.push({ name: 'contact', params: { id } }, () => {});\n    },\n    // Cancel add contact and reset\n    cancel() {\n      // Reset contact new\n      this.contact = '';\n      this.contactNew = {\n        id: '',\n        name: '',\n      };\n      // Hide add contact\n      this.isShowAddContact = false;\n      // Reset validate\n      this.isValidate = false;\n    },\n    // Mutation to add contact\n    addContact() {\n      if (this.canEditDeal || this.canEditDealOthers) {\n        // Is empty?\n        if (Object.keys(this.contactNew).length !== 0) {\n          // Active loading\n          this.isLoading = true;\n          // Mutation to update contact's deal\n          this.updateDeal({ id: this.itemId, contact: this.contactNew });\n        }\n      }\n    },\n    // Remove relation contact of the contact by id\n    disconnectContact() {\n      if (this.canEditDeal || this.canEditDealOthers) {\n        this.isLoadingRemove = true;\n        this.updateDeal({ id: this.itemId, contact: { id: '' } });\n      }\n    },\n    // Update name's contact\n    updateName({ id, name }) {\n      if (this.canEditContact || this.canEditContactOthers) {\n        // Validate array of forms with input name\n        this.$refs.formContact.validate();\n        // Is valid?\n        if (this.isValidateFormName) {\n          // Active loading\n          this.isLoadingChangeName = true;\n          // Mutation to update name's contact\n          this.$apollo\n            .mutate({\n              // Query\n              mutation: UPDATE_CONTACT,\n              // Parameters\n              variables: {\n                contactInput: {\n                  id,\n                  name,\n                },\n              },\n            })\n            .then(({ data: { updateContact } }) => {\n              this.$emit('updateDealContact', updateContact);\n              // Desactive loading\n              this.isLoadingChangeName = false;\n              // Close specific field by id\n              this.isEdit = false;\n              // Reset validation\n              this.isValidateFormName = false;\n            })\n            .catch(() => {\n              // Desactive loading\n              this.isLoadingChangeName = false;\n              // Reset validation\n              this.isValidateFormName = false;\n              const error =\n                'No se pudo actualizar el nombre del contacto, intente de nuevo o contacte a soporte';\n              this.modalHandlerError({ isOpen: true, error });\n            });\n        }\n      }\n    },\n    // Name to search in combobox\n    text(value) {\n      return `${value.name}`;\n    },\n    // Cancel edit\n    cancelEdit() {\n      // Reset value to the before\n      this.contactName = this.contactSelected.name;\n      this.isEdit = false;\n    },\n  },\n  apollo: {\n    userCurrent: {\n      query: GET_USER_LOGGED,\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '{ .v-autocomplete  .Contact .contact-name} from ../../../../scss/components/deal.contact';\n</style>\n","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./DealContact.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./DealContact.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DealContact.vue?vue&type=template&id=5fc6e35c&scoped=true&\"\nimport script from \"./DealContact.vue?vue&type=script&lang=js&\"\nexport * from \"./DealContact.vue?vue&type=script&lang=js&\"\nimport style0 from \"./DealContact.vue?vue&type=style&index=0&id=5fc6e35c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5fc6e35c\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAction } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VMenu } from 'vuetify/lib/components/VMenu';\nimport { VProgressCircular } from 'vuetify/lib/components/VProgressCircular';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\nimport { VTooltip } from 'vuetify/lib/components/VTooltip';\ninstallComponents(component, {VBtn,VCard,VCardText,VCardTitle,VDivider,VForm,VIcon,VListItem,VListItemAction,VListItemContent,VListItemTitle,VMenu,VProgressCircular,VSpacer,VTextField,VTooltip})\n","import gql from 'graphql-tag';\n\nexport const CREATE_DEAL = gql`\n  mutation CreateDeal($input: CreateDeal!) {\n    createDeal(dealInput: $input) {\n      id\n      title\n      value\n      status\n      expectedCloseDate\n      dateStatus\n      activity\n      rottenTime\n      owner {\n        user {\n          id\n          name\n          lastName\n          config {\n            profileUrl\n          }\n        }\n      }\n      company {\n        id\n        name\n      }\n      contact {\n        id\n        name\n      }\n      stage {\n        id\n        name\n      }\n      pipeline {\n        id\n        name\n        stages {\n          id\n          name\n          order\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n    }\n  }\n`;\n\nexport const UPDATE_DEAL = gql`\n  mutation UpdateDeal($input: UpdateDeal!) {\n    updateDeal(dealInput: $input) {\n      id\n      title\n      value\n      status\n      expectedCloseDate\n      dateStatus\n      activity\n      files\n      customForms\n      rottenTime\n      lostDeal {\n        id\n        lostReason {\n          id\n          reason\n        }\n      }\n      exchangeCurrency {\n        id\n        name\n        code\n        icon\n      }\n      company {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      contact {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n          config {\n            profileUrl\n          }\n        }\n      }\n      stage {\n        id\n        name\n        order\n      }\n      pipeline {\n        id\n        name\n        stages {\n          id\n          name\n          order\n          daysInStage\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n    }\n  }\n`;\n\nexport const DELETE_DEAL = gql`\n  mutation deletedDeals($input: [DeleteDealInput!]!) {\n    deletedDeals(deals: $input) {\n      id\n    }\n  }\n`;\n\nexport const TRASH_DEALS = gql`\n  mutation trashDeals($input: [DeleteDealInput!]!) {\n    trashDeals(deals: $input) {\n      id\n    }\n  }\n`;\n\nexport const RESTORE_DEALS = gql`\n  mutation restoreDeals($input: [DeleteDealInput!]!) {\n    restoreDeals(deals: $input) {\n      id\n    }\n  }\n`;\n\n// se pide todo lo necesario para poder actualizar el deal entero y no se pierda ningun dato\nexport const CHANGE_DEAL_STAGE = gql`\n  mutation ChangeDealStage($input: ChangeStage!) {\n    changeDealStage(input: $input) {\n      id\n      title\n      value\n      status\n      expectedCloseDate\n      dateStatus\n      activity\n      files\n      customForms\n      rottenTime\n      dateEntryIntoStage\n      lostDeal {\n        id\n        lostReason {\n          id\n          reason\n        }\n      }\n      exchangeCurrency {\n        id\n        name\n        code\n        icon\n      }\n      company {\n        id\n        name\n        isDelete\n      }\n      contact {\n        id\n        name\n        isDelete\n      }\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n          config {\n            profileUrl\n          }\n        }\n      }\n      stage {\n        id\n        name\n        order\n        maxDays\n      }\n      pipeline {\n        id\n        name\n        stages {\n          id\n          name\n          order\n          daysInStage\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      isDelete\n    }\n  }\n`;\n\nexport const CHANGE_DEAL_PIPELINE = gql`\n  mutation changeDealPipeline($input: changePipelineInput!) {\n    changeDealPipeline(input: $input) {\n      id\n      title\n      value\n      status\n      expectedCloseDate\n      dateStatus\n      activity\n      files\n      customForms\n      rottenTime\n      lostDeal {\n        id\n        lostReason {\n          id\n          reason\n        }\n      }\n      exchangeCurrency {\n        id\n        name\n        code\n        icon\n      }\n      company {\n        id\n        name\n        isDelete\n      }\n      contact {\n        id\n        name\n        isDelete\n      }\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n          config {\n            profileUrl\n          }\n        }\n      }\n      stage {\n        id\n        name\n        order\n      }\n      pipeline {\n        id\n        name\n        stages {\n          id\n          name\n          order\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      isDelete\n    }\n  }\n`;\n\nexport const CREATE_LOST_REASON = gql`\n  mutation CreateLostReason($input: lostReasonCreateInput!) {\n    createLostReason(lostReasonInput: $input) {\n      id\n      reason\n    }\n  }\n`;\n\nexport const DELETE_LOST_REASON = gql`\n  mutation DeleteLostReason($lostReasonId: ID!) {\n    deleteLostReason(lostReasonId: $lostReasonId) {\n      id\n      reason\n    }\n  }\n`;\n\nexport const UPDATE_LOST_REASON = gql`\n  mutation UpdateLostReason($input: lostReasonUpdateInput!) {\n    updateLostReason(lostReasonInput: $input) {\n      id\n      reason\n    }\n  }\n`;\n\nexport const UPDATE_OWNER_DEALS = gql`\n  mutation assignDeals($dealListAssign: DealListAssign!) {\n    assignDeals(dealListAssign: $dealListAssign)\n  }\n`;\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.es/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : regexp[SEARCH];\n      return searcher !== undefined ? searcher.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@search\n    function (string) {\n      var res = maybeCallNative(nativeSearch, this, string);\n      if (res.done) return res.value;\n\n      var rx = anObject(this);\n      var S = String(string);\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n"],"sourceRoot":""}