{"version":3,"sources":["webpack:///./src/graphql/mutations/passwordMutations.js","webpack:///./src/views/RecoverPassword/ResetPassword.vue?19ef","webpack:///src/views/RecoverPassword/ResetPassword.vue","webpack:///./src/views/RecoverPassword/ResetPassword.vue?f79c","webpack:///./src/views/RecoverPassword/ResetPassword.vue"],"names":["RECOVER_PASSWORD","gql","CONFIRM_RECOVER_PASSWORD","SET_NEW_PASSWORD","render","_vm","this","_h","$createElement","_c","_self","dynamicComponent","tag","attrs","isLoadingUpdatePassword","error","isSamePassword","on","updatePassword","cleanError","staticRenderFns","name","components","SucessSetPassword","BaseError","BaseLoading","NewPasswordForm","data","isUpdatePassword","icon","tittle","message","type","userId","beforeMount","$route","query","id","$apollo","errorHandler","computed","methods","component"],"mappings":"0PAEaA,EAAmBC,eAAH,+JAQhBC,EAA2BD,eAAH,0KAQxBE,EAAmBF,eAAH,8K,yCClB7B,IAAIG,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAGJ,EAAIM,iBAAiB,CAACC,IAAI,YAAYC,MAAM,CAAC,wBAA0BR,EAAIS,wBAAwB,KAAOT,EAAIU,MAAM,eAAiBV,EAAIW,gBAAgBC,GAAG,CAAC,QAAUZ,EAAIa,eAAe,WAAab,EAAIc,eAC1SC,EAAkB,G,wDCgBtB,GACEC,KAAM,gBACNC,WAAY,CACVC,kBAAmB,WAAvB,OACA,iDACIC,UAAW,WAAf,yDACIC,YAAa,WAAjB,wDACIC,gBAAiB,WAArB,OACA,kDAEEC,KAVF,WAWI,MAAO,CACLC,kBAAkB,EAClBd,yBAAyB,EACzBE,eAAgB,GAEhBD,MAAO,CACLc,KAAM,GACNC,OAAQ,GACRC,QAAS,IAGXC,KAAM,GAENC,OAAQ,KAGZC,YA3BF,WA2BA,WACQ5B,KAAK6B,OAAOC,MAAMC,GACpB/B,KAAKgC,QACX,QACQ,SAAR,OACQ,UAAR,CACU,MAAV,CACY,MAAZ,uBAGQ,OAAR,cAAU,IAAV,oCACU,EAAV,YACU,EAAV,uBAGA,mBAAQ,IAAR,oBACQ,EAAR,eACQ,IAAR,kDACQ,EAAR,oBAGMhC,KAAK0B,KAAO,UACZ1B,KAAKiC,iBAGTC,SAAU,CACR7B,iBADJ,WAEM,OAAQL,KAAK0B,MAEX,IAAK,eACH,MAAO,kBACT,IAAK,UACH,MAAO,YACT,IAAK,mBACH,MAAO,oBAET,QACE,MAAO,iBAIfS,QAAS,CACPvB,eADJ,SACA,cACMZ,KAAKQ,yBAA0B,EAC/BR,KAAKgC,QACX,QACQ,SAAR,OACQ,UAAR,CACU,MAAV,CACY,GAAZ,YACY,SAAZ,MAIA,MACA,YAIQ,IAAR,IAHA,KACA,qBAEA,EAFA,SAEA,EAFA,QAGA,qBACA,iBACA,kDACA,mBACA,0BACA,kBACQ,EAAR,8BAGA,mBAAQ,IAAR,kBACA,wCACQ,EAAR,gBACQ,EAAR,+BAGIC,aAlCJ,SAkCA,GACM,OAAQP,GACN,KAAK,IACH1B,KAAKS,MAAQ,CACXc,KAAM,2BACNC,OAAQ,uCACRC,QAAS,sDAEX,MACF,KAAK,IACHzB,KAAKS,MAAQ,CACXc,KAAM,2BACNC,OAAQ,uCACRC,QAAS,sDAEX,MACF,KAAK,IACHzB,KAAKS,MAAQ,CACXc,KAAM,2BACNC,OAAQ,uBACRC,QACZ,wFAEU,MACF,KAAK,IACHzB,KAAKS,MAAQ,CACXc,KAAM,2BACNC,OAAQ,2CACRC,QACZ,oFAEU,MACF,QACEzB,KAAKS,MAAQ,CACXc,KAAM,2BACNC,OAAQ,kDACRC,QAAS,wBAEX,QAGNZ,WA3EJ,WA4EMb,KAAKU,eAAiB,MCjK+e,I,YCOvgB0B,EAAY,eACd,EACAtC,EACAgB,GACA,EACA,KACA,KACA,MAIa,aAAAsB,E","file":"js/chunk-2034cae4.de864da2.js","sourcesContent":["import gql from 'graphql-tag';\n\nexport const RECOVER_PASSWORD = gql`\n  mutation RecoverPassword($input: userEmailInput!) {\n    recoverPasswordUser(userInput: $input) {\n      success\n    }\n  }\n`;\n\nexport const CONFIRM_RECOVER_PASSWORD = gql`\n  mutation ConfirmRecoverPassword($input: userConfirmInput!) {\n    confirmRecoverPasswordUser(userInput: $input) {\n      id\n    }\n  }\n`;\n\nexport const SET_NEW_PASSWORD = gql`\n  mutation SetNewPassword($input: newPasswordInput!) {\n    setNewPasswordUser(userInput: $input) {\n      status\n      message\n    }\n  }\n`;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(_vm.dynamicComponent,{tag:\"component\",attrs:{\"isLoadingUpdatePassword\":_vm.isLoadingUpdatePassword,\"info\":_vm.error,\"isSamePassword\":_vm.isSamePassword},on:{\"outData\":_vm.updatePassword,\"cleanError\":_vm.cleanError}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <component\n    @outData=\"updatePassword\"\n    @cleanError=\"cleanError\"\n    :isLoadingUpdatePassword=\"isLoadingUpdatePassword\"\n    :info=\"error\"\n    :isSamePassword=\"isSamePassword\"\n    :is=\"dynamicComponent\"\n  ></component>\n</template>\n\n<script>\nimport {\n  CONFIRM_RECOVER_PASSWORD,\n  SET_NEW_PASSWORD,\n} from '@/graphql/mutations/passwordMutations';\n\nexport default {\n  name: 'ResetPassword',\n  components: {\n    SucessSetPassword: () =>\n      import('@/components/recoverPassword/SucessSetPassword.vue'),\n    BaseError: () => import('@/components/ui/BaseError.vue'),\n    BaseLoading: () => import('@/components/ui/BaseLoading.vue'),\n    NewPasswordForm: () =>\n      import('@/components/recoverPassword/NewPasswordForm.vue'),\n  },\n  data() {\n    return {\n      isUpdatePassword: false,\n      isLoadingUpdatePassword: false,\n      isSamePassword: '',\n      // informacion del error que se mostrara\n      error: {\n        icon: '',\n        tittle: '',\n        message: '',\n      },\n      // guarda el comonenete que se mostrara\n      type: '',\n      // guarda el objeto que responde el servidor\n      userId: '',\n    };\n  },\n  beforeMount() {\n    if (this.$route.query.id) {\n      this.$apollo\n        .mutate({\n          mutation: CONFIRM_RECOVER_PASSWORD,\n          variables: {\n            input: {\n              token: this.$route.query.id,\n            },\n          },\n          update: (store, { data: { confirmRecoverPasswordUser } }) => {\n            this.userId = confirmRecoverPasswordUser.id;\n            this.type = 'isValidToken';\n          },\n        })\n        .catch(({ graphQLErrors }) => {\n          this.type = 'isError';\n          const status = graphQLErrors[0]?.statusCode;\n          this.errorHandler(status);\n        });\n    } else {\n      this.type = 'isError';\n      this.errorHandler();\n    }\n  },\n  computed: {\n    dynamicComponent() {\n      switch (this.type) {\n        // vista nuevo usuario\n        case 'isValidToken':\n          return 'NewPasswordForm';\n        case 'isError':\n          return 'BaseError';\n        case 'isUpdatePassword':\n          return 'SucessSetPassword';\n        // vista de cargando\n        default:\n          return 'BaseLoading';\n      }\n    },\n  },\n  methods: {\n    updatePassword(newPassword) {\n      this.isLoadingUpdatePassword = true;\n      this.$apollo\n        .mutate({\n          mutation: SET_NEW_PASSWORD,\n          variables: {\n            input: {\n              id: this.userId,\n              password: newPassword,\n            },\n          },\n        })\n        .then(\n          ({\n            data: {\n              setNewPasswordUser: { status, message },\n            },\n          }) => {\n            if (status === 200 && !message.success)\n              this.isSamePassword =\n                'La contraseña no puede ser igual a la anterior';\n            if (status === 200 && message.success)\n              this.type = 'isUpdatePassword';\n            else this.errorHandler(status);\n            this.isLoadingUpdatePassword = false;\n          },\n        )\n        .catch(({ graphQLErrors }) => {\n          const [{ statusCode }] = graphQLErrors;\n          this.errorHandler(statusCode);\n          this.isLoadingUpdatePassword = false;\n        });\n    },\n    errorHandler(type) {\n      switch (type) {\n        case 400:\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: '¡Lo sentimos, el enlace ha expirado!',\n            message: 'Reenvia el correo para poder cambiar tu contraseña',\n          };\n          break;\n        case 401:\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: '¡Lo sentimos, el enlace ha expirado!',\n            message: 'Reenvia el correo para poder cambiar tu contraseña',\n          };\n          break;\n        case 404:\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: 'El usuario no existe',\n            message:\n              'Es posible que el usuario que estar tratando de actualizar ya no se encuentre activo',\n          };\n          break;\n        case 500:\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: 'La contraseña no se ha podido actualizar',\n            message:\n              'Ha ocurrido un error de servidor intente de nuevo mas tarde o contacte a soporte',\n          };\n          break;\n        default:\n          this.error = {\n            icon: 'mdi-shield-alert-outline',\n            tittle: '¡Lo sentimos, ha ocurrido un error desconocido!',\n            message: 'Contacte con soporte',\n          };\n          break;\n      }\n    },\n    cleanError() {\n      this.isSamePassword = '';\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPassword.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./ResetPassword.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResetPassword.vue?vue&type=template&id=742ff102&\"\nimport script from \"./ResetPassword.vue?vue&type=script&lang=js&\"\nexport * from \"./ResetPassword.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}