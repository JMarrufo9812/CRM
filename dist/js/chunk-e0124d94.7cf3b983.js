(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e0124d94"],{4693:function(t,e,n){},e0ca:function(t,e,n){"use strict";n("4693")},f1a6:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"d-flex justify-end"},[n("div",[n("v-btn",{staticClass:"mr-4",attrs:{small:"",plain:""},on:{click:function(e){t.showAllComments=!t.showAllComments}}},[t._v(" "+t._s(t.textComments)+" "),n("v-icon",[t._v(" "+t._s(t.showAllComments?"mdi-chevron-down":"mdi-chevron-up")+" ")])],1)],1)]),t.showAllComments?t._e():n("v-expand-transition",[n("div",{staticClass:"mx-4"},[t.note.comments&&t.note.comments.length?n("v-list",{attrs:{"three-line":"",dense:""}},[t._l(t.comments,(function(e){return[n("v-list-item",{key:e.id,staticClass:"comment"},[n("v-list-item-avatar",{staticClass:"justify-center",attrs:{size:"25",color:"secondary"}},[n("span",{staticClass:"white--text"},[t._v(" "+t._s(t.nameAccount({name:e.createdBy.user.name,lastName:e.createdBy.user.lastName})||"")+" ")])]),n("v-list-item-content",[n("v-list-item-title",[t._v(" "+t._s(e.createdBy.user.name)+" "+t._s(e.createdBy.user.lastName)+" ")]),n("v-list-item-subtitle",[t._v(" "+t._s(t._f("dateNow")(e.createdAt))+" ")]),n("div",{staticClass:"comment__content",domProps:{innerHTML:t._s(e.comment)}})],1),(t.canEdit||t.canEditOthers)&&!t.note.isDelete&&t.isMe(e.createdBy.id)?n("v-list-item-action",{staticClass:"comment__actions"},[n("v-menu",{attrs:{bottom:"","offset-y":"",left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",o,!1),a),[n("v-icon",{attrs:{color:"secondary"}},[t._v("mdi-dots-vertical")])],1)]}}],null,!0)},[n("v-list",[n("v-list-item",{attrs:{dense:""},on:{click:function(n){return t.editComment(e)}}},[n("v-list-item-title",[t._v("Editar")])],1),n("v-list-item",{attrs:{dense:""},on:{click:function(n){return t.removeComment(e.id)}}},[n("v-list-item-title",[t._v("Eliminar")])],1)],1)],1)],1):t._e()],1)]}))],2):t._e()],1)]),n("BaseModalError",{attrs:{modalHandler:t.modalError},on:{close:t.modalHandlerError}}),n("ModalComment",{on:{updateHistory:t.updateHistory}})],1)},o=[],i=(n("d3b7"),n("3ca3"),n("ddb0"),n("4e827"),n("fb6a"),n("b0c0"),n("99af"),n("4b58")),s=n("9685"),c=n("1891"),r=n("62f2"),d=n("1e6d"),m=n("891c"),l=n("ee2e"),u={name:"NoteListComments",mixins:[c["b"],d["a"]],components:{ModalComment:function(){return Promise.all([n.e("chunk-8277adaa"),n.e("chunk-4c461642"),n.e("chunk-607d40d0")]).then(n.bind(null,"cc04"))}},props:{note:{type:Object,default:function(){return{}}},typeItem:{type:String,required:!0,default:""},ownerId:{type:String,default:""}},data:function(){return{MAX_COMMENTS:2,showAllComments:!1,PERMISSIONS_NOTES:l["j"],UPDATE:m["r"],UPDATE_OTHERS:m["s"],subject:i["b"]}},computed:{textComments:function(){var t,e,n,a,o,i;return 1===(null===(t=this.note)||void 0===t||null===(e=t.comments)||void 0===e?void 0:e.length)?"".concat(null===(n=this.note)||void 0===n||null===(a=n.comments)||void 0===a?void 0:a.length," comentario"):"".concat((null===(o=this.note)||void 0===o||null===(i=o.comments)||void 0===i?void 0:i.length)||0," comentarios")},filters:function(){return{filters:{noteId:this.note.id}}},comments:function(){return this.note.comments.slice(0).sort((function(t,e){return new Date(t.createdAt)-new Date(e.createdAt)}))},canEdit:function(){return"CONTACT"===this.typeItem?s["a"].can(m["r"],Object(i["b"])(l["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem?s["a"].can(m["r"],Object(i["b"])(l["d"],{authorId:this.ownerId||""})):"DEAL"===this.typeItem&&s["a"].can(m["r"],Object(i["b"])(l["f"],{authorId:this.ownerId||""}))},canEditOthers:function(){return"CONTACT"===this.typeItem?this.canEdit?s["a"].can(m["s"],Object(i["b"])(l["e"],{authorId:this.ownerId||""})):s["a"].can(m["s"],l["e"])&&!s["a"].can(m["s"],Object(i["b"])(l["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem?this.canEdit?s["a"].can(m["s"],Object(i["b"])(l["d"],{authorId:this.ownerId||""})):s["a"].can(m["s"],l["d"])&&!s["a"].can(m["s"],Object(i["b"])(l["d"],{authorId:this.ownerId||""})):"DEAL"===this.typeItem&&(this.canEdit?s["a"].can(m["s"],Object(i["b"])(l["f"],{authorId:this.ownerId||""})):s["a"].can(m["s"],l["f"])&&!s["a"].can(m["s"],Object(i["b"])(l["f"],{authorId:this.ownerId||""})))}},methods:{isMe:function(t){return s["a"].can(m["r"],Object(i["b"])(l["j"],{authorId:t||""}))},nameAccount:function(t){var e=t.name,n=t.lastName;return!e&&n?"SN":"".concat(e.charAt(0).toUpperCase()).concat(n.charAt(0).toUpperCase())},editComment:function(t){this.changeModal({id:"createComment",status:!0,isEdit:!0,item:t})},removeComment:function(t){var e=this;this.$apollo.mutate({mutation:r["c"],variables:{noteCommentId:t}}).then((function(){e.updateHistory()})).catch((function(){var t="No se pudo eliminar el comentario, intente de nuevo o contacte a soporte";e.modalHandlerError({isOpen:!0,error:t})}))},updateHistory:function(){this.$emit("updateHistory")}}},h=u,v=(n("e0ca"),n("0c7c")),f=n("6544"),b=n.n(f),p=n("8336"),I=n("0789"),C=n("132d"),_=n("8860"),y=n("da13"),w=n("1800"),E=n("8270"),A=n("5d23"),O=n("e449"),j=Object(v["a"])(h,a,o,!1,null,"b7ec4ac8",null);e["default"]=j.exports;b()(j,{VBtn:p["a"],VExpandTransition:I["a"],VIcon:C["a"],VList:_["a"],VListItem:y["a"],VListItemAction:w["a"],VListItemAvatar:E["a"],VListItemContent:A["a"],VListItemSubtitle:A["b"],VListItemTitle:A["c"],VMenu:O["a"]})}}]);
//# sourceMappingURL=chunk-e0124d94.7cf3b983.js.map