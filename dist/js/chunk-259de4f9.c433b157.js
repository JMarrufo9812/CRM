(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-259de4f9","chunk-7859f8ee","chunk-7859f8ee"],{"129f":function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t===1/n:t!=t&&n!=n}},"220c":function(t,n,a){},"231e":function(t,n,a){"use strict";a.d(n,"a",(function(){return m})),a.d(n,"b",(function(){return p})),a.d(n,"e",(function(){return f})),a.d(n,"d",(function(){return C})),a.d(n,"f",(function(){return h})),a.d(n,"c",(function(){return v})),a.d(n,"g",(function(){return b}));var e,i,o,c,s,r,d,u=a("8785"),l=a("5184"),m=Object(l["a"])(e||(e=Object(u["a"])(["\n  mutation createCompany($input: companyCreateInput!) {\n    createCompany(companyInput: $input) {\n      id\n      name\n      address\n      website\n      phones\n      socialMedias\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      contacts {\n        id\n        name\n      }\n    }\n  }\n"]))),p=Object(l["a"])(i||(i=Object(u["a"])(["\n  mutation deletedCompanies($input: [DeleteCompanyInput!]!) {\n    deletedCompanies(companies: $input) {\n      id\n      name\n    }\n  }\n"]))),f=Object(l["a"])(o||(o=Object(u["a"])(["\n  mutation trashCompanies($input: [DeleteCompanyInput!]!) {\n    trashCompanies(companies: $input) {\n      id\n    }\n  }\n"]))),C=Object(l["a"])(c||(c=Object(u["a"])(["\n  mutation restoreCompanies($input: [DeleteCompanyInput!]!) {\n    restoreCompanies(companies: $input) {\n      id\n    }\n  }\n"]))),h=Object(l["a"])(s||(s=Object(u["a"])(["\n  mutation updateCompany($companyInput: companyUpdateInput!) {\n    updateCompany(companyInput: $companyInput) {\n      id\n      name\n      address\n      website\n      phones\n      customForms\n      socialMedias\n      tags {\n        id\n        name\n        color\n        order\n      }\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      contacts {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      deals {\n        id\n        title\n        value\n        status\n        contact {\n          id\n          name\n        }\n        company {\n          id\n          name\n        }\n        stage {\n          id\n        }\n        pipeline {\n          id\n          stages {\n            id\n          }\n        }\n        owner {\n          id\n        }\n      }\n    }\n  }\n"]))),v=Object(l["a"])(r||(r=Object(u["a"])(["\n  mutation FuseCompanies($input: CompaniesToFuse!) {\n    fuseCompanies(fuse: $input) {\n      id\n      name\n    }\n  }\n"]))),b=Object(l["a"])(d||(d=Object(u["a"])(["\n  mutation assignCompanies($companyListAssign: CompanyListAssign!) {\n    assignCompanies(companyListAssign: $companyListAssign)\n  }\n"])))},2532:function(t,n,a){"use strict";var e=a("23e7"),i=a("5a34"),o=a("1d80"),c=a("ab13");e({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~String(o(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"2cff":function(t,n,a){"use strict";a.d(n,"a",(function(){return m})),a.d(n,"f",(function(){return p})),a.d(n,"b",(function(){return f})),a.d(n,"e",(function(){return C})),a.d(n,"d",(function(){return h})),a.d(n,"c",(function(){return v})),a.d(n,"g",(function(){return b}));var e,i,o,c,s,r,d,u=a("8785"),l=a("5184"),m=Object(l["a"])(e||(e=Object(u["a"])(["\n  mutation CreateContact($input: contactCreateInput!) {\n    createContact(contactInput: $input) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      owner {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n      }\n      isClient\n    }\n  }\n"]))),p=Object(l["a"])(i||(i=Object(u["a"])(["\n  mutation updateContact($contactInput: contactUpdateInput) {\n    updateContact(contactInput: $contactInput) {\n      id\n      name\n      email\n      phones\n      isClient\n      socialMedias\n      birthday\n      customForms\n      owner {\n        id\n        user {\n          id\n          name\n        }\n      }\n      enterprise {\n        id\n        name\n      }\n      tags {\n        id\n        name\n        color\n        order\n      }\n      companies {\n        id\n        name\n        owner {\n          id\n        }\n      }\n      deals {\n        id\n        title\n        value\n        status\n        contact {\n          id\n          name\n        }\n        company {\n          id\n          name\n        }\n        stage {\n          id\n        }\n        pipeline {\n          id\n          stages {\n            id\n          }\n        }\n        owner {\n          id\n        }\n      }\n      createdAt\n    }\n  }\n"]))),f=Object(l["a"])(o||(o=Object(u["a"])(["\n  mutation deletedContacts($input: [DeleteContactInput!]!) {\n    deletedContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),C=Object(l["a"])(c||(c=Object(u["a"])(["\n  mutation trashContacts($input: [DeleteContactInput!]!) {\n    trashContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),h=Object(l["a"])(s||(s=Object(u["a"])(["\n  mutation restoreContacts($input: [DeleteContactInput!]!) {\n    restoreContacts(contacts: $input) {\n      id\n      name\n    }\n  }\n"]))),v=Object(l["a"])(r||(r=Object(u["a"])(["\n  mutation FuseContacts($input: ContactsToFuse!) {\n    fuseContacts(fuse: $input) {\n      id\n      name\n    }\n  }\n"]))),b=Object(l["a"])(d||(d=Object(u["a"])(["\n  mutation assignContacts($contactListAssign: ContactListAssign!) {\n    assignContacts(contactListAssign: $contactListAssign)\n  }\n"])))},4393:function(t,n,a){"use strict";a.r(n);var e=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("v-card",{attrs:{tile:"",flat:""}},[a("v-divider"),a("v-card-title",{staticClass:"contacts-title py-1"},[a("v-icon",{staticClass:"mr-4",attrs:{color:"primary"}},[t._v("mdi-account")]),t._v(" Contactos "),a("v-spacer"),a("v-menu",{staticClass:"mt-2",attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(n){var e=n.on;return[a("v-btn",t._g({directives:[{name:"show",rawName:"v-show",value:(t.canEditCompany||t.canEditCompanyOthers)&&!t.item.isDelete,expression:"(canEditCompany || canEditCompanyOthers) && !item.isDelete"}],attrs:{icon:""},on:{click:function(n){t.isShowAddContact=!t.isShowAddContact}}},e),[a("v-icon",[t._v("mdi-plus")])],1)]}}]),model:{value:t.isShowAddContact,callback:function(n){t.isShowAddContact=n},expression:"isShowAddContact"}},[a("v-card",{staticClass:"pa-4",attrs:{width:"18em"}},[a("v-form",{ref:"formContact"},[a("FieldSelectContactSimple",{attrs:{inputProps:{class:"no-icon full-width",isDense:!0},resetHandler:t.isShowAddContact},on:{outData:t.updateContact,deleteData:t.deleteContact}})],1),a("div",{staticClass:"d-flex justify-space-around pt-2 ml-2"},[a("v-btn",{staticStyle:{width:"45%"},attrs:{color:"primary",outlined:"",small:""},on:{click:t.cancel}},[t._v(" Cancelar ")]),!t.canEditCompany&&!t.canEditCompanyOthers||t.item.isDelete?t._e():a("v-btn",{staticStyle:{width:"45%"},attrs:{color:"secondary",small:"",disabled:t.disabledAddButton,loading:t.isLoading},on:{click:t.addContact}},[t._v(" Guardar ")])],1)],1)],1)],1),a("v-divider"),a("v-card-text",{staticClass:"pa-0"},[a("v-card",{attrs:{flat:"","max-height":"20em"}},[0===t.contactsSelected.length?a("div",{staticClass:"pa-10 text-center"},[a("span",[t._v(" No tiene contactos ")])]):t._l(t.listContacts,(function(n,e){return[a("v-list-item",{key:n.id,staticClass:"Contact",attrs:{outlined:""}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"Contact__title"},[[a("div",{staticClass:"Contact__box",on:{click:function(a){return t.goContact(n.id)}}},[a("v-icon",[t._v("mdi-account")]),a("span",{staticClass:"Contact__box_name"},[t._v(" "+t._s(n.name)+" ")])],1)]],2)],1),a("v-list-item-action",{staticClass:"Contact__edit"},[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,o=e.attrs;return[t.canEditCompany||t.canEditCompanyOthers?a("v-btn",t._g(t._b({staticClass:"mr-2 mt-2",attrs:{color:"grey",outlined:"","x-small":"",loading:t.isLoadingRemove},on:{click:function(a){return a.stopPropagation(),t.disconnectContact(n.id)}}},"v-btn",o,!1),i),[a("v-icon",{attrs:{small:""}},[t._v("mdi-connection")])],1):t._e()]}}],null,!0)},[a("span",[t._v("Desvincular")])]),a("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[!t.canEditContact(n.owner)&&!t.canEditContactOthers(n.owner)||!t.canEditCompany&&!t.canEditCompanyOthers||t.item.isDelete?t._e():a("v-btn",t._g({staticClass:"mt-2",attrs:{color:"secondary","x-small":""},on:{click:function(t){t.stopPropagation(),n.edit=!0}}},{onMenu:i,onTooltip:o}),[a("v-icon",{attrs:{small:"",color:"white"}},[t._v("mdi-pencil")])],1)]}}],null,!0)},[a("span",[t._v("Cambiar nombre")])])]}}],null,!0),model:{value:n.edit,callback:function(a){t.$set(n,"edit",a)},expression:"contact.edit"}},[a("v-card",{staticClass:"pa-4",attrs:{width:"18em"}},[a("v-form",{ref:"form-"+e,refInFor:!0,attrs:{"lazy-validation":""},model:{value:t.isValidateFormName,callback:function(n){t.isValidateFormName=n},expression:"isValidateFormName"}},[a("v-text-field",{attrs:{label:"Nombre",maxlength:"50",dense:"",outlined:"","hide-details":"auto",rules:t.rules.general},model:{value:n.name,callback:function(a){t.$set(n,"name",a)},expression:"contact.name"}}),a("div",{staticClass:"d-flex justify-center mt-1"},[a("v-btn",{staticClass:"mr-2",staticStyle:{width:"45%"},attrs:{"x-small":"",color:"primary",outlined:""},on:{click:function(a){return t.cancelEdit(n.id)}}},[t._v(" Cancelar ")]),!t.canEditContact(n.owner)&&!t.canEditContactOthers(n.owner)||!t.canEditCompany&&!t.canEditCompanyOthers||t.item.isDelete?t._e():a("v-btn",{staticStyle:{width:"45%"},attrs:{"x-small":"",color:"secondary",loading:t.isLoadingChangeName},on:{click:function(a){return t.updateName({id:n.id,name:n.name,idx:e})}}},[t._v(" Guardar ")])],1)],1)],1)],1)],1)],1)]}))],2)],1),a("BaseModalError",{attrs:{modalHandler:t.modalError},on:{close:t.modalHandlerError}})],1)},i=[],o=(a("d3b7"),a("3ca3"),a("ddb0"),a("ac1f"),a("841c"),a("b0c0"),a("d81d"),a("b64b"),a("c740"),a("a434"),a("7db0"),a("4b58")),c=a("9685"),s=a("6bfe"),r=a("891c"),d=a("ee2e"),u=a("2cff"),l=a("f82a"),m=a("e815"),p=a("1e6d"),f=a("78f1"),C={name:"ListContacts",components:{FieldSelectContactSimple:function(){return a.e("chunk-e3e9f60c").then(a.bind(null,"b8ca"))}},mixins:[l["a"],s["a"],p["a"],f["a"]],props:{item:{type:Object,required:!0},itemId:{type:String,default:"",required:!0},typeItem:{type:String,required:!0,default:"CONTACT"},ownerId:{type:String,default:""},contactsSelected:{type:Array,default:function(){return[]}}},data:function(){return{UPDATE:r["r"],UPDATE_OTHERS:r["s"],PERMISSIONS_CONTACTS:d["e"],PERMISSIONS_COMPANIES:d["d"],search:"",contact:"",contacts:{},isLoading:!1,listContacts:[],isNewContact:!1,isLoadingRemove:!1,isShowAddContact:!1,isValidateFormName:!0,isLoadingChangeName:!1,contactNew:{id:"",name:""},userCurrent:{}}},created:function(){this.listContacts=this.formatListContacts(this.contactsSelected)},watch:{contactsSelected:{handler:function(t){this.listContacts=this.formatListContacts(t)},deep:!0},contact:function(t){t&&t.id?(this.isNewContact=!1,this.contactNew={id:t.id,name:""}):t?(this.isNewContact=!0,this.contactNew={id:"",name:t}):this.contactNew={id:"",name:""}},isLoadingUpdateCompany:function(t){t||(this.isLoading=!1,this.contact="",this.isShowAddContact&&this.$refs.formContact.reset(),this.isShowAddContact=!1,this.isLoadingRemove=!1,this.contactNew={id:"",name:""})}},computed:{canEditCompany:function(){return c["a"].can(r["r"],Object(o["b"])(d["d"],{authorId:this.ownerId||""}))},canEditCompanyOthers:function(){return this.canEditCompany?c["a"].can(r["r"],Object(o["b"])(d["d"],{authorId:this.ownerId||""})):c["a"].can(r["s"],d["d"])&&!c["a"].can(r["s"],Object(o["b"])(d["d"],{authorId:this.ownerId||""}))},menuProps:function(){return this.search?{}:{value:!1}},readOnly:function(){return null!==this.contact&&void 0!==this.contact&&""!==this.contact},disabledAddButton:function(){return!this.contactNew.id&&!this.contactNew.name}},methods:{canEditContact:function(t){return c["a"].can(r["r"],Object(o["b"])(d["e"],{authorId:t.id||""}))},canEditContactOthers:function(t){return this.canEditContact(t)?c["a"].can(r["s"],Object(o["b"])(d["e"],{authorId:t.id||""})):c["a"].can(r["s"],d["e"])&&!c["a"].can(r["s"],Object(o["b"])(d["e"],{authorId:t.id||""}))},updateContact:function(t,n){this.contactNew=n},deleteContact:function(){this.contactNew={id:"",name:""}},formatListContacts:function(t){return t.map((function(t){return{id:t.id,name:t.name,edit:!1,owner:t.owner}}))},goContact:function(t){this.$router.push({name:"contact",params:{id:t}},(function(){}))},cancel:function(){this.contact="",this.contactNew={id:"",name:""},this.isShowAddContact=!1},formatContacts:function(t){return t.map((function(t){return{id:t.id}}))},addContact:function(){this.canEditCompany&&0!==Object.keys(this.contactNew).length&&(this.isLoading=!0,this.updateCompany({id:this.itemId,contact:this.contactNew}))},disconnectContact:function(t){if(this.canEditCompany){this.isLoadingRemove=!0;var n=JSON.parse(JSON.stringify(this.contactsSelected)),a=this.formatContacts(n),e=a.findIndex((function(n){return n.id===t}));a.splice(e,1),this.updateCompany({id:this.itemId,contact:{disconnect:{id:t}}})}},updateName:function(t){var n=this,a=t.id,e=t.name,i=t.idx;this.canEditContact&&(this.$refs["form-".concat(i)][0].validate(),this.isValidateFormName&&(this.isLoadingChangeName=!0,this.$apollo.mutate({mutation:u["f"],variables:{contactInput:{id:a,name:e}}}).then((function(t){var a=t.data.updateContact;n.$emit("updateCompanyContact",a,i),n.isLoadingChangeName=!1,n.isValidateFormName=!1})).catch((function(){n.isLoadingChangeName=!1,n.isValidateFormName=!1;var t="No se pudo actualizar el nombre, intente de nuevo o contacte a soporte";n.modalHandlerError({isOpen:!0,error:t})}))))},getIndexField:function(t){return this.listContacts.findIndex((function(n){return n.id===t}))},text:function(t){return"".concat(t.name)},cancelEdit:function(t){var n=this.getIndexField(t);this.listContacts[n].edit=!1;var a=this.contactsSelected.find((function(n){return n.id===t})).name;this.listContacts[n].name=a}},apollo:{userCurrent:{query:m["k"]}}},h=C,v=(a("a8cd"),a("0c7c")),b=a("6544"),y=a.n(b),g=a("8336"),w=a("b0af"),O=a("99d9"),I=a("ce7e"),S=a("4bd4"),N=a("132d"),_=a("da13"),j=a("1800"),E=a("5d23"),x=a("e449"),$=a("2fa4"),L=a("8654"),A=a("3a2f"),k=Object(v["a"])(h,e,i,!1,null,"adb643ac",null);n["default"]=k.exports;y()(k,{VBtn:g["a"],VCard:w["a"],VCardText:O["c"],VCardTitle:O["d"],VDivider:I["a"],VForm:S["a"],VIcon:N["a"],VListItem:_["a"],VListItemAction:j["a"],VListItemContent:E["a"],VListItemTitle:E["c"],VMenu:x["a"],VSpacer:$["a"],VTextField:L["a"],VTooltip:A["a"]})},"5a34":function(t,n,a){var e=a("44e7");t.exports=function(t){if(e(t))throw TypeError("The method doesn't accept regular expressions");return t}},"6bfe":function(t,n,a){"use strict";a.d(n,"a",(function(){return s}));a("caad"),a("2532");var e=a("4b58"),i=a("9685"),o=a("891c"),c=a("e815"),s={data:function(){return{membersGroup:[]}},methods:{canGroup:function(t,n,a,c){var s=c.authorId;return!!s&&(i["a"].can(t,Object(e["b"])(n,{authorId:s}))||i["a"].can(o["b"],a)&&i["a"].can(t,n)||i["a"].can(o["m"],a)&&this.membersGroup.includes(s)&&i["a"].can(t,n))}},apollo:{membersGroup:{query:c["k"],update:function(t){var n=t.userCurrent;return n.membersGroup}}}}},"78f1":function(t,n,a){"use strict";a.d(n,"a",(function(){return i}));a("b0c0");var e=a("231e"),i={data:function(){return{isLoadingUpdateCompany:!1}},methods:{updateCompany:function(t){var n=this,a=t.id,i=t.name,o=t.address,c=t.website,s=t.socialMedias,r=t.phones,d=t.customForm,u=t.contact,l=t.tags,m=t.owner,p=t.deal;this.isLoadingUpdateCompany=!0;var f={};f.id=a,i&&(f.name=i),o&&(f.address=o),c&&(f.website=c),s&&(f.socialMedias=s),r&&(f.phones=r),d&&(f.customForm=d),u&&(f.contact=u),l&&(f.tags=l),m&&(f.owner=m),p&&(f.deal=p),this.$apollo.mutate({mutation:e["f"],variables:{companyInput:f}}).then((function(t){var a=t.data.updateCompany;n.$emit("updateItem",a),n.$emit("updateHistory"),n.isLoadingUpdateCompany=!1})).catch((function(){n.isLoadingUpdateCompany=!1;var t="No se pudo actualizar la empresa, intente de nuevo o contacte a soporte";n.modalHandlerError({isOpen:!0,error:t})}))}}}},"841c":function(t,n,a){"use strict";var e=a("d784"),i=a("825a"),o=a("1d80"),c=a("129f"),s=a("14c3");e("search",(function(t,n,a){return[function(n){var a=o(this),e=void 0==n?void 0:n[t];return void 0!==e?e.call(n,a):new RegExp(n)[t](String(a))},function(t){var e=a(n,this,t);if(e.done)return e.value;var o=i(this),r=String(t),d=o.lastIndex;c(d,0)||(o.lastIndex=0);var u=s(o,r);return c(o.lastIndex,d)||(o.lastIndex=d),null===u?-1:u.index}]}))},a8cd:function(t,n,a){"use strict";a("220c")},ab13:function(t,n,a){var e=a("b622"),i=e("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(a){try{return n[i]=!1,"/./"[t](n)}catch(e){}}return!1}},caad:function(t,n,a){"use strict";var e=a("23e7"),i=a("4d64").includes,o=a("44d2");e({target:"Array",proto:!0},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")}}]);
//# sourceMappingURL=chunk-259de4f9.c433b157.js.map