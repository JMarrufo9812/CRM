(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51a712c2"],{"0521":function(e,t,i){},"6b2a":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("b0c0"),i("a4d3"),i("e01a");var n=i("8907"),a={data:function(){return{modalFileEdit:{isOpen:!1,isLoading:!1,info:{}}}},methods:{modalFileEditHandler:function(e){var t=e.isOpen,i=e.isLoading,n=e.info;this.modalFileEdit={isOpen:t,isLoading:i,info:n}},uploadFile:function(e,t,i,a){var o=this;this.isLoading=!0;var r=i.name,d=i.size;this.$apollo.mutate({mutation:n["c"],client:"files",variables:{input:{location:e,idSource:t,name:r,size:d,file:i}}}).then((function(i){var n=i.data.uploadFile;if(a.length>0){var r={item:{id:n.id,description:a},itemId:t,typeItem:e};o.updateFile({isOpen:!1,isLoading:!1,info:r})}else o.$emit("updateHistory");o.isLoading=!1,o.close()})).catch((function(){o.isLoading=!1;var e="No se ha podido subir el archivo, intente de nuevo o contacte a soporte";o.modalHandlerError({isOpen:!0,error:e})}))},updateFile:function(e){var t=this,i=e.isOpen,a=e.isLoading,o=e.info;this.modalFileEditHandler({isOpen:i,isLoading:a,info:o});var r={idSource:o.itemId,fileId:o.item.id,location:o.typeItem,description:o.item.description};this.$apollo.mutate({mutation:n["b"],variables:{input:r}}).then((function(){t.$emit("updateHistory"),t.modalFileEditHandler({isOpen:!1,isLoading:!1,info:{}})})).catch((function(){t.modalFileEditHandler({isOpen:!0,isLoading:!1,info:{}});var e="No se pudo agregar la descripcion al archivo, intente de nuevo o contacte a soporte";t.modalHandlerError({isOpen:!0,error:e})}))},deleteFile:function(e){var t=this,i=e.isOpen,a=e.isLoading,o=e.message,r=e.infoDelete;this.modalHandlerDelete({isOpen:i,isLoading:a,message:o,infoDelete:r}),this.$apollo.mutate({mutation:n["a"],client:"files",variables:{input:{key:r.data.item.url.key,idSource:r.data.itemId,fileId:r.data.item.id,location:r.data.typeItem}}}).then((function(){t.$emit("updateHistory"),t.modalHandlerDelete({isOpen:!1,isLoading:a,message:o,infoDelete:r})})).catch((function(){var e="No se pudo eliminar el archivo, intente de nuevo o contacte a soporte";t.modalHandlerError({isOpen:!0,error:e})}))},deleteFileWhitOutModal:function(e){var t=this,i={key:e};this.$apollo.mutate({client:"files",mutation:n["a"],variables:{input:i}}).catch((function(){var e="No se pudo eliminar el archivo, intente de nuevo o contacte a soporte";t.modalHandlerError({isOpen:!0,error:e})}))}}}},"857a":function(e,t,i){var n=i("1d80"),a=/"/g;e.exports=function(e,t,i,o){var r=String(n(e)),d="<"+t;return""!==i&&(d+=" "+i+'="'+String(o).replace(a,"&quot;")+'"'),d+">"+r+"</"+t+">"}},8907:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return c})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return m}));var n,a,o,r,d=i("8785"),l=i("5184"),s=Object(l["a"])(n||(n=Object(d["a"])(["\n  mutation UploadFile($input: TypeFileInput!) {\n    uploadFile(upFile: $input) {\n      id\n      name\n      fileExtension\n      url {\n        link\n        key\n      }\n      description\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n      size\n    }\n  }\n"]))),c=Object(l["a"])(a||(a=Object(d["a"])(["\n  mutation uploadProfilePhoto($input: FileInput!) {\n    uploadProfilePhoto(upFile: $input) {\n      link\n    }\n  }\n"]))),u=Object(l["a"])(o||(o=Object(d["a"])(["\n  mutation DeleteFile($input: DeleteFile!) {\n    deleteFile(deleteFile: $input)\n  }\n"]))),m=Object(l["a"])(r||(r=Object(d["a"])(["\n  mutation UpdateDescriptionFile($input: descriptionInput!) {\n    updateDescriptionFile(descriptionInput: $input) {\n      id\n      name\n      url {\n        key\n        link\n      }\n      description\n      size\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n"])))},9911:function(e,t,i){"use strict";var n=i("23e7"),a=i("857a"),o=i("af03");n({target:"String",proto:!0,forced:o("link")},{link:function(e){return a(this,"a","href",e)}})},a5c9:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-card",{staticClass:"my-4",attrs:{width:"95%"}},[i("v-card-title",{staticClass:"d-flex justify-space-between file-name"},[i("span",{staticClass:"text-truncate",staticStyle:{"max-width":"90%"},on:{click:function(t){return e.previewFile(e.item)}}},[e._v(" "+e._s(e.item.name)+" ")]),(e.canEdit||e.canEditOthers)&&!e.item.isDelete&&e.isMe?i("v-menu",{attrs:{bottom:"","offset-y":"",left:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,a=t.attrs;return[i("v-btn",e._g(e._b({attrs:{icon:"",disabled:!((e.canEdit||e.canEditOthers)&&!e.item.isDelete)||!e.isMe}},"v-btn",a,!1),n),[i("v-icon",[e._v("mdi-dots-vertical")])],1)]}}],null,!1,2486748620)},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:function(t){return e.actionsHandler("UPDATE",{item:e.item,typeItem:e.typeItem,itemId:e.itemId})}}},[i("v-list-item-title",[e._v(" "+e._s(e.item.description?"Editar descripci칩n":"A침adir descripci칩n")+" ")])],1),i("v-list-item",{on:{click:function(t){return e.downloadFile(e.item)}}},[i("v-list-item-title",[e._v(" Descargar ")])],1),i("v-list-item",{on:{click:function(t){return e.actionsHandler("DELETE",{item:e.item,typeItem:e.typeItem,itemId:e.itemId})}}},[i("v-list-item-title",[e._v("Eliminar")])],1)],1)],1):e._e()],1),e.item.description?i("v-card-subtitle",{staticClass:"mt-2"},[e._v(" "+e._s(e.item.description?e.item.description:"")+" ")]):e._e(),i("v-card-text",[e._v(" subido por "+e._s(e.item.createdBy.user.name)+" "+e._s(e.item.createdBy.user.lastName)+" "),i("span",[e._v(" "+e._s(e._f("timeZoneFromNow")(e.item.createdAt))+" ")])])],1),i("BaseModalError",{attrs:{modalHandler:e.modalError},on:{close:e.modalHandlerError}}),i("ModalFileEdit",{attrs:{modalHandler:e.modalFileEdit},on:{outData:e.updateFile,close:e.modalFileEditHandler}}),i("ModalPreviewFile",{attrs:{modalHandler:e.modalPreviewFile},on:{close:e.modalHandlerPreviewFile}}),i("BaseModalDelete",{attrs:{modalHandler:e.modalDelete},on:{cancel:e.modalHandlerDelete,confirm:e.deleteFile}})],1)},a=[],o=i("1da1"),r=(i("96cf"),i("d3b7"),i("3ca3"),i("ddb0"),i("b0c0"),i("9911"),i("2b3d"),i("4b58")),d=i("9685"),l=i("6b2a"),s=i("1e6d"),c=i("ee2e"),u=i("891c"),m={name:"File",mixins:[s["a"],l["a"]],components:{ModalFileEdit:function(){return i.e("chunk-520476e7").then(i.bind(null,"b7db"))},ModalPreviewFile:function(){return i.e("chunk-2d0c81f9").then(i.bind(null,"5415"))}},props:{itemId:{type:String,default:"",required:!0},typeItem:{type:String,required:!0,default:"CONTACT"},ownerId:{type:String,default:""},item:{type:Object,required:!0}},data:function(){return{subject:r["b"],UPDATE:u["r"],UPDATE_OTHERS:u["s"],PERMISSIONS_FILES:c["g"],PERMISSIONS_CONTACTS:c["e"],PERMISSIONS_COMPANIES:c["d"],PERMISSIONS_DEALS:c["f"],modalPreviewFile:{isOpen:!1,file:""}}},computed:{isMe:function(){return d["a"].can(u["r"],Object(r["b"])(c["g"],{authorId:this.item.createdBy.id||""}))},canEdit:function(){return"CONTACT"===this.typeItem?d["a"].can(u["r"],Object(r["b"])(c["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem?d["a"].can(u["r"],Object(r["b"])(c["d"],{authorId:this.ownerId||""})):"DEAL"===this.typeItem&&d["a"].can(u["r"],Object(r["b"])(c["f"],{authorId:this.ownerId||""}))},canEditOthers:function(){return"CONTACT"===this.typeItem?this.canEdit?d["a"].can(u["s"],c["e"]):d["a"].can(u["s"],c["e"])&&!d["a"].can(u["s"],Object(r["b"])(c["e"],{authorId:this.ownerId||""})):"COMPANY"===this.typeItem?this.canEdit?d["a"].can(u["s"],c["d"]):d["a"].can(u["s"],c["d"])&&!d["a"].can(u["s"],Object(r["b"])(c["d"],{authorId:this.ownerId||""})):"DEAL"===this.typeItem&&(this.canEdit?d["a"].can(u["s"],c["f"]):d["a"].can(u["s"],c["f"])&&!d["a"].can(u["s"],Object(r["b"])(c["f"],{authorId:this.ownerId||""})))}},methods:{actionsHandler:function(e,t){"DELETE"===e&&this.modalHandlerDelete({isOpen:!0,isLoading:!1,message:{text:"ser치 eliminado",nameItem:"El archivo ".concat(t.item.name)},infoDelete:{data:t}}),"UPDATE"===e&&this.modalFileEditHandler({isOpen:!0,isLoading:!1,info:t})},modalHandlerPreviewFile:function(e){var t=e.isOpen,i=e.file;this.modalPreviewFile={isOpen:t,file:i}},previewFile:function(e){"png"===e.fileExtension||"jpg"===e.fileExtension||"jpeg"===e.fileExtension||"jpg"===e.fileExtension||"JPG"===e.fileExtension||"svg"===e.fileExtension?this.modalHandlerPreviewFile({isOpen:!0,file:e}):window.open(e.url.link,"_blank")},downloadFile:function(e){return Object(o["a"])(regeneratorRuntime.mark((function t(){var i,n,a,o,r,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=e.name,n=e.url.link,t.next=3,fetch(n);case 3:return a=t.sent,t.next=6,a.blob();case 6:o=t.sent,r=URL.createObjectURL(o),d=document.createElement("a"),d.href=r,d.download=i,d.click();case 12:case"end":return t.stop()}}),t)})))()}}},p=m,f=(i("e03e"),i("0c7c")),h=i("6544"),v=i.n(h),b=i("8336"),E=i("b0af"),I=i("99d9"),O=i("132d"),F=i("8860"),g=i("da13"),y=i("5d23"),w=i("e449"),H=Object(f["a"])(p,n,a,!1,null,"b476edd8",null);t["default"]=H.exports;v()(H,{VBtn:b["a"],VCard:E["a"],VCardSubtitle:I["b"],VCardText:I["c"],VCardTitle:I["d"],VIcon:O["a"],VList:F["a"],VListItem:g["a"],VListItemTitle:y["c"],VMenu:w["a"]})},af03:function(e,t,i){var n=i("d039");e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},e03e:function(e,t,i){"use strict";i("0521")}}]);
//# sourceMappingURL=chunk-51a712c2.a99d9abe.js.map