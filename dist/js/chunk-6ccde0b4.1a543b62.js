(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ccde0b4"],{"1bca":function(e,t,n){},"3a60":function(e,t,n){"use strict";n("1bca")},"40bd":function(e,t,n){"use strict";n.r(t),n.d(t,"globalPolyfill",(function(){return a}));const a=()=>{var e=e||window;window&&(window.global=e)}},"5db7":function(e,t,n){"use strict";var a=n("23e7"),s=n("a2bf"),i=n("7b0b"),o=n("50c4"),r=n("1c0b"),l=n("65f0");a({target:"Array",proto:!0},{flatMap:function(e){var t,n=i(this),a=o(n.length);return r(e),t=l(n,0),t.length=s(t,n,n,a,0,1,e,arguments.length>1?arguments[1]:void 0),t}})},6062:function(e,t,n){"use strict";var a=n("6d61"),s=n("6566");e.exports=a("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),s)},6566:function(e,t,n){"use strict";var a=n("9bf2").f,s=n("7c73"),i=n("e2cc"),o=n("0366"),r=n("19aa"),l=n("2266"),d=n("7dd0"),c=n("2626"),u=n("83ab"),p=n("f183").fastKey,m=n("69f3"),f=m.set,h=m.getterFor;e.exports={getConstructor:function(e,t,n,d){var c=e((function(e,a){r(e,c,t),f(e,{type:t,index:s(null),first:void 0,last:void 0,size:0}),u||(e.size=0),void 0!=a&&l(a,e[d],{that:e,AS_ENTRIES:n})})),m=h(t),v=function(e,t,n){var a,s,i=m(e),o=b(e,t);return o?o.value=n:(i.last=o={index:s=p(t,!0),key:t,value:n,previous:a=i.last,next:void 0,removed:!1},i.first||(i.first=o),a&&(a.next=o),u?i.size++:e.size++,"F"!==s&&(i.index[s]=o)),e},b=function(e,t){var n,a=m(e),s=p(t);if("F"!==s)return a.index[s];for(n=a.first;n;n=n.next)if(n.key==t)return n};return i(c.prototype,{clear:function(){var e=this,t=m(e),n=t.index,a=t.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete n[a.index],a=a.next;t.first=t.last=void 0,u?t.size=0:e.size=0},delete:function(e){var t=this,n=m(t),a=b(t,e);if(a){var s=a.next,i=a.previous;delete n.index[a.index],a.removed=!0,i&&(i.next=s),s&&(s.previous=i),n.first==a&&(n.first=s),n.last==a&&(n.last=i),u?n.size--:t.size--}return!!a},forEach:function(e){var t,n=m(this),a=o(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:n.first){a(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!b(this,e)}}),i(c.prototype,n?{get:function(e){var t=b(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),u&&a(c.prototype,"size",{get:function(){return m(this).size}}),c},setStrong:function(e,t,n){var a=t+" Iterator",s=h(t),i=h(a);d(e,t,(function(e,t){f(this,{type:a,target:e,state:s(e),kind:t,last:void 0})}),(function(){var e=i(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(t)}}},"6d61":function(e,t,n){"use strict";var a=n("23e7"),s=n("da84"),i=n("94ca"),o=n("6eeb"),r=n("f183"),l=n("2266"),d=n("19aa"),c=n("861d"),u=n("d039"),p=n("1c7e"),m=n("d44e"),f=n("7156");e.exports=function(e,t,n){var h=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),b=h?"set":"add",g=s[e],y=g&&g.prototype,_=g,C={},I=function(e){var t=y[e];o(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!c(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})},k=i(e,"function"!=typeof g||!(v||y.forEach&&!u((function(){(new g).entries().next()}))));if(k)_=n.getConstructor(t,e,h,b),r.REQUIRED=!0;else if(i(e,!0)){var O=new _,x=O[b](v?{}:-0,1)!=O,E=u((function(){O.has(1)})),S=p((function(e){new g(e)})),F=!v&&u((function(){var e=new g,t=5;while(t--)e[b](t,t);return!e.has(-0)}));S||(_=t((function(t,n){d(t,_,e);var a=f(new g,t,_);return void 0!=n&&l(n,a[b],{that:a,AS_ENTRIES:h}),a})),_.prototype=y,y.constructor=_),(E||F)&&(I("delete"),I("has"),h&&I("get")),(F||x)&&I(b),v&&y.clear&&delete y.clear}return C[e]=_,a({global:!0,forced:_!=g},C),m(_,e),v||n.setStrong(_,e,h),_}},"6f34":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("d3b7"),n("3ca3"),n("ddb0");var a=n("cd1c"),s={data:function(){return{isUpdateInputs:!1,modalCustomField:{isOpen:!1,isLoading:!1,isEdit:!1}}},components:{Fields:function(){return n.e("chunk-2d21400a").then(n.bind(null,"aea1"))},ModalCustomField:function(){return n.e("chunk-2fe60b47").then(n.bind(null,"2aaf"))}},methods:{modalHandlerCustomFields:function(e){var t=e.isOpen,n=e.isLoading,a=e.isEdit;this.modalCustomField={isOpen:t,isLoading:n,isEdit:a}},createCustomField:function(e,t){var n=this,s=t.type,i=t.label,o=t.items,r=t.isRequired;this.modalHandlerCustomFields({isOpen:!0,isLoading:!0,isEdit:!1}),this.$apollo.mutate({mutation:a["a"],variables:{forForm:e,input:{type:s,label:i,items:o,isRequired:r,isMultiple:!1}},update:function(e,t){var a=t.data.createCustomField;if(n.inputs&&!n.isImportModal&&n.inputs.push(a),n.inputs&&n.isImportModal){var s=a.id,i=a.type,o=a.label,r={label:o,key:s,isSelect:!1,isDefault:!1,type:i};n.inputs.push(r)}}}).then((function(){n.modalHandlerCustomFields({isOpen:!1,isLoading:!1,isEdit:!1}),n.isUpdateInputs=!0})).catch((function(){var e="No se pudo actualizar los campos, intente de nuevo o contacte a soporte";n.modalHandlerError({isOpen:!0,error:e})}))}}}},"73d9":function(e,t,n){var a=n("44d2");a("flatMap")},a2bf:function(e,t,n){"use strict";var a=n("e8b5"),s=n("50c4"),i=n("0366"),o=function(e,t,n,r,l,d,c,u){var p,m=l,f=0,h=!!c&&i(c,u,3);while(f<r){if(f in n){if(p=h?h(n[f],f,t):n[f],d>0&&a(p))m=o(e,t,p,s(p.length),m,d-1)-1;else{if(m>=9007199254740991)throw TypeError("Exceed the acceptable array length");e[m]=p}m++}f++}return m};e.exports=o},cd1c:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p}));var a,s,i,o,r=n("8785"),l=n("5184"),d=Object(l["a"])(a||(a=Object(r["a"])(["\n  mutation CreateCustomFields($forForm: typeForm!, $input: CreateCustomInput!) {\n    createCustomField(forForm: $forForm, input: $input) {\n      id\n      order\n      label\n      icon\n      type\n      items\n      isRequired\n      isMultiple\n    }\n  }\n"]))),c=Object(l["a"])(s||(s=Object(r["a"])(["\n  mutation UpdateOrderInputs($forForm: typeForm!, $inputs: [UpdateOrder!]!) {\n    updateOrderInputs(forForm: $forForm, inputs: $inputs) {\n      forForm\n      defaultForm {\n        id\n        inputs {\n          id\n          label\n          order\n        }\n      }\n      customForm {\n        id\n        inputs {\n          id\n          label\n          order\n        }\n      }\n    }\n  }\n"]))),u=Object(l["a"])(i||(i=Object(r["a"])(["\n  mutation UpdateCustomField($input: UpdateCustomInput!) {\n    updateCustomField(input: $input) {\n      id\n      type\n      icon\n      label\n      items\n      order\n      isRequired\n      isMultiple\n    }\n  }\n"]))),p=Object(l["a"])(o||(o=Object(r["a"])(["\n  mutation DeleteInput($input: ID!) {\n    deleteCustomField(input: $input) {\n      forForm\n      defaultForm {\n        id\n        inputs {\n          id\n          order\n        }\n      }\n      customForm {\n        id\n        inputs {\n          id\n          order\n          label\n          icon\n          type\n          items\n          isRequired\n          isMultiple\n        }\n      }\n    }\n  }\n"])))},d59a:function(e,t,n){"use strict";n.r(t);var a,s,i,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-dialog",{attrs:{width:"750",scrollable:"",persistent:""},model:{value:e.modalHandler.isOpen,callback:function(t){e.$set(e.modalHandler,"isOpen",t)},expression:"modalHandler.isOpen"}},[n("v-card",[n("v-card-title",{staticClass:"primary white--text pl-10"},[e._v(" Importar "+e._s(e.typeItems.name)+" "),n("v-spacer"),n("v-btn",{attrs:{icon:"",color:"white"},on:{click:e.close}},[n("v-icon",[e._v("mdi-close")])],1)],1),n("v-card-text",{staticClass:"pa-0"},[n("v-stepper",{attrs:{"non-linear":""},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[n("v-stepper-header",[n("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v(" Cargar archivo ")]),n("v-divider"),n("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v(" Seleccionar campos ")]),n("v-divider"),n("v-stepper-step",{attrs:{step:"3"}},[e._v(" Cargar datos en la aplicación ")])],1),n("v-stepper-items",[n("v-stepper-content",{attrs:{step:"1"}},[n("v-card",{staticClass:"mb-2",attrs:{flat:""}},[n("v-card-title",{staticClass:"justify-center"},[n("v-icon",{staticClass:"mr-2",attrs:{large:""}},[e._v("mdi-comment-alert-outline")]),e._v(" Antes de importar! ")],1),n("v-card-subtitle",{staticClass:"mt-1"},[n("p",{staticClass:"text-center"},[e._v(" Puedes descargar un archivo de ejemplo para evitar errores en la importación ")]),n("div",{staticClass:"d-flex justify-center pt-2"},[n("v-btn",{staticClass:"ma-2",attrs:{outlined:"",href:e.downloadFile,target:"_blank"}},[e._v(" Descargar ejemplo ")])],1)]),n("v-card-text",{staticClass:"py-4"},[n("vue-dropzone",{ref:"dropzone",attrs:{id:"dropZone",options:e.dropOptions,useCustomSlot:!0,"include-styling":!1},on:{"vdropzone-drag-over":function(t){return t.stopPropagation(),e.startDragging.apply(null,arguments)},"vdropzone-drag-leave":e.endDragging,"vdropzone-drop":e.endDragging,"vdropzone-success":e.uploadFile,"vdropzone-error":e.getError,"vdropzone-total-upload-progress":e.uploadProgress}},[n("v-card",{staticClass:"dropzone-custom-content pa-12",class:[{"blur-drop-zone":e.dragging}],attrs:{disabled:e.isUploadProgress,color:"#F0F0F0",outlined:""}},[n("v-col",{staticClass:"pb-0",attrs:{cols:"12",align:"center"}},[e.isUploadProgress?n("v-progress-linear",{staticClass:"mb-4",attrs:{color:"green",height:"6",stream:"","buffer-value":e.progress}}):e._e(),e.isSuccessUpload?n("v-icon",{attrs:{"x-large":""}},[e._v("mdi-file-outline")]):n("v-icon",{attrs:{"x-large":""}},[e._v(" mdi-file-download-outline ")])],1),n("v-card-title",{staticClass:"dropzone-custom-title justify-center"},[e.isSuccessUpload?n("span",[e._v(" "+e._s(e.file.name)+" ")]):n("span",{staticClass:"text-center"},[e._v(" Arrastra y suelta o elige un archivo para cargar ")])]),n("v-card-subtitle",{staticClass:"subtitle text-center"},[e.isSuccessUpload?n("v-btn",{attrs:{text:"",small:"",color:"error"},on:{click:e.removeDocumentUpload}},[e._v(" Eliminar ")]):n("span",[e._v(" Sólo los archivos .csv, .xlsx y .xls son compatibles. ")])],1)],1)],1),n("XlsxRead",{attrs:{file:e.file}},[n("xlsx-json",{on:{parsed:e.getData}})],1)],1),n("v-card-actions",{staticClass:"justify-end"},[n("v-btn",{attrs:{large:"",disabled:!e.isSuccessUpload,color:"secondary"},on:{click:function(t){e.step=2}}},[e._v(" Continuar ")])],1)],1)],1),n("v-stepper-content",{staticClass:"pa-2",attrs:{step:"2"}},[n("v-card",{attrs:{flat:""}},[n("v-card-title",{staticClass:"d-flex justify-center"},[e._v(" Asigna los campos correspondientes a guardar ")]),e.$can(e.CUSTOM_FIELDS_MANAGEMENT,e.PERMISSIONS_SETTINGS)?n("div",{staticClass:"text-center"},[n("span",{staticClass:"d-block mb-3"},[e._v("¿Necesitas más campos?")]),n("v-btn",{attrs:{small:"",color:"secondary"},on:{click:function(t){return e.modalHandlerCustomFields({isOpen:!0,isLoading:!1,isEdit:!1})}}},[e._v(" Crear campo personalizado ")])],1):e._e(),n("v-card-text",[n("v-row",{staticClass:"justify-center pb-2"},["DEAL"===e.typeItems.type&&1!==e.step?n("v-col",{attrs:{cols:"8"}},[n("Fields",{attrs:{field:e.inputPipeline,resetHandler:e.modalHandler.isOpen}})],1):e._e()],1),e._l(e.columns,(function(t,a){return n("v-row",{key:a},[n("v-col",{attrs:{"align-self":"center",cols:"6"}},[e._v(e._s(t))]),n("v-col",{attrs:{cols:"6"}},[1!==e.step?n("v-select",{attrs:{label:"Campos disponibles",outlined:"",items:e.inputs,"item-text":"label","item-value":"key","return-object":"",clearable:"","hide-details":"auto"},on:{"click:clear":function(n){return e.clearValue(t)}},scopedSlots:e._u([{key:"item",fn:function(a){var s=a.item,i=a.on,o=a.attrs;return[n("v-list-item",e._g(e._b({attrs:{disabled:s.isSelect},on:{click:function(n){return e.structureData(s,t)}}},"v-list-item",o,!1),i),[e._v(" "+e._s(s.label)+" ")])]}}],null,!0)}):e._e()],1)],1)}))],2),n("v-card-actions",{staticClass:"justify-end"},[n("v-btn",{attrs:{large:"",outlined:"",color:"primary"},on:{click:e.backStepOne}},[e._v(" Atrás ")]),n("v-btn",{attrs:{large:"",color:"secondary"},on:{click:e.assembleDataHandler}},[e._v(" Continuar ")])],1)],1)],1),n("v-stepper-content",{attrs:{step:"3"}},[n("v-card",{attrs:{outlined:""}},[e.isEndImport||e.isErrorImport?e._e():n("v-card-title",{staticClass:"justify-center center-info"},[n("v-icon",{staticClass:"mr-2 text-center",attrs:{color:"success","x-large":""}},[e._v(" mdi-file-check-outline ")]),e._v(" El documento está listo para ser importado ")],1),e.isEndImport&&!e.isErrorImport?n("v-card-title",{staticClass:"justify-center center-info px-12 text-center"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"success","x-large":""}},[e._v(" mdi-bell-ring-outline ")]),e._v(" Los datos se cargarán y te avisaremos cuando esté listo, ahora puedes seguir trabajando ")],1):e._e(),!e.isEndImport&&e.isErrorImport?n("v-card-title",{staticClass:"justify-center center-info px-12 text-center"},[n("v-icon",{staticClass:"mr-2",attrs:{color:"success","x-large":""}},[e._v(" mdi-alert-circle-outline ")]),e._v(" Ha ocurrido un error durante la importación, intente de nuevo o contacte a soporte ")],1):e._e(),n("v-divider"),n("v-card-actions",{staticClass:"justify-end"},[e.isEndImport?e._e():n("v-btn",{attrs:{color:"primary",outlined:"",large:""},on:{click:e.backStepTwo}},[e._v(" Atrás ")]),e.isEndImport||e.isErrorImport?e._e():n("v-btn",{attrs:{loading:e.isLoadingImport,color:"secondary",large:""},on:{click:e.handlerImport}},[e._v(" Importar ")]),e.isEndImport?n("v-btn",{attrs:{outlined:"",large:"",color:"primary"},on:{click:e.close}},[e._v(" Cerrar ")]):e._e()],1)],1)],1)],1)],1),n("BaseModalError",{attrs:{modalHandler:e.modalError},on:{close:e.modalHandlerError}}),n("BaseModalAlert",{attrs:{modalHandler:e.modalAlert,cancel:!1},on:{confirm:e.modalHandlerAlert}}),n("ModalCustomField",{attrs:{forForm:e.typeItems.type,isImportModal:!0,modalHandler:e.modalCustomField},on:{outData:e.createCustomField,close:e.modalHandlerCustomFields}})],1)],1)],1)},r=[],l=n("2909"),d=n("5530"),c=n("ade3"),u=(n("159b"),n("5db7"),n("73d9"),n("b64b"),n("d3b7"),n("6062"),n("3ca3"),n("ddb0"),n("4de4"),n("99af"),n("d81d"),n("7db0"),n("b0c0"),n("c1df")),p=n.n(u),m=n("92c3"),f=n.n(m),h=n("6f34"),v=n("891c"),b=n("ee2e"),g=n("8785"),y=n("5184"),_=Object(y["a"])(a||(a=Object(g["a"])(["\n  mutation importContacts($input: [ContactImport!]!) {\n    importContacts(contacts: $input)\n  }\n"]))),C=Object(y["a"])(s||(s=Object(g["a"])(["\n  mutation importCompanies($input: [CompanyImport!]!) {\n    importCompanies(companies: $input)\n  }\n"]))),I=Object(y["a"])(i||(i=Object(g["a"])(["\n  mutation importDeals($input: DealListImport!) {\n    importDeals(dealListImport: $input)\n  }\n"]))),k=n("1e6d"),O={data(){return{libLoaded:!1,loading:!1}},provide(){return{getWorkbook:this.getWorkbook}},methods:{startLoading(){this.loading=!0,this.$emit("loading",this.loading)},endLoading(){this.loading=!1,this.$emit("loading",this.loading)},fireCallBacks(){this._callbackQueue&&Array.isArray(this._callbackQueue)&&this._callbackQueue.forEach(e=>{try{e(this._workbook)}catch(t){console.warning("error in firing callbacks",t)}})},getWorkbook(e){this._callbackQueue&&this._callbackQueue.push(e),this._workbook&&e(this._workbook)}}},x={mixins:[O],props:{file:{type:null,default:null},options:{type:Object,default:()=>({})}},computed:{loadedAndFile(){return this.libLoaded?this.file:null}},watch:{loadedAndFile:{immediate:!0,handler(e){e&&this.parseFile(e)}}},mounted(){this.load()},methods:{async load(){const{globalPolyfill:e}=n("40bd");e();const{read:t}=await Promise.all([n.e("chunk-6e83591c"),n.e("chunk-34182fda")]).then(n.t.bind(null,"1146",7));this._read=t,this.libLoaded=!0,this._callbackQueue=[]},parseFile(e){this.startLoading();const t=new FileReader;t.onload=e=>{let t="";const n=new Uint8Array(e.target.result),a=n.byteLength;for(var s=0;s<a;s++)t+=String.fromCharCode(n[s]);this._workbook=this._read(t,{type:"binary",...this.options}),this.fireCallBacks(),this.$emit("parsed",this._workbook),this.endLoading()},t.onerror=e=>{console.log(e)},t.readAsArrayBuffer(e)}},render(e){return this.$scopedSlots.default&&this.libLoaded?e("div",[this.$scopedSlots.default({loading:this.loading})]):null}};function E(e,t,n,a,s,i,o,r,l,d){"boolean"!==typeof o&&(l=r,r=o,o=!1);var c,u="function"===typeof n?n.options:n;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,s&&(u.functional=!0)),a&&(u._scopeId=a),i?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=c):t&&(c=o?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),c)if(u.functional){var p=u.render;u.render=function(e,t){return c.call(t),p(e,t)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,c):[c]}return n}var S=E;const F=x,D=void 0,j=void 0,A=void 0,w=void 0;var M=S({},D,F,j,w,A,void 0,void 0),$=M,L={inject:["getWorkbook"],props:{sheet:{type:[String,Number],default:0},options:{type:Object,default:()=>({})}},data(){return{loaded:!1}},computed:{loadedAndSheet(){return this.loaded?this.sheet:null}},watch:{loadedAndSheet:{immediate:!0,handler(e){null!==e&&this.getWorkbook(this._callBack)}}},mounted(){this._callBack=()=>{console.warning("Missing data parsing callback")}},methods:{sheetNameFinder(e){return Number.isInteger(this.sheet)?e.SheetNames[this.sheet]:this.sheet}}},T={mixins:[L],data(){return{collection:null}},mounted(){this._callBack=this.updateJson,this.load()},methods:{async load(){const{utils:{sheet_to_json:e}}=await Promise.all([n.e("chunk-6e83591c"),n.e("chunk-34182fda")]).then(n.t.bind(null,"1146",7));this._sheet_to_json=e,this.loaded=!0},updateJson(e){const t=e.Sheets[this.sheetNameFinder(e)];this.collection=this._sheet_to_json(t,this.options),this.$emit("parsed",this.collection)}},render(e){return this.$scopedSlots.default&&this.loaded?e("div",[this.$scopedSlots.default({collection:this.collection})]):null}};function Y(e,t,n,a,s,i,o,r,l,d){"boolean"!==typeof o&&(l=r,r=o,o=!1);var c,u="function"===typeof n?n.options:n;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,s&&(u.functional=!0)),a&&(u._scopeId=a),i?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(i)},u._ssrRegister=c):t&&(c=o?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,r(e))}),c)if(u.functional){var p=u.render;u.render=function(e,t){return c.call(t),p(e,t)}}else{var m=u.beforeCreate;u.beforeCreate=m?[].concat(m,c):[c]}return n}var V=Y;const H=T,N=void 0,U=void 0,P=void 0,R=void 0;var z=V({},N,H,U,R,P,void 0,void 0),q=z,B=function(){return"\n     <span></span>\n"},X={name:"ModalImportData",components:{XlsxRead:$,XlsxJson:q,vueDropzone:f.a},mixins:[k["a"],h["a"]],props:{modalHandler:{required:!0,type:Object,default:function(){return{isOpen:!1}}},typeItems:{required:!0,type:Object},form:{required:!0,type:[Array,Object]}},data:function(){return{PERMISSIONS_SETTINGS:b["l"],CUSTOM_FIELDS_MANAGEMENT:v["e"],file:null,step:1,isSuccessUpload:!1,dragging:!1,isUploadProgress:!1,progress:0,dropOptions:{url:"https://httpbin.org/post",maxFilesize:1,maxFiles:1,acceptedFiles:".xls, .xlsx, .csv",addRemoveLinks:!1,previewTemplate:B()},inputs:[],columns:[],columnsValues:[],dataObject:[],dataAssemble:[],dataImports:[],isLoadingImport:!1,isEndImport:!1,isErrorImport:!1,inputPipeline:{keyInput:"pipeline",type:"SELECT_PIPELINE",label:"Selecciona el embudo donde se importarán los tratos",value:{}},isImportModal:!0}},computed:{downloadFile:function(){return"CONTACT"===this.typeItems.type?"/files/contactos-ejemplo.xls":"COMPANY"===this.typeItems.type?"/files/empresas-ejemplo.xlsx":"DEAL"===this.typeItems.type?"/files/tratos-ejemplo.xlsx":""}},watch:{modalHandler:function(e){var t=e.isOpen;t?this.getInputs():this.resetValues()},isSuccessUpload:function(e){e?(this.isUploadProgress=!1,this.$refs.dropzone.disable()):this.$refs.dropzone.enable()}},methods:{close:function(){this.$emit("close",{isOpen:!1})},resetValues:function(){this.removeDocumentUpload(),this.step=1,this.inputs=[],this.columns=[],this.columnsValues=[],this.dataObject=[],this.dataAssemble=[],this.dataImports=[],this.isLoadingImport=!1,this.isErrorImport=!1,this.isEndImport=!1},backStepOne:function(){var e=this;this.step=1,this.inputPipeline.value={},this.dataObject.forEach((function(t){var n=t.column;e.clearValue(n)}))},backStepTwo:function(){this.isErrorImport=!1,this.step=2},getError:function(e){var t=e.accepted,n="";n=t?"Ocurrió un error al cargar el archivo inténtelo de nuevo o contacte a soporte":"El archivo que seleccionaste no es válido, las extenciones de archivos permitidas son .xls, .xlsx, .csv",this.modalHandlerError({isOpen:!0,error:n})},uploadFile:function(e){this.file=e,this.progress=100,this.isSuccessUpload=!0},removeDocumentUpload:function(){this.$refs.dropzone.removeAllFiles(!0),this.modalHandlerError({isOpen:!1,error:""}),this.file=null,this.isSuccessUpload=!1,this.isUploadProgress=!1},getData:function(e){this.columnsValues=e;var t=e.flatMap((function(e){return Object.keys(e)}));this.columns=new Set(t)},startDragging:function(){this.dragging=!0},endDragging:function(){this.dragging=!1},uploadProgress:function(e){this.isUploadProgress=!0,this.progress=e-10},getInputs:function(){var e=this.form,t=e.customForm,n=e.defaultForm,a=e.headers,s=a.filter((function(e){return"wonTime"===e.keyInput||"lostTime"===e.keyInput||"createdAt"===e.keyInput||"updatedAt"===e.keyInput})),i=[];i="DEAL"===this.typeItems.type?null!==t&&void 0!==t&&t.inputs?null===n||void 0===n?void 0:n.inputs.concat(null===t||void 0===t?void 0:t.inputs).concat(s):null===n||void 0===n?void 0:n.inputs.concat(s):null!==t&&void 0!==t&&t.inputs?null===n||void 0===n?void 0:n.inputs.concat(null===t||void 0===t?void 0:t.inputs):null===n||void 0===n?void 0:n.inputs;var o=i.map((function(e){return{label:e.label,key:e.keyInput?e.keyInput:e.id,isSelect:!1,isDefault:!!e.keyInput,type:e.type}})),r=o.filter((function(e){var t=e.key,n=e.type;return"tags"!==t&&"owner"!==t&&"socialMedias"!==t&&"isClient"!==t&&"RADIO"!==n&&"CHECKBOX"!==n&&"pipeline"!==t}));this.inputs=r},clearValue:function(e){var t=this.dataObject.find((function(t){var n=t.column;return e===n})),n=t.input;this.inputs=this.inputs.map((function(e){return e.key===n.key&&(e.isSelect=!1),e})),this.dataObject=this.dataObject.filter((function(t){var n=t.column;return e!==n}))},structureData:function(e,t){var n=this,a=this.dataObject.some((function(e){return e.column===t}));a?(this.dataObject=this.dataObject.filter((function(e){return e.column!==t})),this.dataObject.push({input:e,column:t})):this.dataObject.push({input:e,column:t}),this.inputs=this.inputs.map((function(e){var t=n.dataObject.some((function(t){return t.input.key===e.key}));return e.isSelect=!!t,e}))},assembleDataHandler:function(){var e="";if("CONTACT"===this.typeItems.type||"COMPANY"===this.typeItems.type){var t=this.dataObject.some((function(e){var t=e.input;return"name"===t.key}));t?this.assembleData():(e="El campo de tipo nombre debe ser asignado",this.modalHandlerError({isOpen:!0,error:e}))}else{var n=this.dataObject.some((function(e){var t=e.input;return"title"===t.key}));this.inputPipeline.value.pipelineId&&this.inputPipeline.value.stageId&&n&&this.assembleData(),n||(e="El campo de tipo título debe ser asignado",this.modalHandlerError({isOpen:!0,error:e})),this.inputPipeline.value.pipelineId||this.inputPipeline.value.stageId||(e="Selecciona el embudo y la etapa donde se importarán los tratos",this.modalHandlerError({isOpen:!0,error:e}))}},assembleData:function(){var e=this,t=this.columnsValues.map((function(t){var n=e.dataObject.filter((function(e){var t=e.input;return t.isDefault})).map((function(e){var n=e.column,a=e.input;return"companies"===a.key?{company:t[n]}:"contacts"===a.key?{contact:t[n]}:Object(c["a"])({},a.key,t[n])})),a=e.dataObject.filter((function(e){var t=e.input;return!t.isDefault})).map((function(e){var n=e.column,a=e.input;return{id:a.key,value:t[n],type:a.type}}));return Object(d["a"])(Object(d["a"])({},Object.assign.apply(Object,[{}].concat(Object(l["a"])(n)))),{},{customs:a})})),n=t.map((function(t){if("DEAL"===e.typeItems.type){if(t.title||(t.title="N/A"),t.value?(t.value=parseFloat(t.value),isNaN(t.value)&&(t.value=0)):t.value=0,t.expectedCloseDate){var n=p()(t.expectedCloseDate).format("YYYY-MM-DD"),a=p()(n,"YYYY-MM-DD").isValid();a?t.expectedCloseDate=n:(e.modalHandlerAlert({isOpen:!0,isLoading:!1,message:{title:"Fechas inválidas encontradas",text:"Se encontraron fechas inválidas en el documento, si continúa es posible que algunas fechas no se guarden, asegurate de haber introducido las fechas en el formato correcto; para obtener más ayuda puedes descargar nuestro documento guía"},info:{}}),delete t.expectedCloseDate)}else delete t.expectedCloseDate;if(t.wonTime){var s=p()(t.wonTime).format("YYYY-MM-DD"),i=p()(s,"YYYY-MM-DD").isValid();i?t.wonTime=s:(e.modalHandlerAlert({isOpen:!0,isLoading:!1,message:{title:"Fechas inválidas encontradas",text:"Se encontraron fechas inválidas en el documento, si continúa es posible que algunas fechas no se guarden, asegurate de haber introducido las fechas en el formato correcto, para obtener más ayuda puedes descargar nuestro documento guía"},info:{}}),delete t.wonTime)}else delete t.wonTime;if(t.lostTime){var o=p()(t.lostTime).format("YYYY-MM-DD"),r=p()(o,"YYYY-MM-DD").isValid();r?t.lostTime=o:(e.modalHandlerAlert({isOpen:!0,isLoading:!1,message:{title:"Fechas inválidas encontradas",text:"Se encontraron fechas inválidas en el documento, si continúa es posible que algunas fechas no se guarden, asegurate de haber introducido las fechas en el formato correcto, para obtener más ayuda puedes descargar nuestro documento guía"},info:{}}),delete t.lostTime)}else delete t.lostTime;if(t.createdAt){var l=p()(t.createdAt).format("YYYY-MM-DD"),d=p()(l,"YYYY-MM-DD").isValid();d?t.createdAt=l:(e.modalHandlerAlert({isOpen:!0,isLoading:!1,message:{title:"Fechas inválidas encontradas",text:"Se encontraron fechas inválidas en el documento, si continúa es posible que algunas fechas no se guarden, asegurate de haber introducido las fechas en el formato correcto, para obtener más ayuda puedes descargar nuestro documento guía"},info:{}}),delete t.createdAt)}else delete t.createdAt;if(t.updatedAt){var c=p()(t.updatedAt).format("YYYY-MM-DD"),u=p()(c,"YYYY-MM-DD").isValid();u?t.updatedAt=c:(e.modalHandlerAlert({isOpen:!0,isLoading:!1,message:{title:"Fechas inválidas encontradas",text:"Se encontraron fechas inválidas en el documento, si continúa es posible que algunas fechas no se guarden, asegurate de haber introducido las fechas en el formato correcto, para obtener mas ayuda puedes descargar nuestro documento guía"},info:{}}),delete t.updatedAt)}else delete t.updatedAt}return"DEAL"!==e.typeItems.type&&(t.name||(t.name="N/A"),t.phones?t.phones="".concat(t.phones):delete t.phones),t}));this.dataImports=n,this.step=3},handlerImport:function(){this.isLoadingImport=!0,"CONTACT"===this.typeItems.type&&this.importContacts(this.dataImports),"COMPANY"===this.typeItems.type&&this.importCompanies(this.dataImports),"DEAL"===this.typeItems.type&&this.importDeals(this.dataImports)},importContacts:function(e){var t=this;this.$apollo.mutate({mutation:_,variables:{input:e}}).then((function(){t.isLoadingImport=!1,t.isEndImport=!0})).catch((function(){t.isLoadingImport=!1,t.isErrorImport=!0}))},importCompanies:function(e){var t=this;this.$apollo.mutate({mutation:C,variables:{input:e}}).then((function(){t.isLoadingImport=!1,t.isEndImport=!0})).catch((function(){t.isLoadingImport=!1,t.isErrorImport=!0}))},importDeals:function(e){var t=this,n=this.inputPipeline.value,a=n.pipelineId,s=n.stageId,i={deals:e,pipelineId:a,stageId:s};this.$apollo.mutate({mutation:I,variables:{input:i}}).then((function(){t.isLoadingImport=!1,t.isEndImport=!0})).catch((function(e){console.log(e),t.isLoadingImport=!1,t.isErrorImport=!0}))}}},Q=X,W=(n("3a60"),n("0c7c")),J=n("6544"),G=n.n(J),K=n("8336"),Z=n("b0af"),ee=n("99d9"),te=n("62ad"),ne=n("169a"),ae=n("ce7e"),se=n("132d"),ie=n("da13"),oe=n("8e36"),re=n("0fd9"),le=n("b974"),de=n("2fa4"),ce=n("7e85"),ue=n("e516"),pe=n("9c54"),me=n("56a4"),fe=Object(W["a"])(Q,o,r,!1,null,"7d527644",null);t["default"]=fe.exports;G()(fe,{VBtn:K["a"],VCard:Z["a"],VCardActions:ee["a"],VCardSubtitle:ee["b"],VCardText:ee["c"],VCardTitle:ee["d"],VCol:te["a"],VDialog:ne["a"],VDivider:ae["a"],VIcon:se["a"],VListItem:ie["a"],VProgressLinear:oe["a"],VRow:re["a"],VSelect:le["a"],VSpacer:de["a"],VStepper:ce["a"],VStepperContent:ue["a"],VStepperHeader:pe["a"],VStepperItems:pe["b"],VStepperStep:me["a"]})}}]);
//# sourceMappingURL=chunk-6ccde0b4.1a543b62.js.map