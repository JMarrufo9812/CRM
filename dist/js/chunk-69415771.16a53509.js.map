{"version":3,"sources":["webpack:///./node_modules/core-js/internals/get-substitution.js","webpack:///./src/components/notes/Note.vue?7377","webpack:///src/components/notes/Note.vue","webpack:///./src/components/notes/Note.vue?38b8","webpack:///./src/components/notes/Note.vue?92d1","webpack:///./src/components/notes/Note.vue?0c73","webpack:///./node_modules/core-js/modules/es.string.replace.js","webpack:///./src/graphql/mutations/notesMutations.js","webpack:///./src/mixins/filesMixin.js","webpack:///./src/graphql/mutations/filesMutations.js"],"names":["toObject","floor","Math","replace","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","module","exports","matched","str","position","captures","namedCaptures","replacement","tailPos","length","m","symbols","undefined","call","match","ch","capture","charAt","slice","n","f","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","item","ownerId","typeItem","on","edit","removeConfirm","updateHistory","_e","canEdit","canEditOthers","isDelete","userCurrent","modalDelete","modalHandlerDelete","remove","modalError","modalHandlerError","staticRenderFns","name","components","NoteTemplate","NoteAddComment","NoteListComments","mixins","modalsAlertsMixin","props","type","Object","required","String","default","itemId","comments","Boolean","data","UPDATE","UPDATE_OTHERS","subject","PERMISSIONS_CONTACTS","PERMISSIONS_COMPANIES","PERMISSIONS_DEALS","PERMISSIONS_NOTES","computed","filters","filterObject","contactId","companyId","dealId","isMe","ability","methods","isOpen","isLoading","message","infoDelete","content","imgTag","$apollo","changeModal","id","status","isEdit","$emit","apollo","query","component","VCard","fixRegExpWellKnownSymbolLogic","fails","anObject","toLength","toInteger","requireObjectCoercible","advanceStringIndex","getSubstitution","regExpExec","wellKnownSymbol","REPLACE","max","min","maybeToString","it","REPLACE_KEEPS_$0","REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","REPLACE_SUPPORTS_NAMED_GROUPS","re","exec","result","groups","a","_","nativeReplace","maybeCallNative","UNSAFE_SUBSTITUTE","searchValue","replaceValue","O","replacer","string","indexOf","res","done","value","rx","S","functionalReplace","global","fullUnicode","unicode","lastIndex","results","push","matchStr","accumulatedResult","nextSourcePosition","i","index","j","replacerArgs","concat","apply","CREATE_NOTE","gql","UPDATE_NOTE","DELETE_NOTE","CREATE_COMMENT_NOTE","UPDATE_COMMENT_NOTE","DELETE_COMMENT_NOTE","UPLOAD_IMAGE_NOTE","filesMixin","modalFileEdit","info","modalFileEditHandler","uploadFile","location","idSource","fileInfo","description","size","mutate","mutation","UPLOAD_FILE","client","variables","input","file","then","updateFile","close","catch","error","fileId","UPDATE_DESCRIPTION_FILE","deleteFile","DELETE_FILE","key","url","deleteFileWhitOutModal","UPLOAD_PROFILE_PHOTO"],"mappings":"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","file":"js/chunk-69415771.16a53509.js","sourcesContent":["var toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar replace = ''.replace;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// `GetSubstitution` abstract operation\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace.call(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (ch.charAt(0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return str.slice(0, position);\n      case \"'\": return str.slice(tailPos);\n      case '<':\n        capture = namedCaptures[ch.slice(1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"mr-11 pb-2\",attrs:{\"color\":\"#FDE584\"}},[_c('NoteTemplate',{attrs:{\"note\":_vm.item,\"ownerId\":_vm.ownerId,\"typeItem\":_vm.typeItem},on:{\"edit\":_vm.edit,\"remove\":_vm.removeConfirm}}),(_vm.comments)?_c('NoteListComments',{attrs:{\"note\":_vm.item,\"ownerId\":_vm.ownerId,\"typeItem\":_vm.typeItem},on:{\"updateHistory\":_vm.updateHistory}}):_vm._e(),((_vm.canEdit || _vm.canEditOthers) && !_vm.item.isDelete)?_c('NoteAddComment',{attrs:{\"note\":_vm.item,\"userCurrent\":_vm.userCurrent},on:{\"updateHistory\":_vm.updateHistory}}):_vm._e(),_c('BaseModalDelete',{attrs:{\"modalHandler\":_vm.modalDelete},on:{\"cancel\":_vm.modalHandlerDelete,\"confirm\":_vm.remove}}),_c('BaseModalError',{attrs:{\"modalHandler\":_vm.modalError},on:{\"close\":_vm.modalHandlerError}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card color=\"#FDE584\" class=\"mr-11 pb-2\">\n    <NoteTemplate\n      @edit=\"edit\"\n      @remove=\"removeConfirm\"\n      :note=\"item\"\n      :ownerId=\"ownerId\"\n      :typeItem=\"typeItem\"\n    ></NoteTemplate>\n    <NoteListComments\n      v-if=\"comments\"\n      :note=\"item\"\n      :ownerId=\"ownerId\"\n      :typeItem=\"typeItem\"\n      @updateHistory=\"updateHistory\"\n    ></NoteListComments>\n    <NoteAddComment\n      v-if=\"(canEdit || canEditOthers) && !item.isDelete\"\n      :note=\"item\"\n      :userCurrent=\"userCurrent\"\n      @updateHistory=\"updateHistory\"\n    ></NoteAddComment>\n    <BaseModalDelete\n      :modalHandler=\"modalDelete\"\n      @cancel=\"modalHandlerDelete\"\n      @confirm=\"remove\"\n    />\n    <BaseModalError :modalHandler=\"modalError\" @close=\"modalHandlerError\" />\n  </v-card>\n</template>\n\n<script>\nimport { subject } from '@casl/ability';\nimport ability from '@/services/ability';\n// graphql\nimport { DELETE_NOTE } from '@/graphql/mutations/notesMutations';\nimport { GET_USER_LOGGED } from '@/graphql/local-state/queries';\n// mixins\nimport { modalMethodsMixin, modalApolloMixin } from '@/mixins/modalsMixin';\nimport { modalsAlertsMixin } from '@/mixins/alerts/modalsAlertsMixin';\nimport { filesMixin } from '@/mixins/filesMixin';\n// Permissions\nimport { UPDATE, UPDATE_OTHERS } from '@/constants/methods';\nimport {\n  PERMISSIONS_CONTACTS,\n  PERMISSIONS_COMPANIES,\n  PERMISSIONS_DEALS,\n  PERMISSIONS_NOTES,\n} from '@/constants/permissions';\n\nexport default {\n  name: 'Note',\n  components: {\n    NoteTemplate: () => import('@/components/notes/NoteTemplate.vue'),\n    NoteAddComment: () => import('@/components/notes/NoteAddComment.vue'),\n    NoteListComments: () => import('@/components/notes/NoteListComments.vue'),\n  },\n  mixins: [modalsAlertsMixin, modalMethodsMixin, modalApolloMixin, filesMixin],\n  props: {\n    item: {\n      type: Object,\n      required: true,\n    },\n    typeItem: {\n      type: String,\n      required: true,\n      default: '',\n    },\n    ownerId: {\n      type: String,\n      default: '',\n    },\n    itemId: {\n      type: String,\n      default: '',\n      required: true,\n    },\n    comments: {\n      type: Boolean,\n      default: true,\n      required: false,\n    },\n  },\n  data() {\n    return {\n      userCurrent: {},\n      UPDATE,\n      UPDATE_OTHERS,\n      subject,\n      PERMISSIONS_CONTACTS,\n      PERMISSIONS_COMPANIES,\n      PERMISSIONS_DEALS,\n      PERMISSIONS_NOTES,\n    };\n  },\n  computed: {\n    filters() {\n      const filterObject = { orderBy: 'desc' };\n      if (this.typeItem === 'CONTACT') {\n        filterObject.contactId = this.itemId;\n      } else if (this.typeItem === 'COMPANY') {\n        filterObject.companyId = this.itemId;\n      } else if (this.typeItem === 'DEAL') {\n        filterObject.dealId = this.itemId;\n      }\n\n      return filterObject;\n    },\n    isMe() {\n      return ability.can(\n        UPDATE,\n        subject(PERMISSIONS_NOTES, {\n          authorId: this.item.createdBy.id || '',\n        }),\n      );\n    },\n    canEdit() {\n      if (this.typeItem === 'CONTACT') {\n        return ability.can(\n          UPDATE,\n          subject(PERMISSIONS_CONTACTS, { authorId: this.ownerId || '' }),\n        );\n      }\n      if (this.typeItem === 'COMPANY') {\n        return ability.can(\n          UPDATE,\n          subject(PERMISSIONS_COMPANIES, { authorId: this.ownerId || '' }),\n        );\n      }\n      if (this.typeItem === 'DEAL') {\n        return ability.can(\n          UPDATE,\n          subject(PERMISSIONS_DEALS, { authorId: this.ownerId || '' }),\n        );\n      }\n      return false;\n    },\n    canEditOthers() {\n      if (this.typeItem === 'CONTACT') {\n        if (!this.canEdit) {\n          return (\n            ability.can(UPDATE_OTHERS, PERMISSIONS_CONTACTS) &&\n            !ability.can(\n              UPDATE_OTHERS,\n              subject(PERMISSIONS_CONTACTS, {\n                authorId: this.ownerId || '',\n              }),\n            )\n          );\n        }\n        return ability.can(UPDATE_OTHERS, PERMISSIONS_CONTACTS);\n      }\n      if (this.typeItem === 'COMPANY') {\n        if (!this.canEdit) {\n          return (\n            ability.can(UPDATE_OTHERS, PERMISSIONS_COMPANIES) &&\n            !ability.can(\n              UPDATE_OTHERS,\n              subject(PERMISSIONS_COMPANIES, {\n                authorId: this.ownerId || '',\n              }),\n            )\n          );\n        }\n        return ability.can(UPDATE_OTHERS, PERMISSIONS_COMPANIES);\n      }\n      if (this.typeItem === 'DEAL') {\n        if (!this.canEdit) {\n          return (\n            ability.can(UPDATE_OTHERS, PERMISSIONS_DEALS) &&\n            !ability.can(\n              UPDATE_OTHERS,\n              subject(PERMISSIONS_DEALS, {\n                authorId: this.ownerId || '',\n              }),\n            )\n          );\n        }\n        return ability.can(UPDATE_OTHERS, PERMISSIONS_DEALS);\n      }\n      return false;\n    },\n  },\n  methods: {\n    removeConfirm() {\n      this.modalHandlerDelete({\n        isOpen: true,\n        isLoading: false,\n        message: { nameItem: 'La Nota', text: 'será eliminada' },\n        infoDelete: {},\n      });\n    },\n    remove({ isOpen, isLoading, message, infoDelete }) {\n      this.modalHandlerDelete({ isOpen, isLoading, message, infoDelete });\n\n      const { id: noteId, content } = this.item;\n\n      const imagesToDelete = [];\n\n      content.replace(/<img[^>]*>/gi, (imgTag) => {\n        imgTag.replace(\n          /\\b(alt\\s*=\\s*(?:['\"]?))([^'\"> ]+)/i,\n          (alt, prefix, url) => {\n            imagesToDelete.push({ key: url });\n          },\n        );\n      });\n\n      this.$apollo\n        .mutate({\n          mutation: DELETE_NOTE,\n          variables: {\n            noteInput: {\n              noteId,\n            },\n          },\n        })\n        .then(() => {\n          this.updateHistory();\n          imagesToDelete.forEach(({ key }) => {\n            this.deleteFileWhitOutModal(key);\n          });\n          this.modalHandlerDelete({\n            isOpen: false,\n            isLoading,\n            message,\n            infoDelete,\n          });\n        })\n        .catch(() => {\n          const error =\n            'No se pudo eliminar la nota, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    edit() {\n      this.changeModal({\n        id: 'createNote',\n        status: true,\n        isEdit: true,\n        item: this.item,\n      });\n    },\n    updateHistory() {\n      this.$emit('updateHistory');\n    },\n  },\n  apollo: {\n    userCurrent: {\n      query: GET_USER_LOGGED,\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '{ img .v-card__text } from ../../../../scss/components/note';\n</style>\n","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Note.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Note.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Note.vue?vue&type=template&id=fb8616e8&scoped=true&\"\nimport script from \"./Note.vue?vue&type=script&lang=js&\"\nexport * from \"./Note.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Note.vue?vue&type=style&index=0&id=fb8616e8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fb8616e8\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\ninstallComponents(component, {VCard})\n","export * from \"-!../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./Note.vue?vue&type=style&index=0&id=fb8616e8&lang=scss&scoped=true&\"","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar fails = require('../internals/fails');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar max = Math.max;\nvar min = Math.min;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return replacer !== undefined\n        ? replacer.call(searchValue, O, replaceValue)\n        : nativeReplace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (string, replaceValue) {\n      if (\n        typeof replaceValue === 'string' &&\n        replaceValue.indexOf(UNSAFE_SUBSTITUTE) === -1 &&\n        replaceValue.indexOf('$<') === -1\n      ) {\n        var res = maybeCallNative(nativeReplace, this, string, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var rx = anObject(this);\n      var S = String(string);\n\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        results.push(result);\n        if (!global) break;\n\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);\n","import gql from 'graphql-tag';\n\nexport const CREATE_NOTE = gql`\n  mutation createNote($noteInput: noteCreateInput!) {\n    createNote(noteInput: $noteInput) {\n      id\n      content\n      type\n      comments {\n        id\n        comment\n      }\n      userTags {\n        id\n      }\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n`;\n\nexport const UPDATE_NOTE = gql`\n  mutation updateNote($noteInput: noteUpdateInput!) {\n    updateNote(noteInput: $noteInput) {\n      id\n      content\n      type\n      userTags {\n        id\n      }\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n`;\n\nexport const DELETE_NOTE = gql`\n  mutation deleteNote($noteInput: noteId!) {\n    deleteNote(noteInput: $noteInput) {\n      id\n    }\n  }\n`;\n\nexport const CREATE_COMMENT_NOTE = gql`\n  mutation createNoteComment($noteCommentInput: noteCommentCreateInput) {\n    createNoteComment(noteCommentInput: $noteCommentInput) {\n      id\n      comment\n      userTags {\n        id\n      }\n      note {\n        id\n      }\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n`;\n\nexport const UPDATE_COMMENT_NOTE = gql`\n  mutation updateNoteComment($noteCommentInput: noteCommentUpdateInput) {\n    updateNoteComment(noteCommentInput: $noteCommentInput) {\n      id\n      comment\n      userTags {\n        id\n      }\n      note {\n        id\n      }\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n`;\n\nexport const DELETE_COMMENT_NOTE = gql`\n  mutation deleteNoteComment($noteCommentId: ID!) {\n    deleteNoteComment(noteCommentId: $noteCommentId) {\n      id\n    }\n  }\n`;\n\nexport const UPLOAD_IMAGE_NOTE = gql`\n  mutation UploadNoteFile($input: TypeFileNoteInput!) {\n    uploadNoteFile(upFile: $input) {\n      link\n      key\n    }\n  }\n`;\n","import {\n  UPLOAD_FILE,\n  UPDATE_DESCRIPTION_FILE,\n  DELETE_FILE,\n} from '@/graphql/mutations/filesMutations';\n\nexport const filesMixin = {\n  data() {\n    return {\n      modalFileEdit: {\n        isOpen: false,\n        isLoading: false,\n        info: {},\n      },\n    };\n  },\n  methods: {\n    modalFileEditHandler({ isOpen, isLoading, info }) {\n      this.modalFileEdit = { isOpen, isLoading, info };\n    },\n    uploadFile(location, idSource, fileInfo, description) {\n      this.isLoading = true;\n      const { name, size } = fileInfo;\n      this.$apollo\n        .mutate({\n          mutation: UPLOAD_FILE,\n          client: 'files',\n          variables: {\n            input: {\n              location,\n              idSource,\n              name,\n              size,\n              file: fileInfo,\n            },\n          },\n        })\n        .then(({ data: { uploadFile } }) => {\n          if (description.length > 0) {\n            const info = {\n              item: { id: uploadFile.id, description },\n              itemId: idSource,\n              typeItem: location,\n            };\n            this.updateFile({ isOpen: false, isLoading: false, info });\n          } else {\n            this.$emit('updateHistory');\n          }\n          this.isLoading = false;\n          this.close();\n        })\n        .catch(() => {\n          this.isLoading = false;\n          const error =\n            'No se ha podido subir el archivo, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    updateFile({ isOpen, isLoading, info }) {\n      this.modalFileEditHandler({ isOpen, isLoading, info });\n      const input = {\n        idSource: info.itemId,\n        fileId: info.item.id,\n        location: info.typeItem,\n        description: info.item.description,\n      };\n      this.$apollo\n        .mutate({\n          mutation: UPDATE_DESCRIPTION_FILE,\n          variables: {\n            input,\n          },\n        })\n        .then(() => {\n          this.$emit('updateHistory');\n          this.modalFileEditHandler({\n            isOpen: false,\n            isLoading: false,\n            info: {},\n          });\n        })\n        .catch(() => {\n          this.modalFileEditHandler({\n            isOpen: true,\n            isLoading: false,\n            info: {},\n          });\n          const error =\n            'No se pudo agregar la descripcion al archivo, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    deleteFile({ isOpen, isLoading, message, infoDelete }) {\n      this.modalHandlerDelete({\n        isOpen,\n        isLoading,\n        message,\n        infoDelete,\n      });\n      this.$apollo\n        .mutate({\n          mutation: DELETE_FILE,\n          client: 'files',\n          variables: {\n            input: {\n              key: infoDelete.data.item.url.key,\n              idSource: infoDelete.data.itemId,\n              fileId: infoDelete.data.item.id,\n              location: infoDelete.data.typeItem,\n            },\n          },\n        })\n        .then(() => {\n          this.$emit('updateHistory');\n          this.modalHandlerDelete({\n            isOpen: false,\n            isLoading,\n            message,\n            infoDelete,\n          });\n        })\n        .catch(() => {\n          const error =\n            'No se pudo eliminar el archivo, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n    deleteFileWhitOutModal(key) {\n      const input = { key };\n      this.$apollo\n        .mutate({\n          client: 'files',\n          mutation: DELETE_FILE,\n          variables: {\n            input,\n          },\n        })\n        .catch(() => {\n          const error =\n            'No se pudo eliminar el archivo, intente de nuevo o contacte a soporte';\n          this.modalHandlerError({ isOpen: true, error });\n        });\n    },\n  },\n};\n","import gql from 'graphql-tag';\n\nexport const UPLOAD_FILE = gql`\n  mutation UploadFile($input: TypeFileInput!) {\n    uploadFile(upFile: $input) {\n      id\n      name\n      fileExtension\n      url {\n        link\n        key\n      }\n      description\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n      size\n    }\n  }\n`;\n\nexport const UPLOAD_PROFILE_PHOTO = gql`\n  mutation uploadProfilePhoto($input: FileInput!) {\n    uploadProfilePhoto(upFile: $input) {\n      link\n    }\n  }\n`;\n\nexport const DELETE_FILE = gql`\n  mutation DeleteFile($input: DeleteFile!) {\n    deleteFile(deleteFile: $input)\n  }\n`;\n\nexport const UPDATE_DESCRIPTION_FILE = gql`\n  mutation UpdateDescriptionFile($input: descriptionInput!) {\n    updateDescriptionFile(descriptionInput: $input) {\n      id\n      name\n      url {\n        key\n        link\n      }\n      description\n      size\n      createdBy {\n        id\n        user {\n          id\n          name\n          lastName\n        }\n      }\n      createdAt\n    }\n  }\n`;\n"],"sourceRoot":""}